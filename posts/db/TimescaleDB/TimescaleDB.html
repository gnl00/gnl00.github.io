<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TimescaleDB | Gnl</title>
    <meta name="description" content="TimescaleDB 详解">
    <link rel="preload stylesheet" href="/assets/style.8602ee05.css" as="style">
    
    <script type="module" src="/assets/app.f9df3afa.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.b41230ea.js">
    <link rel="modulepreload" href="/assets/chunks/theme.ee99eb69.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-a837419f.aaaedc94.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-34ebe643.3bcff669.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-v2-9362ca72.e7f3b075.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-e232339a.4f2af805.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-007f5bf9.550e0d39.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-bb8de4b5.bd34d17f.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-761fef4a.93153d77.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-8e129bc0.699fd773.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-525ea6f2.05596771.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-585325ee.671b7f32.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-eaee51ba.5e768c4f.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-8025bb1f.f0e4b28a.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-d706aa6d.f9e1e4a9.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-ad81aaa2.22eb7806.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-c61244fe.33bf6205.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-93a053d8.7c96ca2d.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-654feea8.1dce6bf5.js">
    <link rel="modulepreload" href="/assets/chunks/flowchart-elk-definition-725b2045.0550a86e.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-6075699d.d0428add.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-f7375806.cd49d887.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-5b3884e4.212c93c0.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.ade1a5ba.js">
    <link rel="modulepreload" href="/assets/chunks/giscus-2a044aea.497f0bd4.js">
    <link rel="modulepreload" href="/assets/posts_db_TimescaleDB_TimescaleDB.md.12eff5df.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <script>import("/pagefind/pagefind.js").then(i=>{window.__pagefind__=i,i.init()}).catch(()=>{});</script>
  </head>
  <body><!--v-if--><!--teleport anchor-->
    <div id="app"><div class="Layout" data-v-af5a5a9a data-v-ae5c84bb><!--[--><!--[--><!--]--><!----><!--[--><div style="display:none;" class="theme-blog-popover" data-pagefind-ignore="all" data-v-5c56a737><div class="header" data-v-5c56a737><div class="title-wrapper" data-v-5c56a737><i class="el-icon" style="font-size:20px;" data-v-5c56a737><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" data-v-5c56a737><path fill="currentColor" d="M288 128h608L736 384l160 256H288v320h-96V64h96v64z"></path></svg><!--]--></i><span class="title" data-v-5c56a737></span></div><i class="el-icon close-icon" style="font-size:20px;" data-v-5c56a737><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" data-v-5c56a737><path fill="currentColor" d="M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"></path></svg><!--]--></i></div><!----><div class="footer content" data-v-5c56a737><!--[--><!--]--></div></div><div style="display:none;" class="theme-blog-popover-close" data-v-5c56a737><i class="el-icon" style="font-size:20px;" data-v-5c56a737><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" data-v-5c56a737><path fill="currentColor" d="M288 128h608L736 384l160 256H288v320h-96V64h96v64z"></path></svg><!--]--></i></div><!--]--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-ae5c84bb data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-a0fd61f4><div class="container" data-v-a0fd61f4><div class="title" data-v-a0fd61f4><div class="VPNavBarTitle" data-v-a0fd61f4 data-v-86d1bed8><a class="title" href="/" data-v-86d1bed8><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo-transform.png" alt data-v-8426fc1a><!--]--><!--[-->Gnl<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a0fd61f4><div class="curtain" data-v-a0fd61f4></div><div class="content-body" data-v-a0fd61f4><!--[--><!--]--><div class="blog-search search" data-pagefind-ignore="all" data-v-a0fd61f4 style="--54fbd49d:1;" data-v-bebd53ce><div class="nav-search-btn-wait" data-v-bebd53ce><svg width="14" height="14" viewBox="0 0 20 20" data-v-bebd53ce><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" data-v-bebd53ce></path></svg><span class="search-tip" data-v-bebd53ce>Search</span><span class="metaKey" data-v-bebd53ce> K </span></div><!--teleport start--><!--teleport end--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a0fd61f4 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>首页</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>前端</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/fe/%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE.html" data-v-43f1e123><!--[-->前端项目工程化<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/fe/JavaScript/JavaScript.html" data-v-43f1e123><!--[-->JavaScript<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/fe/TypeScript/TypeScript.html" data-v-43f1e123><!--[-->TypeScript<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/fe/React/React.html" data-v-43f1e123><!--[-->React<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/fe/Vuejs/Vuejs.html" data-v-43f1e123><!--[-->Vue.js<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>后端</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/be/Java/Java.html" data-v-43f1e123><!--[-->Java<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/be/Spring/Spring.html" data-v-43f1e123><!--[-->Spring<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/be/SpringBoot/SpringBoot.html" data-v-43f1e123><!--[-->SpringBoot<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/be/SpringCloud/SpringCloud.html" data-v-43f1e123><!--[-->SpringCloud<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/be/Dubbo/Dubbo.html" data-v-43f1e123><!--[-->Dubbo<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>数据库</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/db/MySQL/MySQL.html" data-v-43f1e123><!--[-->MySQL<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/db/PostgreSQL/PostgreSQL.html" data-v-43f1e123><!--[-->PostgreSQL<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/db/Redis/Redis.html" data-v-43f1e123><!--[-->Redis<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>中间件</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/mw/Netty/Netty.html" data-v-43f1e123><!--[-->Netty<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/mw/RocketMQ/RocketMQ/RocketMQ.html" data-v-43f1e123><!--[-->RocketMQ<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/mw/Kafka/Kafka.html" data-v-43f1e123><!--[-->Kafka<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/mw/Elesticsearch/Elesticsearch.html" data-v-43f1e123><!--[-->Elesticsearch<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>DevOps</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/mw/Docker/Docker.html" data-v-43f1e123><!--[-->Docker<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/mw/Kubernetes/Kubernetes.html" data-v-43f1e123><!--[-->Kubernetes<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/posts/mw/GitLab/GitLab.html" data-v-43f1e123><!--[-->GitLab<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about.html" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>关于</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a0fd61f4 data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-e6aabb21 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-a0fd61f4 data-v-40855f84 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9c007e85><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a0fd61f4 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav fixed reached-top" data-v-ae5c84bb data-v-79c8c1df><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-79c8c1df data-v-1c15a60a><button data-v-1c15a60a>Return to top</button><!----></div></div><!----><div class="VPContent" id="VPContent" data-pagefind-body data-v-ae5c84bb data-v-669faec9><div class="VPDoc has-aside" data-v-669faec9 data-v-6b87e69f><!--[--><!--]--><div class="container" data-v-6b87e69f><div class="aside" data-v-6b87e69f><div class="aside-curtain" data-v-6b87e69f></div><div class="aside-container" data-v-6b87e69f><div class="aside-content" data-v-6b87e69f><div class="VPDocAside" data-v-6b87e69f data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-d330b1bb><div class="content" data-v-d330b1bb><div class="outline-marker" data-v-d330b1bb></div><div class="outline-title" role="heading" aria-level="2" data-v-d330b1bb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d330b1bb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d330b1bb> Table of Contents for current page </span><ul class="root" data-v-d330b1bb data-v-d0ee3533><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6b87e69f><div class="content-container" data-v-6b87e69f><!--[--><!--[--><!--[--><!--[--><!--]--><!----><!----><!--]--><!--]--><!--]--><!----><main class="main" data-v-6b87e69f><div style="position:relative;" class="vp-doc _posts_db_TimescaleDB_TimescaleDB" data-v-6b87e69f><div><h1 id="timescaledb" tabindex="-1">TimescaleDB <a class="header-anchor" href="#timescaledb" aria-label="Permalink to &quot;TimescaleDB&quot;">​</a></h1><blockquote><p>Databases have always had time fields, but using a special database for handling time-series data can make your database work much more effectively.</p><p>Specialized time-series databases, like Timescale, are designed to handle large amounts of database writes, so they work much faster. They are also optimized to handle schema changes, and use more flexible indexing, so you don&#39;t need to spend time migrating your data whenever you make a change.</p></blockquote><h2 id="使用" tabindex="-1">使用 <a class="header-anchor" href="#使用" aria-label="Permalink to &quot;使用&quot;">​</a></h2><p>以 PostgreSQL 扩展的形式</p><blockquote><p>You can use PostgreSQL extensions with Timescale. These are the currently supported extensions:</p><table><thead><tr><th style="text-align:left;">Extension</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="https://docs.timescale.com/use-timescale/latest/extensions/postgis/" target="_blank" rel="noreferrer">postgis</a></td><td style="text-align:left;">PostGIS geometry and geography spatial types and functions</td></tr><tr><td style="text-align:left;">timescaledb_toolkit</td><td style="text-align:left;">TimescaleDB Toolkit</td></tr><tr><td style="text-align:left;">timescaledb</td><td style="text-align:left;">Enables scalable inserts and complex queries for time-series data</td></tr><tr><td style="text-align:left;">…</td><td style="text-align:left;"></td></tr></tbody></table></blockquote><h2 id="hypertables" tabindex="-1">Hypertables <a class="header-anchor" href="#hypertables" aria-label="Permalink to &quot;Hypertables&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/hypertables/#hypertables" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/hypertables/#hypertables</a></p></blockquote><p><strong>What is Hypertable?</strong></p><ul><li><p>Hypertables are PostgreSQL tables with special features that make it easy to handle time-series data.</p></li><li><p>Hypertables are PostgreSQL tables that automatically partition your data by time.</p></li></ul><p><strong>How Hypertable exists?</strong></p><p>In Timescale, hypertables exist alongside regular PostgreSQL tables.</p><p><strong>The differences with normal tables?</strong></p><ul><li>A hypertable is always partitioned on time, but can also be partitioned on additional columns as well.</li><li>The other special thing about hypertables is that they are broken down into smaller tables called <strong>chunks</strong>.</li></ul><p><strong>The same behaviours with normal tabls?</strong></p><p>Anything you can do with regular PostgreSQL tables, you can do with hypertables. Such as create an index.</p><p><strong>How Hypertable works?</strong></p><p>With hypertables, Timescale makes it easy to improve insert and query performance by <em>partitioning time-series data on its time parameter</em>.</p><h3 id="create" tabindex="-1">Create <a class="header-anchor" href="#create" aria-label="Permalink to &quot;Create&quot;">​</a></h3><p>create a normal table.</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">CREATE TABLE stocks_real_time (</span></span>
<span class="line"><span style="color:#e1e4e8;">  time TIMESTAMPTZ NOT NULL,</span></span>
<span class="line"><span style="color:#e1e4e8;">  symbol TEXT NOT NULL,</span></span>
<span class="line"><span style="color:#e1e4e8;">  price DOUBLE PRECISION NULL,</span></span>
<span class="line"><span style="color:#e1e4e8;">  day_volume INT NULL</span></span>
<span class="line"><span style="color:#e1e4e8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">CREATE TABLE stocks_real_time (</span></span>
<span class="line"><span style="color:#24292e;">  time TIMESTAMPTZ NOT NULL,</span></span>
<span class="line"><span style="color:#24292e;">  symbol TEXT NOT NULL,</span></span>
<span class="line"><span style="color:#24292e;">  price DOUBLE PRECISION NULL,</span></span>
<span class="line"><span style="color:#24292e;">  day_volume INT NULL</span></span>
<span class="line"><span style="color:#24292e;">);</span></span></code></pre></div><p>convert a normal table into a hypertable partitioned on the <code>time</code> column using the <code>create_hypertable()</code> function provided by Timescale.</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT create_hypertable(&#39;stocks_real_time&#39;,&#39;time&#39;);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT create_hypertable(&#39;stocks_real_time&#39;,&#39;time&#39;);</span></span></code></pre></div><h3 id="partitioning" tabindex="-1">Partitioning <a class="header-anchor" href="#partitioning" aria-label="Permalink to &quot;Partitioning&quot;">​</a></h3><ul><li>When you create and use a hypertable, it automatically partitions data by time, and optionally by space.</li><li>Each hypertable is made up of child tables called chunks. Each chunk is assigned a range of time, and only contains data from that range.</li><li>If the hypertable is also partitioned by space, each chunk is also assigned a subset of the space values.</li></ul><p>Hypertable 中的每个 chunk 都只包含特定时间范围内的数据。当现有的 chunk 不包括新插入数据的时间范围，TimescaleDB 会自动创建新的 chunk 存储该数据。</p><p>默认情况下 chunk 包含的时间范围是 7 天，可以使用 <code>chunk_time_interval</code> 设置成 1 天或者其他自定义值。</p><p><img src="/assets/hypertables-chunks.1d8d7e36.webp" alt="A normal table compared to a hypertable. The normal table holds data for 3 different days in one container. The hypertable contains 3 containers, called chunks, each of which holds data for a separate day."></p><h3 id="chunk-interval" tabindex="-1">Chunk interval <a class="header-anchor" href="#chunk-interval" aria-label="Permalink to &quot;Chunk interval&quot;">​</a></h3><p>Hypertable 中的数据根据一个 interval 来划分为不同的 chunk。查看当前的 interval：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT h.table_name, c.interval_length</span></span>
<span class="line"><span style="color:#e1e4e8;">  FROM _timescaledb_catalog.dimension c</span></span>
<span class="line"><span style="color:#e1e4e8;">  JOIN _timescaledb_catalog.hypertable h</span></span>
<span class="line"><span style="color:#e1e4e8;">    ON h.id = c.hypertable_id;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT h.table_name, c.interval_length</span></span>
<span class="line"><span style="color:#24292e;">  FROM _timescaledb_catalog.dimension c</span></span>
<span class="line"><span style="color:#24292e;">  JOIN _timescaledb_catalog.hypertable h</span></span>
<span class="line"><span style="color:#24292e;">    ON h.id = c.hypertable_id;</span></span></code></pre></div><p>输出内容大概如下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">table_name</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">interval_length</span></span>
<span class="line"><span style="color:#B392F0;">-----------+-----------------</span></span>
<span class="line"><span style="color:#B392F0;">metrics</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">604800000000</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">row</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">table_name</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">interval_length</span></span>
<span class="line"><span style="color:#6F42C1;">-----------+-----------------</span></span>
<span class="line"><span style="color:#6F42C1;">metrics</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">    </span><span style="color:#6F42C1;">604800000000</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">row</span><span style="color:#24292E;">)</span></span></code></pre></div><p>可以在建表的时候指定 interval：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT create_hypertable(</span></span>
<span class="line"><span style="color:#e1e4e8;">  &#39;conditions&#39;, -- table name</span></span>
<span class="line"><span style="color:#e1e4e8;">  &#39;time&#39;, -- timestamp colum</span></span>
<span class="line"><span style="color:#e1e4e8;">  chunk_time_interval =&gt; INTERVAL &#39;1 day&#39;</span></span>
<span class="line"><span style="color:#e1e4e8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT create_hypertable(</span></span>
<span class="line"><span style="color:#24292e;">  &#39;conditions&#39;, -- table name</span></span>
<span class="line"><span style="color:#24292e;">  &#39;time&#39;, -- timestamp colum</span></span>
<span class="line"><span style="color:#24292e;">  chunk_time_interval =&gt; INTERVAL &#39;1 day&#39;</span></span>
<span class="line"><span style="color:#24292e;">);</span></span></code></pre></div><p>也可以修改已存在表的 interval：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT set_chunk_time_interval(</span></span>
<span class="line"><span style="color:#e1e4e8;">    &#39;conditions&#39;, -- table name</span></span>
<span class="line"><span style="color:#e1e4e8;">    INTERVAL &#39;24 hours&#39; -- the new interval</span></span>
<span class="line"><span style="color:#e1e4e8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT set_chunk_time_interval(</span></span>
<span class="line"><span style="color:#24292e;">    &#39;conditions&#39;, -- table name</span></span>
<span class="line"><span style="color:#24292e;">    INTERVAL &#39;24 hours&#39; -- the new interval</span></span>
<span class="line"><span style="color:#24292e;">);</span></span></code></pre></div><blockquote><p>When you change the <code>chunk_time_interval</code>, the new setting only applies to new chunks, not to existing chunks. If you need to correct this situation, create a new hypertable and migrate your data.</p></blockquote><p><strong>最佳实践</strong></p><p>1、<a href="https://docs.timescale.com/use-timescale/latest/hypertables/change-chunk-intervals/" target="_blank" rel="noreferrer">chunk_time_interval 的设置</a>。</p><p>分区 chunk 的大小会影响到数据插入和查询的性能。你可能会想使用足够小的 chunk 保存在内存中，这样一来在插入和查询最近的数据时就不需要和磁盘打交道。但同时你可能不想有太多的 chunk 碎片，在后续这会影响到数据的查询和压缩效率。</p><p>推荐的 <code>chunk_time_interval</code> 有这样一个公式：chunk 占用的空间 = 内存空间的 25%。如果每天产生 2GB 的数据，且内存大小为 64GB，那么 <code>chunk_time_interval</code> 应该设置为一个星期比较合适。因为 chunk 占用的空间 = 7 * 2GB = 14 GB ≈ 64 GB * 25% = 16 GB。</p><blockquote><p>如果使用了类似 PostGIS 地理位置索引这类代价较为昂贵的索引类型， 需要注意 chunk 和它的索引占用的总空间大小。可以使用 chunks_detailed_size 方法。</p></blockquote><p>2、如何优化 <a href="https://www.timescale.com/blog/timescale-cloud-tips-testing-your-chunk-size/" target="_blank" rel="noreferrer">chunk_time_interval</a>。</p><h3 id="alter-a-hypertable" tabindex="-1">Alter a hypertable <a class="header-anchor" href="#alter-a-hypertable" aria-label="Permalink to &quot;Alter a hypertable&quot;">​</a></h3><ul><li><p>add a column</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ALTER TABLE conditions</span></span>
<span class="line"><span style="color:#e1e4e8;">  ADD COLUMN humidity DOUBLE PRECISION NULL;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ALTER TABLE conditions</span></span>
<span class="line"><span style="color:#24292e;">  ADD COLUMN humidity DOUBLE PRECISION NULL;</span></span></code></pre></div></li><li><p>rename a hypertable</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ALTER TABLE conditions</span></span>
<span class="line"><span style="color:#e1e4e8;">  RENAME TO weather;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ALTER TABLE conditions</span></span>
<span class="line"><span style="color:#24292e;">  RENAME TO weather;</span></span></code></pre></div></li></ul><h3 id="hypertable-index" tabindex="-1">Hypertable index <a class="header-anchor" href="#hypertable-index" aria-label="Permalink to &quot;Hypertable index&quot;">​</a></h3><ul><li><p>默认情况下在创建 hypertable 的同时也会自动创建索引。可以将 <code>create_default_indexes</code> 设置为 <code>false</code> 来阻止这一行为。</p></li><li><p>默认时间为分区的 hypertable 自动创建的索引包括 time 列降序排序；在以空间为分区的 hypertable 中，自动创建的索引包括空间分区的列和时间列。</p></li><li><p><a href="https://docs.timescale.com/use-timescale/latest/hypertables/hypertables-and-unique-indexes/" target="_blank" rel="noreferrer">创建唯一索引</a>包含一些约束条件：</p><p>The unique index must contain all the partitioning columns of the hypertable, and optionally additional columns.</p></li></ul><h3 id="分布式超表" tabindex="-1">分布式超表 <a class="header-anchor" href="#分布式超表" aria-label="Permalink to &quot;分布式超表&quot;">​</a></h3><blockquote><p><a href="https://docs.timescale.com/self-hosted/latest/distributed-hypertables/" target="_blank" rel="noreferrer">https://docs.timescale.com/self-hosted/latest/distributed-hypertables/</a></p></blockquote><h3 id="超表限制" tabindex="-1">超表限制 <a class="header-anchor" href="#超表限制" aria-label="Permalink to &quot;超表限制&quot;">​</a></h3><h4 id="普通超表" tabindex="-1">普通超表 <a class="header-anchor" href="#普通超表" aria-label="Permalink to &quot;普通超表&quot;">​</a></h4><ul><li>用作分区的时间维度（列）不允许为 NULL；</li><li>唯一索引必须包含所有用作分区的列；</li><li>不支持在分区之间移动值的更新语句（包括 <code>insert ... on conflict update</code>）。</li></ul><h4 id="分布式超表-1" tabindex="-1">分布式超表 <a class="header-anchor" href="#分布式超表-1" aria-label="Permalink to &quot;分布式超表&quot;">​</a></h4><p>普通超级表中的限制同样适用于分布式超级表。此外，分布式超级表还有以下限制：</p><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/limitations/#distributed-hypertable-limitations" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/limitations/#distributed-hypertable-limitations</a></p></blockquote><h2 id="time-buckets" tabindex="-1">Time buckets <a class="header-anchor" href="#time-buckets" aria-label="Permalink to &quot;Time buckets&quot;">​</a></h2><blockquote><p>Time buckets enable you to aggregate data by time interval. For example, you can group data into 5-minute, 1-hour, and 3-day buckets to calculate summary values.</p></blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/time-buckets/" target="_blank" rel="noreferrer">Time buckets</a> 能以时间间隔的方式将数据聚合起来。例如，可以将 5 分钟、10 分钟、15 分钟这三个时间段的数据分成不同的时间桶，再进行统一的数据操作。和 PostgreSQL 中的 <a href="https://www.postgresql.org/docs/current/functions-datetime.html#FUNCTIONS-DATETIME-BIN" target="_blank" rel="noreferrer">date_bin</a> 方法类似。</p><h2 id="schema-管理" tabindex="-1">Schema 管理 <a class="header-anchor" href="#schema-管理" aria-label="Permalink to &quot;Schema 管理&quot;">​</a></h2><blockquote><p>A database schema defines how the tables and indexes in your database are organized. Using a schema that is appropriate for your workload can result in significant performance improvements.</p></blockquote><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/schema-management/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/schema-management/</a></p></blockquote><h2 id="数据操作" tabindex="-1">数据操作 <a class="header-anchor" href="#数据操作" aria-label="Permalink to &quot;数据操作&quot;">​</a></h2><h3 id="数据插入" tabindex="-1">数据插入 <a class="header-anchor" href="#数据插入" aria-label="Permalink to &quot;数据插入&quot;">​</a></h3><p>Writing data to TimescaleDB works the same way as writing data to regular PostgreSQL.</p><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/write-data/#writing-data" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/write-data/#writing-data</a></p></blockquote><h3 id="数据查询" tabindex="-1">数据查询 <a class="header-anchor" href="#数据查询" aria-label="Permalink to &quot;数据查询&quot;">​</a></h3><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/query-data/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/query-data/</a></p></blockquote><ul><li>所有 PostgreSQL 适用的语句 TimescaleDB 同样适用。</li><li>可以使用 <a href="https://docs.timescale.com/use-timescale/latest/query-data/skipscan/" target="_blank" rel="noreferrer">SkipScan</a> 加速 <code>distinct</code> 关键字的查询速度。</li><li>TimescaleDB 提供 <a href="https://docs.timescale.com/use-timescale/latest/hyperfunctions/" target="_blank" rel="noreferrer">Hyperfunctions</a> 来优化数据分析查询语句的编写体验。</li><li>TimescaleDB 提供 <a href="https://docs.timescale.com/use-timescale/latest/hyperfunctions/function-pipelines/" target="_blank" rel="noreferrer">Function pipelines</a> 来将函数式编程带入到 SQL 语句中，适用于连续的数据处理操作。</li><li><a href="https://docs.timescale.com/use-timescale/latest/query-data/advanced-analytic-queries/" target="_blank" rel="noreferrer">进阶的分析查询方法</a></li></ul><h2 id="数据压缩" tabindex="-1">数据压缩 <a class="header-anchor" href="#数据压缩" aria-label="Permalink to &quot;数据压缩&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/compression/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/compression/</a></p></blockquote><h3 id="why" tabindex="-1">Why <a class="header-anchor" href="#why" aria-label="Permalink to &quot;Why&quot;">​</a></h3><blockquote><p>Time-series data can be compressed to reduce the amount of storage required, and increase the speed of some queries.</p><p>减少空间使用，加快查询速度。</p></blockquote><h3 id="when" tabindex="-1">When <a class="header-anchor" href="#when" aria-label="Permalink to &quot;When&quot;">​</a></h3><blockquote><p>When new data is added to your database, it is in the form of uncompressed rows. Timescale uses a built-in job scheduler to convert this data to the form of compressed columns. <strong>When you enable compression</strong>, the data in your hypertable is compressed chunk by chunk.</p><p>新增数据会被添加到为被压缩的列，当启用了压缩 Timescale 会将超表中的数据按照一个个 chunk 来压缩。</p></blockquote><h3 id="benefits" tabindex="-1">Benefits <a class="header-anchor" href="#benefits" aria-label="Permalink to &quot;Benefits&quot;">​</a></h3><blockquote><p>Compressing your time-series data allows you to reduce your chunk size by <strong>more than 90%</strong>. This saves on storage costs, and keeps your queries operating at lightning speed.</p><p>When the chunk is compressed, multiple records are grouped into a single row. The columns of this row hold an array-like structure that stores all the data. This means that instead of using lots of rows to store the data, it stores the same data in a single row.</p><p>Because a single row takes up less disk space than many rows, it decreases the amount of disk space required, and can also speed up your queries.</p><p>减少超过 90% 的空间占用，加快查询速度。</p><p>chunk 被压缩时会根据设置的压缩字段（compress_segmentby）将多行记录进行分组，组成一行。单行内的数据按照指定的排序字段（compress_orderby）排列，组成类似数组一样的数据结构。</p></blockquote><h3 id="数据压缩操作" tabindex="-1">数据压缩操作 <a class="header-anchor" href="#数据压缩操作" aria-label="Permalink to &quot;数据压缩操作&quot;">​</a></h3><p>可以在 hypertable 上分别开启压缩功能，只要指定分段压缩依据的列即可。</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-- 在 example 表上开启数据压缩</span></span>
<span class="line"><span style="color:#e1e4e8;">-- 压缩的数据根据 device_id 这一列来分段</span></span>
<span class="line"><span style="color:#e1e4e8;">ALTER TABLE example SET (</span></span>
<span class="line"><span style="color:#e1e4e8;">  timescaledb.compress,</span></span>
<span class="line"><span style="color:#e1e4e8;">  -- timescaledb.compress_orderby -- The default is the descending order of the hypertable&#39;s time column.</span></span>
<span class="line"><span style="color:#e1e4e8;">  timescaledb.compress_segmentby = &#39;device_id&#39;</span></span>
<span class="line"><span style="color:#e1e4e8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-- 在 example 表上开启数据压缩</span></span>
<span class="line"><span style="color:#24292e;">-- 压缩的数据根据 device_id 这一列来分段</span></span>
<span class="line"><span style="color:#24292e;">ALTER TABLE example SET (</span></span>
<span class="line"><span style="color:#24292e;">  timescaledb.compress,</span></span>
<span class="line"><span style="color:#24292e;">  -- timescaledb.compress_orderby -- The default is the descending order of the hypertable&#39;s time column.</span></span>
<span class="line"><span style="color:#24292e;">  timescaledb.compress_segmentby = &#39;device_id&#39;</span></span>
<span class="line"><span style="color:#24292e;">);</span></span></code></pre></div><p>开启完成后添加压缩策略，设置数据压缩的时间间隔为 7 天：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT add_compression_policy(&#39;example&#39;, INTERVAL &#39;7 days&#39;);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT add_compression_policy(&#39;example&#39;, INTERVAL &#39;7 days&#39;);</span></span></code></pre></div><p>查看当前的压缩策略：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT * FROM timescaledb_information.jobs</span></span>
<span class="line"><span style="color:#e1e4e8;">  WHERE proc_name=&#39;policy_compression&#39;;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT * FROM timescaledb_information.jobs</span></span>
<span class="line"><span style="color:#24292e;">  WHERE proc_name=&#39;policy_compression&#39;;</span></span></code></pre></div><p>查看压缩状态：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT * FROM chunk_compression_stats(&#39;example&#39;);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT * FROM chunk_compression_stats(&#39;example&#39;);</span></span></code></pre></div><p>删除某个表上的压缩策略：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT remove_compression_policy(&#39;example&#39;); -- 删除 example 表的压缩策略</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT remove_compression_policy(&#39;example&#39;); -- 删除 example 表的压缩策略</span></span></code></pre></div><p>关闭数据压缩功能：</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ALTER TABLE example SET (timescaledb.compress=false);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ALTER TABLE example SET (timescaledb.compress=false);</span></span></code></pre></div><h3 id="数据压缩阶段" tabindex="-1">数据压缩阶段 <a class="header-anchor" href="#数据压缩阶段" aria-label="Permalink to &quot;数据压缩阶段&quot;">​</a></h3><p>一个 chunk 在被压缩的过程中分为下面三个阶段：</p><ul><li><code>Active</code> and uncompressed</li><li><code>Compression candidate</code> and uncompressed</li><li><code>Compressed</code></li></ul><p><code>Active</code> 阶段未进行压缩，并且允许数据插入。压缩进程如下图：</p><p><img src="/assets/compression_diagram.7da7f553.webp" alt="Compression timeline"></p><h3 id="压缩分段列" tabindex="-1">压缩分段列 <a class="header-anchor" href="#压缩分段列" aria-label="Permalink to &quot;压缩分段列&quot;">​</a></h3><p>开启数据压缩需要指定一个列来作为分段依据，最好是包含重复值较多的，具有单个值的列。</p><blockquote><p>在时序数据库中因为要记录某个点位数据的变化情况，通常来说 id 列会包含较多的重复值。</p></blockquote><table><thead><tr><th style="text-align:left;">time</th><th style="text-align:left;">device_id</th><th style="text-align:left;">cpu</th><th style="text-align:left;">disk_io</th><th style="text-align:left;">energy_consumption</th></tr></thead><tbody><tr><td style="text-align:left;">[12:00:02, 12:00:01]</td><td style="text-align:left;">1</td><td style="text-align:left;">[88.2, 88.6]</td><td style="text-align:left;">[20, 25]</td><td style="text-align:left;">[0.8, 0.85]</td></tr><tr><td style="text-align:left;">[12:00:02, 12:00:01]</td><td style="text-align:left;">2</td><td style="text-align:left;">[300.5, 299.1]</td><td style="text-align:left;">[30, 40]</td><td style="text-align:left;">[0.9, 0.95]</td></tr></tbody></table><p>如上表所示，单值列 device_id 就能直接映射到一整行数据，在使用 <code>WHERE</code> 从句来进行查询过滤的时候就更加高效。而且使用单值列可以在数据查询过滤之后再对结果进行解压，而不是先解压再过滤。不像其他多值列一样需要先解压才能对比，</p><h3 id="压缩顺序" tabindex="-1">压缩顺序 <a class="header-anchor" href="#压缩顺序" aria-label="Permalink to &quot;压缩顺序&quot;">​</a></h3><p>默认情况下按照 hypertable 的时间列的降序进行压缩，在很多情况下默认设置都能发挥较好的作用。如果应用场景比较复杂，可以使用 <code>compress_orderby</code> 来修改压缩顺序。</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ALTER TABLE  example</span></span>
<span class="line"><span style="color:#e1e4e8;">  SET (timescaledb.compress,</span></span>
<span class="line"><span style="color:#e1e4e8;">       timescaledb.compress_orderby = &#39;device_id, time DESC&#39;);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ALTER TABLE  example</span></span>
<span class="line"><span style="color:#24292e;">  SET (timescaledb.compress,</span></span>
<span class="line"><span style="color:#24292e;">       timescaledb.compress_orderby = &#39;device_id, time DESC&#39;);</span></span></code></pre></div><blockquote><p><code>orderby</code> 和 <code>segmentby</code> 可能会达到相同的结果，如果你设置了 segmentby 但是没有设置 orderby，在进行数据压缩的时候 timescale 也能按照 segmentby 的设置压缩顺序进行合适的调整。</p></blockquote><h3 id="手动压缩" tabindex="-1">手动压缩 <a class="header-anchor" href="#手动压缩" aria-label="Permalink to &quot;手动压缩&quot;">​</a></h3><blockquote><p>很多情况下自动压缩已经满足需求了，如果需要对压缩过程进行更加细致的控制，可以尝试使用<a href="https://docs.timescale.com/use-timescale/latest/compression/manual-compression/" target="_blank" rel="noreferrer">手动压缩</a>。</p></blockquote><h3 id="压缩块数据修改" tabindex="-1">压缩块数据修改 <a class="header-anchor" href="#压缩块数据修改" aria-label="Permalink to &quot;压缩块数据修改&quot;">​</a></h3><blockquote><p>TimescaleDB 2.11 之后，支持对已压缩的 chunk 数据进行<a href="https://docs.timescale.com/use-timescale/latest/compression/modify-compressed-data/" target="_blank" rel="noreferrer">修改和插入操作</a>。</p></blockquote><h3 id="压缩块解压" tabindex="-1">压缩块解压 <a class="header-anchor" href="#压缩块解压" aria-label="Permalink to &quot;压缩块解压&quot;">​</a></h3><blockquote><p>Timescale automatically supports <code>INSERT</code>s into compressed chunks. But if you need to insert a lot of data, for example as part of a bulk backfilling operation, you should first decompress the chunk. Inserting data into a compressed chunk is more computationally expensive than inserting data into an uncompressed chunk. This adds up over a lot of rows.</p></blockquote><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/compression/decompress-chunks/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/compression/decompress-chunks/</a></p></blockquote><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-- 按照时间顺序将所有的 chunk 解压</span></span>
<span class="line"><span style="color:#e1e4e8;">SELECT decompress_chunk(c, true)</span></span>
<span class="line"><span style="color:#e1e4e8;">    FROM show_chunks(&#39;table_name&#39;, older_than, newer_than) c;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-- 按照时间顺序将所有的 chunk 解压</span></span>
<span class="line"><span style="color:#24292e;">SELECT decompress_chunk(c, true)</span></span>
<span class="line"><span style="color:#24292e;">    FROM show_chunks(&#39;table_name&#39;, older_than, newer_than) c;</span></span></code></pre></div><h2 id="数据迁移" tabindex="-1">数据迁移 <a class="header-anchor" href="#数据迁移" aria-label="Permalink to &quot;数据迁移&quot;">​</a></h2><h3 id="普通表迁移" tabindex="-1">普通表迁移 <a class="header-anchor" href="#普通表迁移" aria-label="Permalink to &quot;普通表迁移&quot;">​</a></h3><blockquote><p><a href="https://docs.timescale.com/self-hosted/latest/migration/" target="_blank" rel="noreferrer">https://docs.timescale.com/self-hosted/latest/migration/</a></p></blockquote><p>TimescaleDB 可以借助 PostgreSQL 提供的 <a href="https://www.postgresql.org/docs/current/app-pgdump.html" target="_blank" rel="noreferrer">pg_dump</a> 和 <a href="https://www.postgresql.org/docs/current/app-pgrestore.html" target="_blank" rel="noreferrer">pg_restore</a> 工具来完成数据迁移操作。</p><p><strong>数据备份</strong></p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-- 从名为 tsdb 的数据库备份</span></span>
<span class="line"><span style="color:#e1e4e8;">pg_dump -Fc -f tsdb.bak tsdb</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 备份远程数据库</span></span>
<span class="line"><span style="color:#e1e4e8;">pg_dump -h &lt;REMOTE_HOST&gt; -p 5432 -U tsdbadmin -Fc -f tsdb.bak tsdb</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-- 从名为 tsdb 的数据库备份</span></span>
<span class="line"><span style="color:#24292e;">pg_dump -Fc -f tsdb.bak tsdb</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 备份远程数据库</span></span>
<span class="line"><span style="color:#24292e;">pg_dump -h &lt;REMOTE_HOST&gt; -p 5432 -U tsdbadmin -Fc -f tsdb.bak tsdb</span></span></code></pre></div><blockquote><p>注意：<strong>不要使用 pd_dump 工具直接备份超表</strong>，因为使用这个方法生成的 dump 文件缺少超表需要的一些必要文件，会导致超表无法能够正确恢复。</p></blockquote><p>…</p><p><strong>数据恢复</strong></p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-- 1</span></span>
<span class="line"><span style="color:#e1e4e8;">CREATE DATABASE tsdb; -- 创建数据库</span></span>
<span class="line"><span style="color:#e1e4e8;">\c tsdb -- 连接</span></span>
<span class="line"><span style="color:#e1e4e8;">CREATE EXTENSION IF NOT EXISTS timescaledb; -- 创建扩展</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 2</span></span>
<span class="line"><span style="color:#e1e4e8;">-- put your database in the right state for restoring</span></span>
<span class="line"><span style="color:#e1e4e8;">SELECT timescaledb_pre_restore();</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 3</span></span>
<span class="line"><span style="color:#e1e4e8;">-- Restore the database</span></span>
<span class="line"><span style="color:#e1e4e8;">\! pg_restore -Fc -d tsdb tsdb.bak</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">-- 4</span></span>
<span class="line"><span style="color:#e1e4e8;">-- return your database to normal operations</span></span>
<span class="line"><span style="color:#e1e4e8;">SELECT timescaledb_post_restore();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-- 1</span></span>
<span class="line"><span style="color:#24292e;">CREATE DATABASE tsdb; -- 创建数据库</span></span>
<span class="line"><span style="color:#24292e;">\c tsdb -- 连接</span></span>
<span class="line"><span style="color:#24292e;">CREATE EXTENSION IF NOT EXISTS timescaledb; -- 创建扩展</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 2</span></span>
<span class="line"><span style="color:#24292e;">-- put your database in the right state for restoring</span></span>
<span class="line"><span style="color:#24292e;">SELECT timescaledb_pre_restore();</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 3</span></span>
<span class="line"><span style="color:#24292e;">-- Restore the database</span></span>
<span class="line"><span style="color:#24292e;">\! pg_restore -Fc -d tsdb tsdb.bak</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">-- 4</span></span>
<span class="line"><span style="color:#24292e;">-- return your database to normal operations</span></span>
<span class="line"><span style="color:#24292e;">SELECT timescaledb_post_restore();</span></span></code></pre></div><blockquote><p>注意：不能使用 <code>pg_restore -j</code> 因为 <code>-j</code> 参数会导致数据库无法正确恢复 TimescaleDB 的目录结构。</p></blockquote><p>…</p><hr><h3 id="超表迁移" tabindex="-1">超表迁移 <a class="header-anchor" href="#超表迁移" aria-label="Permalink to &quot;超表迁移&quot;">​</a></h3><blockquote><p><strong>旧的方法</strong></p><hr><p><strong>超表备份</strong></p><p>1、备份超表结构</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">pg_dump -s -d old_db --table &lt;table-name&gt; -N _timescaledb_internal | \</span></span>
<span class="line"><span style="color:#e1e4e8;">grep -v _timescaledb_internal &gt; schema.sql</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">pg_dump -s -d old_db --table &lt;table-name&gt; -N _timescaledb_internal | \</span></span>
<span class="line"><span style="color:#24292e;">grep -v _timescaledb_internal &gt; schema.sql</span></span></code></pre></div><p>2、将超表数据备份到 csv 文件</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">psql -d old_db \</span></span>
<span class="line"><span style="color:#e1e4e8;">-c &quot;\COPY (SELECT * FROM table_name) TO data_name.csv DELIMITER &#39;,&#39; CSV&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">psql -d old_db \</span></span>
<span class="line"><span style="color:#24292e;">-c &quot;\COPY (SELECT * FROM table_name) TO data_name.csv DELIMITER &#39;,&#39; CSV&quot;</span></span></code></pre></div><p>…</p><hr><p><strong>超表恢复</strong></p><p>1、恢复表结构</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">psql -d new_db &lt; schema.sql</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">psql -d new_db &lt; schema.sql</span></span></code></pre></div><p>2、重新创建超表</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">psql -d new_db -c &quot;SELECT create_hypertable(</span></span>
<span class="line"><span style="color:#e1e4e8;">    &#39;&lt;table-name&gt;&#39;, &#39;&lt;time-colum&gt;&#39;,</span></span>
<span class="line"><span style="color:#e1e4e8;">    chunk_time_interval =&gt; INTERVAL &#39;&lt;CHUNK_TIME_INTERVAL&gt;&#39;</span></span>
<span class="line"><span style="color:#e1e4e8;">)&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">psql -d new_db -c &quot;SELECT create_hypertable(</span></span>
<span class="line"><span style="color:#24292e;">    &#39;&lt;table-name&gt;&#39;, &#39;&lt;time-colum&gt;&#39;,</span></span>
<span class="line"><span style="color:#24292e;">    chunk_time_interval =&gt; INTERVAL &#39;&lt;CHUNK_TIME_INTERVAL&gt;&#39;</span></span>
<span class="line"><span style="color:#24292e;">)&quot;</span></span></code></pre></div><p>3、恢复数据</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">psql -d new_db -c &quot;\COPY table_name FROM data_name.csv CSV&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">psql -d new_db -c &quot;\COPY table_name FROM data_name.csv CSV&quot;</span></span></code></pre></div><p>…</p><p>When you create the new hypertable with the <code>create_hypertable</code> command, you do not need to use the same parameters as existed in the old database. This can provide a good opportunity for you to re-organize your hypertables if you need to. For example, you can change the partitioning key, the number of partitions, or the chunk interval sizes.</p></blockquote><p>…</p><hr><blockquote><p>下面是新的方法</p></blockquote><p>1、首先备份数据库的 schema</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">pg_dump -U &lt;SOURCE_DB_USERNAME&gt; -w \</span></span>
<span class="line"><span style="color:#e1e4e8;">-h &lt;SOURCE_DB_HOST&gt; -p &lt;SOURCE_DB_PORT&gt; -Fc -v \</span></span>
<span class="line"><span style="color:#e1e4e8;">--section=pre-data --exclude-schema=&quot;_timescaledb*&quot; \</span></span>
<span class="line"><span style="color:#e1e4e8;">-f dump_pre_data.bak &lt;DATABASE_NAME&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">pg_dump -U &lt;SOURCE_DB_USERNAME&gt; -w \</span></span>
<span class="line"><span style="color:#24292e;">-h &lt;SOURCE_DB_HOST&gt; -p &lt;SOURCE_DB_PORT&gt; -Fc -v \</span></span>
<span class="line"><span style="color:#24292e;">--section=pre-data --exclude-schema=&quot;_timescaledb*&quot; \</span></span>
<span class="line"><span style="color:#24292e;">-f dump_pre_data.bak &lt;DATABASE_NAME&gt;</span></span></code></pre></div><p>2、恢复 schema</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">pg_restore -U tsdbadmin -w \</span></span>
<span class="line"><span style="color:#e1e4e8;">-h &lt;HOST&gt; -p &lt;PORT&gt; --no-owner -Fc \</span></span>
<span class="line"><span style="color:#e1e4e8;">-v -d tsdb dump_pre_data.bak</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">pg_restore -U tsdbadmin -w \</span></span>
<span class="line"><span style="color:#24292e;">-h &lt;HOST&gt; -p &lt;PORT&gt; --no-owner -Fc \</span></span>
<span class="line"><span style="color:#24292e;">-v -d tsdb dump_pre_data.bak</span></span></code></pre></div><blockquote><p>To avoid permissions errors, include the <code>--no-owner</code> flag.</p></blockquote><p>3、重新创建超表（每一个超表都需要重新创建）</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">SELECT create_hypertable(</span></span>
<span class="line"><span style="color:#e1e4e8;">   &#39;&lt;TABLE_NAME&gt;&#39;, &#39;&lt;TIME_COLUMN_NAME&gt;&#39;,</span></span>
<span class="line"><span style="color:#e1e4e8;">    chunk_time_interval =&gt;</span></span>
<span class="line"><span style="color:#e1e4e8;">        INTERVAL &#39;&lt;CHUNK_TIME_INTERVAL&gt;&#39;);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">SELECT create_hypertable(</span></span>
<span class="line"><span style="color:#24292e;">   &#39;&lt;TABLE_NAME&gt;&#39;, &#39;&lt;TIME_COLUMN_NAME&gt;&#39;,</span></span>
<span class="line"><span style="color:#24292e;">    chunk_time_interval =&gt;</span></span>
<span class="line"><span style="color:#24292e;">        INTERVAL &#39;&lt;CHUNK_TIME_INTERVAL&gt;&#39;);</span></span></code></pre></div><p>4、数据备份到 csv</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">\COPY (SELECT * FROM &lt;TABLE_NAME&gt;) TO &lt;TABLE_NAME&gt;.csv CSV</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">\COPY (SELECT * FROM &lt;TABLE_NAME&gt;) TO &lt;TABLE_NAME&gt;.csv CSV</span></span></code></pre></div><blockquote><p>如果表很大，可以将表拆分成不同的时间段</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">\COPY (SELECT * FROM TABLE_NAME WHERE time &gt; &#39;2022-11-01&#39; AND time &lt; &#39;2023-11-02&#39;) TO TABLE_NAME_DATE_RANGE.csv CSV</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">\COPY (SELECT * FROM TABLE_NAME WHERE time &gt; &#39;2022-11-01&#39; AND time &lt; &#39;2023-11-02&#39;) TO TABLE_NAME_DATE_RANGE.csv CSV</span></span></code></pre></div><p><em>Split each table by time range, and copy each range individually.</em></p></blockquote><p>使用 <code>COPY</code> 备份数据全部都会变成未压缩的状态，可能会造成占用的存储空间成倍增长。为了避免空间不足的情况，尽量将压缩数据解压，再进行 COPY 操作。</p><p>5、数据恢复到超表，有两种方法：1、使用 PostgreSQL 提供的 <code>COPY</code> 命令；2、使用其他工具如 <code>timescaledb-parallel-copy</code>。后者比较快，但是非默认提供的，需要<a href="https://github.com/timescale/timescaledb-parallel-copy" target="_blank" rel="noreferrer">手动安装</a>。</p><p>5.1、使用 COPY 命令</p><p>连接上目标数据库</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">psql</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;postgres://tsdbadmin:&lt;PASSWORD&gt;@&lt;HOST&gt;:&lt;PORT&gt;/tsdb?sslmode=require&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">psql</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;postgres://tsdbadmin:&lt;PASSWORD&gt;@&lt;HOST&gt;:&lt;PORT&gt;/tsdb?sslmode=require&quot;</span></span></code></pre></div><p>进行数据恢复</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">\COPY &lt;TABLE_NAME&gt; FROM &#39;&lt;TABLE_NAME&gt;.csv&#39; WITH (FORMAT CSV);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">\COPY &lt;TABLE_NAME&gt; FROM &#39;&lt;TABLE_NAME&gt;.csv&#39; WITH (FORMAT CSV);</span></span></code></pre></div><p>5.2、使用 timescaledb-parallel-copy</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 首先，先安装 go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#使用 go 安装 timescaledb-parallel-copy</span></span>
<span class="line"><span style="color:#B392F0;">go</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">github.com/timescale/timescaledb-parallel-copy/cmd/timescaledb-parallel-copy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 对每个表都需要进行导入操作</span></span>
<span class="line"><span style="color:#B392F0;">timescaledb-parallel-copy</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">--connection </span><span style="color:#9ECBFF;">&quot;host=&lt;HOST&gt; </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#9ECBFF;">user=tsdbadmin password=&lt;PASSWORD&gt; </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#9ECBFF;">port=&lt;PORT&gt; </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#9ECBFF;">sslmode=require&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">--db-name </span><span style="color:#9ECBFF;">tsdb</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">--table </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">TABLE_NAM</span><span style="color:#E1E4E8;">E</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">--file </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">FILE_NAM</span><span style="color:#E1E4E8;">E</span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">.csv</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">--workers </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">NUM_WORKER</span><span style="color:#E1E4E8;">S</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">--reporting-period </span><span style="color:#79B8FF;">30</span><span style="color:#9ECBFF;">s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 首先，先安装 go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#使用 go 安装 timescaledb-parallel-copy</span></span>
<span class="line"><span style="color:#6F42C1;">go</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">github.com/timescale/timescaledb-parallel-copy/cmd/timescaledb-parallel-copy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 对每个表都需要进行导入操作</span></span>
<span class="line"><span style="color:#6F42C1;">timescaledb-parallel-copy</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">--connection </span><span style="color:#032F62;">&quot;host=&lt;HOST&gt; </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#032F62;">user=tsdbadmin password=&lt;PASSWORD&gt; </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#032F62;">port=&lt;PORT&gt; </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#032F62;">sslmode=require&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">--db-name </span><span style="color:#032F62;">tsdb</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">--table </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">TABLE_NAM</span><span style="color:#24292E;">E</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">--file </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">FILE_NAM</span><span style="color:#24292E;">E</span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">.csv</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">--workers </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">NUM_WORKER</span><span style="color:#24292E;">S</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">--reporting-period </span><span style="color:#005CC5;">30</span><span style="color:#032F62;">s</span></span></code></pre></div><p>6、恢复 schema-post 数据，例如约束数据</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 从原数据库备份 schema 后置数据</span></span>
<span class="line"><span style="color:#B392F0;">pg_dump</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-U</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">SOURCE_DB_USERNAM</span><span style="color:#E1E4E8;">E</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-w</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">-h </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">SOURCE_DB_HOS</span><span style="color:#E1E4E8;">T</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">SOURCE_DB_POR</span><span style="color:#E1E4E8;">T</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-Fc</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-v</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">--section=post-data </span><span style="color:#79B8FF;">--exclude-schema=</span><span style="color:#9ECBFF;">&quot;_timescaledb*&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">-f </span><span style="color:#9ECBFF;">dump_post_data.bak</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">DATABASE_NAM</span><span style="color:#E1E4E8;">E</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 将后置数据恢复到目标库</span></span>
<span class="line"><span style="color:#B392F0;">pg_restore</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-U</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tsdbadmin</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-w</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">-h </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">HOS</span><span style="color:#E1E4E8;">T</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">POR</span><span style="color:#E1E4E8;">T</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--no-owner</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-Fc</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\</span></span>
<span class="line"><span style="color:#E1E4E8;">-v </span><span style="color:#79B8FF;">-d</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tsdb</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dump_post_data.bak</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 从原数据库备份 schema 后置数据</span></span>
<span class="line"><span style="color:#6F42C1;">pg_dump</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-U</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">SOURCE_DB_USERNAM</span><span style="color:#24292E;">E</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-w</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">-h </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">SOURCE_DB_HOS</span><span style="color:#24292E;">T</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">SOURCE_DB_POR</span><span style="color:#24292E;">T</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-Fc</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-v</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">--section=post-data </span><span style="color:#005CC5;">--exclude-schema=</span><span style="color:#032F62;">&quot;_timescaledb*&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">-f </span><span style="color:#032F62;">dump_post_data.bak</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">DATABASE_NAM</span><span style="color:#24292E;">E</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 将后置数据恢复到目标库</span></span>
<span class="line"><span style="color:#6F42C1;">pg_restore</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-U</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tsdbadmin</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-w</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">-h </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">HOS</span><span style="color:#24292E;">T</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">POR</span><span style="color:#24292E;">T</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--no-owner</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-Fc</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">-v </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tsdb</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dump_post_data.bak</span></span></code></pre></div><p>7、如果存在持续聚合表，<a href="https://docs.timescale.com/self-hosted/latest/migration/schema-then-data/#recreate-continuous-aggregates" target="_blank" rel="noreferrer">重新创建</a></p><p>8、如果存在自定义的策略（持续聚合刷新策略、数据留存策略、压缩策略、重排序策略），<a href="https://docs.timescale.com/self-hosted/latest/migration/schema-then-data/#recreate-policies" target="_blank" rel="noreferrer">重新创建</a></p><p>9、最后，执行 PostgreSQL 提供的 <a href="https://www.postgresql.org/docs/10/sql-analyze.html" target="_blank" rel="noreferrer">Analyze 命令</a>，更新数据表数据。</p><div class="language-postgresql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">postgresql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ANALYZE;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ANALYZE;</span></span></code></pre></div><p>…</p><hr><h2 id="持续聚合" tabindex="-1">持续聚合 <a class="header-anchor" href="#持续聚合" aria-label="Permalink to &quot;持续聚合&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/continuous-aggregates/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/continuous-aggregates/</a></p></blockquote><p>在 TimescaleDB 中，有三种聚合方式：</p><ul><li>视图（Materialized View），标准的 PostgreSQL 方法，用来存储复杂查询的结果，并在后续的操作中重用。存储的结果不会自动刷新，需要手动再次执行视图 SQL 进行刷新。</li><li>持续聚合（Continuous Aggregate），TimescaleDB 提供的方法，和视图的工作方式类似，但是可以在后台自动刷新，开销小于视图。持续聚合基于超表，可以像其他表格一样对其进行相应的操作，同样支持<em>数据压缩</em>和<em>数据整理</em>。</li><li>实时聚合（Realtime Aggregate），TimescaleDB 提供的方法，类似持续聚合，但是时间上更加敏感，在聚合数据被写入之前就会对其进行相应的操作。</li></ul><p>时序数据通常增长很快，这意味着对大量的数据进行聚合操作会随着变得个很慢。为此，TimescaleDB 提供了一个持续聚合功能。</p><p>如果对数据的采集非常频繁，比如一秒钟才存一次温度数据，且想要对一分钟或者一小时内的数据进行聚合操作，比如求一小时内温度的平均值。当你的数据量非常大的时候运行这条聚合 SQL 会非常慢，每次运行这条 SQL 数据库都需要进行全表扫描，再重新计算平均值。</p><p>持续聚合是超表中的一个在后台自动刷新的功能，当你添加新数据或者修改老数据时，超表会在后台自动刷新你需要的温度平均值，不在需要你手动的去执行 SQL 语句。</p><h2 id="数据导入" tabindex="-1">数据导入 <a class="header-anchor" href="#数据导入" aria-label="Permalink to &quot;数据导入&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/ingest-data/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/ingest-data/</a></p></blockquote><blockquote><p><a href="https://github.com/timescale/timescaledb-parallel-copy" target="_blank" rel="noreferrer">timescaledb-parallel-copy</a></p></blockquote><h2 id="数据留存" tabindex="-1">数据留存 <a class="header-anchor" href="#数据留存" aria-label="Permalink to &quot;数据留存&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/data-retention/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/data-retention/</a></p></blockquote><p>数据留存策略能通过删除旧数据，帮助你降低存储的花销。可以通过结合<em>数据留存</em>和<em>持续聚合</em>这两个功能来向下采集数据。</p><blockquote><p>In time-series applications, data often becomes less useful as it gets older. If you don&#39;t need your historical data, you can delete it once it reaches a certain age.</p></blockquote><h3 id="数据留存操作" tabindex="-1">数据留存操作 <a class="header-anchor" href="#数据留存操作" aria-label="Permalink to &quot;数据留存操作&quot;">​</a></h3><ul><li><a href="https://docs.timescale.com/use-timescale/latest/data-retention/create-a-retention-policy/" target="_blank" rel="noreferrer">自动数据留存策略</a></li><li><a href="https://docs.timescale.com/use-timescale/latest/data-retention/manually-drop-chunks/" target="_blank" rel="noreferrer">手动删除 chunk</a></li></ul><h3 id="数据留存-持续聚合" tabindex="-1">数据留存+持续聚合 <a class="header-anchor" href="#数据留存-持续聚合" aria-label="Permalink to &quot;数据留存+持续聚合&quot;">​</a></h3><blockquote><p>Often, you want to keep summaries of your historical data, but you don&#39;t need the raw data. You can downsample your older data by <a href="https://docs.timescale.com/use-timescale/latest/data-retention/data-retention-with-continuous-aggregates/" target="_blank" rel="noreferrer">combining data retention with continuous aggregates</a>.</p></blockquote><h3 id="manage-data-by-chunk" tabindex="-1">Manage data by chunk <a class="header-anchor" href="#manage-data-by-chunk" aria-label="Permalink to &quot;Manage data by chunk&quot;">​</a></h3><blockquote><p>Timescale data retention works on chunks, not on rows. Deleting data row-by-row, for example with the PostgreSQL <code>DELETE</code> command, can be slow. But dropping data by the chunk is faster, because it deletes an entire file from disk. It doesn&#39;t need garbage collection and defragmentation.</p><p>Whether you use a policy or manually drop chunks, Timescale drops data by the chunk. It only drops chunks where <em>all</em> the data is wihin the specified time range.</p></blockquote><h2 id="数据整理" tabindex="-1">数据整理 <a class="header-anchor" href="#数据整理" aria-label="Permalink to &quot;数据整理&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/data-tiering/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/data-tiering/</a></p></blockquote><blockquote><p>Save on storage costs by tiering data to a low-cost object-storage layer.</p></blockquote><blockquote><ul><li><a href="https://docs.timescale.com/use-timescale/latest/data-tiering/tier-data-object-storage/#manually-tier-a-chunk" target="_blank" rel="noreferrer">手动进行数据整理</a></li><li><a href="https://docs.timescale.com/use-timescale/latest/data-tiering/tier-data-object-storage/#automate-chunk-tiering-with-a-data-tiering-policy" target="_blank" rel="noreferrer">添加自动数据整理策略</a></li><li><a href="https://docs.timescale.com/use-timescale/latest/data-tiering/untier-data/" target="_blank" rel="noreferrer">取消数据整理</a></li></ul></blockquote><h2 id="hyperfunctions" tabindex="-1">Hyperfunctions <a class="header-anchor" href="#hyperfunctions" aria-label="Permalink to &quot;Hyperfunctions&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/hyperfunctions/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/hyperfunctions/</a></p></blockquote><blockquote><p>Hyperfunctions allow you to perform critical time-series queries quickly, analyze time-series data, and extract meaningful information.</p></blockquote><blockquote><p>一些由 TimescaleDB 提供的方法集合，用来操作、分析和管理 TimescaleDB。</p></blockquote><h2 id="tsdb-数据库备份" tabindex="-1">TSDB 数据库备份 <a class="header-anchor" href="#tsdb-数据库备份" aria-label="Permalink to &quot;TSDB 数据库备份&quot;">​</a></h2><ul><li>使用 <a href="https://github.com/wal-e/wal-e" target="_blank" rel="noreferrer">WAL-E</a>，参考：<a href="https://docs.timescale.com/self-hosted/latest/backup-and-restore/docker-and-wale/#perform-the-backup-using-the-wal-e-sidecar" target="_blank" rel="noreferrer">官方描述</a></li><li>物理备份（全量备份）</li><li>…</li></ul><h3 id="全量备份工具" tabindex="-1">全量备份工具 <a class="header-anchor" href="#全量备份工具" aria-label="Permalink to &quot;全量备份工具&quot;">​</a></h3><ul><li>pg_basebackup，PostgreSQL 官方提供，会备份整个 PostgreSQL 实例数据。</li><li><a href="https://pgbackrest.org/" target="_blank" rel="noreferrer">pgBackRest</a></li><li><a href="https://github.com/EnterpriseDB/barman" target="_blank" rel="noreferrer">barman</a></li></ul><h3 id="pg-basebackup" tabindex="-1">pg_basebackup <a class="header-anchor" href="#pg-basebackup" aria-label="Permalink to &quot;pg_basebackup&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">pg_basebackup</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-U</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">repl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-h</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">source-db-i</span><span style="color:#E1E4E8;">p</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5432</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-F</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">p</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-X</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stream</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-P</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-v</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-D</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/pgdata/dump</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">pg_basebackup</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-U</span><span style="color:#24292E;"> </span><span style="color:#032F62;">repl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-h</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">source-db-i</span><span style="color:#24292E;">p</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5432</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-F</span><span style="color:#24292E;"> </span><span style="color:#032F62;">p</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-X</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stream</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-P</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-v</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-D</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/pgdata/dump</span></span></code></pre></div><blockquote><p>详情参考 PostgreSQL 该篇文章。</p></blockquote><h2 id="高可用部署" tabindex="-1">高可用部署 <a class="header-anchor" href="#高可用部署" aria-label="Permalink to &quot;高可用部署&quot;">​</a></h2><blockquote><p>先部署 PostgreSQL 高可用再安装 TimescaleDB 插件即可。</p></blockquote><h2 id="数据库监控-告警" tabindex="-1">数据库监控/告警 <a class="header-anchor" href="#数据库监控-告警" aria-label="Permalink to &quot;数据库监控/告警&quot;">​</a></h2><blockquote><p><a href="https://docs.timescale.com/use-timescale/latest/alerting/" target="_blank" rel="noreferrer">https://docs.timescale.com/use-timescale/latest/alerting/</a></p></blockquote></div></div></main><footer class="VPDocFooter" data-v-6b87e69f data-v-ef5dee53><!--[--><!--]--><div class="edit-info" data-v-ef5dee53><!----><div class="last-updated" data-v-ef5dee53><p class="VPLastUpdated" data-v-ef5dee53 data-v-7e05ebdb>上次更新: <time datetime="2023-11-22T12:55:43.000Z" data-v-7e05ebdb></time></p></div></div><!----></footer><!--[--><!--[--><!--[--><!--[--><!--]--><div id="giscus-comment" class="comment" data-pagefind-ignore="all" data-v-af5a5a9a data-v-3db7ae48><div class="el-affix comment-btn" style="height:;width:;" data-v-3db7ae48><div class="" style=""><!--[--><button ariadisabled="false" type="button" class="el-button el-button--primary is-plain" style="" data-v-3db7ae48><i class="el-icon" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M736 504a56 56 0 1 1 0-112 56 56 0 0 1 0 112zm-224 0a56 56 0 1 1 0-112 56 56 0 0 1 0 112zm-224 0a56 56 0 1 1 0-112 56 56 0 0 1 0 112zM128 128v640h192v160l224-160h352V128H128z"></path></svg><!--]--></i><span class=""><!--[--> 评论 <!--]--></span></button><!--]--></div></div><!----></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"3bdf1329\",\"posts_article_文章整理.md\":\"43e1d3cb\",\"about.md\":\"359c00f3\",\"posts_algorithm_位运算.md\":\"0ff8bc09\",\"posts_be_dubbo_dubbo.md\":\"3ff39907\",\"posts_be_java_java io_java io.md\":\"b95885ce\",\"posts_be_java_java 进阶_java 进阶.md\":\"29b91e78\",\"posts_be_springboot_thinkinspringboot_index.md\":\"4b8714ed\",\"posts_be_java_java lang_java lang.md\":\"42ed45b1\",\"posts_be_jvm_jvm.md\":\"3afd82ee\",\"posts_be_spring_spring.md\":\"369b321b\",\"posts_be_spring_ioc_事务_ioc_事务.md\":\"7e6bc94b\",\"posts_be_spring_ioc_di_ioc_di.md\":\"5b7d9ea8\",\"posts_db_mysql_mysql.md\":\"ee990218\",\"posts_be_java_java 线程池_java 线程池.md\":\"30abb5c2\",\"posts_be_maven_maven.md\":\"8b7dbda0\",\"posts_db_clickhouse_clickhouse.md\":\"896350eb\",\"posts_db_mysql_thinkinmysql.md\":\"de1e817c\",\"posts_be_java_java 集合_java 集合.md\":\"a09caa41\",\"posts_be_netty_netty.md\":\"cda08f74\",\"posts_be_java_walkthroughjava.md\":\"fe44e8ae\",\"posts_algorithm_常见算法.md\":\"2a98b316\",\"posts_be_java_java 基础_java 基础.md\":\"9356f9e1\",\"posts_db_redis_redis 数据类型.md\":\"1becab9e\",\"posts_be_mybitis_mybatis-plus-generator.md\":\"907c36cd\",\"posts_db_redis_redis 配置详解.md\":\"6c10bbea\",\"posts_be_java_java juc_java juc.md\":\"9e490b4a\",\"posts_be_java_java 反射_范型_java.md\":\"6354ee4e\",\"posts_be_springcloud_index.md\":\"e8275d9f\",\"posts_be_java_java 多线程_java 多线程.md\":\"e44013a1\",\"posts_be_springweb_springmvc_springmvc.md\":\"d25bf835\",\"posts_be_mybitis_mybatis.md\":\"9ff1f3df\",\"posts_be_springboot_springboot_springboot.md\":\"2ae18107\",\"posts_devops_kubernetes_k8s.md\":\"18a9bf11\",\"posts_devops_gitlab_gitlab.md\":\"50d06a7b\",\"posts_db_timescaledb_timescaledb.md\":\"12eff5df\",\"posts_devops_grafana_grafana.md\":\"7f710f32\",\"posts_db_postgresql_postgresql.md\":\"54e2fe83\",\"posts_fe_nextjs_next.js.md\":\"8257849d\",\"posts_devops_docker_docker.md\":\"d4bafa06\",\"posts_fe_css_css.md\":\"b98286ac\",\"posts_devops_nginx_nginx.md\":\"cf327239\",\"posts_be_springsecurity_springsecurity.md\":\"ed047c8a\",\"posts_fe_vuejs_vuejs.md\":\"38271d64\",\"posts_fe_项目配置.md\":\"47cb7730\",\"posts_linux_安装配置_manjora 安装配置.md\":\"080af04f\",\"posts_linux_安装配置_centos 配置.md\":\"a4a512d9\",\"posts_fe_node.js_node.js.md\":\"463ac7c0\",\"posts_db_redis_redis.md\":\"7a9277d5\",\"posts_math_latex.md\":\"36c3da98\",\"posts_fe_react_react typescript.md\":\"a7cb0dee\",\"posts_linux_linux.md\":\"251e1d8d\",\"posts_devops_kubernetes_kubernetes.md\":\"d0b99956\",\"posts_math_math.md\":\"1fe46ac1\",\"posts_mw_rocketmq_rocketmq model_rocketmq model.md\":\"9e39a43e\",\"posts_python_python.md\":\"114451d2\",\"posts_linux_安装配置_ubuntu 安装配置.md\":\"a8d36346\",\"posts_mw_activemq_index.md\":\"44e98438\",\"posts_工具_ffmpeg.md\":\"acc22d75\",\"posts_mw_kafka_kafka.md\":\"4bdd7788\",\"posts_fe_typescript_typescript.md\":\"eda63f28\",\"posts_mw_elasticsearch_elasticsearch.md\":\"a93cc931\",\"posts_fe_react_react.md\":\"17d5fa7a\",\"posts_mw_kafka_kafkasource.md\":\"3fcbbab4\",\"posts_数据结构_数据结构.md\":\"406cff06\",\"posts_mw_rocketmq_rocketmq source_rocketmq source.md\":\"93885e01\",\"posts_计算机网络_计算机网络.md\":\"675f4cb6\",\"posts_mw_rocketmq_rocketmq_rocketmq.md\":\"ece72ab1\",\"posts_设计模式_设计模式.md\":\"276b2b1c\",\"posts_fe_javascript_javascript.md\":\"83c10ad7\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-cn\",\"dir\":\"ltr\",\"title\":\"Gnl\",\"description\":\"Gnl's blog\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"blog\":{\"pagesData\":[{\"route\":\"/about\",\"meta\":{\"sidebar\":false,\"title\":\"关于我\",\"date\":\"2023-11-22 12:55:43\",\"tag\":[],\"description\":\"\\n> gnl0ATqq.com\",\"cover\":\"\"}},{\"route\":\"/posts/algorithm/位运算\",\"meta\":{\"tag\":[\"算法\"],\"description\":\"位运算基础以及常见用法\",\"title\":\"位运算\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/algorithm/常见算法\",\"meta\":{\"tag\":[\"算法\"],\"description\":\"常见算法思想汇总；分治、动态规划、贪心、回溯、分支界限\",\"title\":\"常见算法\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/article/文章整理\",\"meta\":{\"description\":\"文章推荐\",\"title\":\"文章整理\",\"date\":\"2023-11-22 12:55:43\",\"tag\":[],\"cover\":\"\"}},{\"route\":\"/posts/fe/项目配置\",\"meta\":{\"description\":\"前端项目配置\",\"tag\":[\"前端\"],\"title\":\"前端项目配置\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/linux/Linux\",\"meta\":{\"description\":\"Linux 笔记\",\"tag\":[\"Linux\"],\"title\":\"Linux\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/math/Latex\",\"meta\":{\"description\":\"LateX 常用语法\",\"tag\":[\"LateX\"],\"title\":\"LateX\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/math/Math\",\"meta\":{\"description\":\"基础数学函数\",\"title\":\"Math\",\"date\":\"2023-11-22 12:55:43\",\"tag\":[],\"cover\":\"\"}},{\"route\":\"/posts/python/Python\",\"meta\":{\"description\":\"Python 笔记\",\"tag\":[\"Python\"],\"title\":\"Python\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/工具/ffmpeg\",\"meta\":{\"description\":\"ffmpeg 常用命令\",\"tag\":[\"ffmpeg\"],\"title\":\"ffmpeg\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/数据结构/数据结构\",\"meta\":{\"description\":\"算法与数据结构笔记\",\"tag\":[\"算法\",\"数据结构\"],\"title\":\"算法与数据结构\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"https://img2018.cnblogs.com/blog/1648163/201909/1648163-20190919085122774-376085378.png\"}},{\"route\":\"/posts/计算机网络/计算机网络\",\"meta\":{\"description\":\"计算机网络笔记\",\"title\":\"计算机网络\",\"date\":\"2023-11-22 12:55:43\",\"tag\":[],\"cover\":\"\"}},{\"route\":\"/posts/设计模式/设计模式\",\"meta\":{\"description\":\"Java 设计模式笔记\",\"tag\":[\"设计模式\",\"Java\"],\"title\":\"设计模式\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Dubbo/Dubbo\",\"meta\":{\"description\":\"Apache Dubbo 是一款 RPC 服务开发框架，用于解决微服务架构下的服务治理与通信问题。\",\"tag\":[\"微服务\",\"Dubbo\",\"后端\"],\"title\":\"Dubbo\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/JVM/JVM\",\"meta\":{\"description\":\"JVM 详解，包括 JVM 体系结构、垃圾回收算法等\",\"tag\":[\"Java\",\"JVM\",\"后端\"],\"title\":\"JVM\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/WalkThroughJava\",\"meta\":{\"title\":\"Walk Though Java\",\"date\":\"2023-11-22 12:55:43\",\"tag\":[],\"description\":\" 多线程\\n 多线程异常处理方案\\n在使用 try-catch 的时候有一个条件通常会被忽略：try-catch 只能处理当前线程抛出的异常，在多线程情况下是无法 catch 到其他线程抛出的异常的。\\n看\",\"cover\":\"\"}},{\"route\":\"/posts/be/Maven/Maven\",\"meta\":{\"description\":\"Maven 笔记\",\"tag\":[\"后端\"],\"title\":\"Maven\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/MyBitis/MyBatis\",\"meta\":{\"description\":\"MyBatis 详解\",\"tag\":[\"MyBatis\",\"后端\"],\"title\":\"MyBatis\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/MyBitis/mybatis-plus-generator\",\"meta\":{\"description\":\"MyBatis 代码生成器\",\"tag\":[\"MyBatis\",\"后端\"],\"title\":\"mybatis-plus-generator\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Netty/Netty\",\"meta\":{\"description\":\"基于 Java NIO 封装的网络框架\",\"tag\":[\"Netty\",\"后端\"],\"title\":\"Netty\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Spring/Spring\",\"meta\":{\"description\":\"Spring 框架详解\",\"tag\":[\"Spring\",\"后端\"],\"title\":\"Spring\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/SpringCloud/index\",\"meta\":{\"description\":\"SpringCloud 详解\",\"tag\":[\"SpringCloud\",\"后端\",\"微服务\"],\"title\":\"SpringCloud\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/SpringSecurity/SpringSecurity\",\"meta\":{\"description\":\"SpringSecurity 笔记\",\"tag\":[\"Spring\",\"后端\"],\"title\":\"Spring Security\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/ClickHouse/ClickHouse\",\"meta\":{\"description\":\"ClickHouse 笔记\",\"tag\":[\"数据库\"],\"title\":\"ClickHouse\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/MySQL/MySQL\",\"meta\":{\"description\":\"MySQL 详解\",\"tag\":[\"MySQL\",\"数据库\"],\"title\":\"MySQL\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/MySQL/ThinkInMySQL\",\"meta\":{\"description\":\"在使用 MySQL 的过程中的一些思考\",\"sticky\":true,\"tag\":[\"MySQL\",\"数据库\"],\"title\":\"Think In MySQL\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/PostgreSQL/PostgreSQL\",\"meta\":{\"description\":\"PostgreSQL 详解，包含基础内容、高可用架构等\",\"top\":1,\"sticky\":true,\"tag\":[\"PostgreSQL\",\"数据库\"],\"title\":\"PostgreSQL\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/Redis/Redis 数据类型\",\"meta\":{\"description\":\"Redis 数据类型详解\",\"tag\":[\"Redis\",\"NoSQL\",\"数据库\"],\"title\":\"Redis 数据类型\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/Redis/Redis 配置详解\",\"meta\":{\"description\":\"Redis 配置详解\",\"tag\":[\"Redis\",\"NoSQL\",\"数据库\"],\"title\":\"Redis 配置详解\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/Redis/Redis\",\"meta\":{\"description\":\"Redis 详解\",\"tag\":[\"Redis\",\"NoSQL\",\"数据库\"],\"title\":\"Redis\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/db/TimescaleDB/TimescaleDB\",\"meta\":{\"description\":\"TimescaleDB 详解\",\"top\":5,\"sticky\":true,\"tag\":[\"TimescaleDB\",\"时序数据库\",\"数据库\"],\"title\":\"TimescaleDB\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/devops/Docker/Docker\",\"meta\":{\"description\":\"Docker 详解\",\"tag\":[\"Docker\",\"DevOps\"],\"title\":\"Docker\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/devops/GitLab/GitLab\",\"meta\":{\"description\":\"GitLab 私服搭建\",\"top\":3,\"tag\":[\"GitLab\"],\"title\":\"GitLab\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/devops/Grafana/Grafana\",\"meta\":{\"description\":\"Grafana 监控搭建\",\"top\":2,\"tag\":[\"Grafana\",\"DevOps\"],\"title\":\"Grafana\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/devops/Kubernetes/K8S\",\"meta\":{\"isPublish\":false,\"title\":\"Kubernetes\",\"date\":\"2023-11-22 12:55:43\",\"tag\":[],\"description\":\" 虚拟化容器\\n Docker\\nDocker 与传统虚拟化方式的不同之处：Docker 容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，没有进行硬件虚拟；而传统虚拟机技术是虚拟出一套硬件后，\",\"cover\":\"\"}},{\"route\":\"/posts/devops/Kubernetes/Kubernetes\",\"meta\":{\"description\":\"K8s 详解\",\"top\":4,\"sticky\":true,\"tag\":[\"K8s\",\"DevOps\"],\"title\":\"K8s\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"https://d33wubrfki0l68.cloudfront.net/99d9808dcbf2880a996ed50d308a186b5900cec9/40b94/docs/tutorials/kubernetes-basics/public/images/module_01_cluster.svg\"}},{\"route\":\"/posts/devops/Nginx/Nginx\",\"meta\":{\"description\":\"Nginx 详解\",\"tag\":[\"Nginx\"],\"title\":\"Nginx\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/CSS/CSS\",\"meta\":{\"description\":\"CSS 详解\",\"tag\":[\"前端\"],\"title\":\"CSS\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/JavaScript/JavaScript\",\"meta\":{\"description\":\"JavaScript 详解\",\"outline\":[2,3],\"tag\":[\"JavaScript\",\"前端\"],\"title\":\"JavaScript\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/Nextjs/Next.js\",\"meta\":{\"description\":\"Next.js 笔记\",\"tag\":[\"React\",\"前端\"],\"title\":\"Next.js\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/Node.js/Node.js\",\"meta\":{\"description\":\"Node.js 笔记\",\"tag\":[\"前端\"],\"title\":\"Node.js\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/React/React TypeScript\",\"meta\":{\"description\":\"React + TypeScript 笔记\",\"tag\":[\"React\",\"TypeScript\",\"前端\"],\"title\":\"React + TypeScript\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/React/React\",\"meta\":{\"description\":\"React 笔记\",\"tag\":[\"React\",\"前端\"],\"title\":\"React\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/TypeScript/TypeScript\",\"meta\":{\"description\":\"TypeScript 笔记\",\"tag\":[\"TypeScript\",\"前端\"],\"title\":\"TypeScript\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/fe/Vuejs/Vuejs\",\"meta\":{\"description\":\"Vue.js 笔记\",\"tag\":[\"Vue.js\",\"前端\"],\"title\":\"Vue.js\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/linux/安装配置/CentOS 配置\",\"meta\":{\"description\":\"CentOS 笔记\",\"tag\":[\"Linux\"],\"title\":\"CentOS 笔记\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/linux/安装配置/Manjora 安装配置\",\"meta\":{\"description\":\"Manjora 笔记\",\"tag\":[\"Linux\"],\"title\":\"Manjora 安装\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/linux/安装配置/Ubuntu 安装配置\",\"meta\":{\"description\":\"Ubuntu 安装\",\"tag\":[\"Linux\"],\"title\":\"Ubuntu 安装\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/mw/ActiveMQ/index\",\"meta\":{\"description\":\"ActiveMQ 详解\",\"tag\":[\"MQ\",\"中间件\"],\"title\":\"ActiveMQ\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/mw/Elasticsearch/Elasticsearch\",\"meta\":{\"description\":\"Elasticsearch 详解\",\"outline\":[2,3],\"tag\":[\"Elasticsearch\",\"中间件\"],\"title\":\"Elasticsearch\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/mw/Kafka/Kafka\",\"meta\":{\"description\":\"Kafka 是一个分布式流处理平台，基于发布/订阅模式的消息队列，主要应用于大数据实时处理领域。使用 Kafka 可以帮助进行解耦、异步、削峰等操作。\",\"tag\":[\"Kafka\",\"MQ\",\"中间件\"],\"title\":\"Kafka\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/mw/Kafka/KafkaSource\",\"meta\":{\"description\":\"Kafka 源码深入\",\"tag\":[\"Kafka\",\"MQ\",\"中间件\"],\"title\":\"Kafka Source\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java IO/Java IO\",\"meta\":{\"description\":\"Java 中的 IO 操作，包括 BIO 和 NIO\",\"tag\":[\"Java\",\"后端\"],\"title\":\"Java IO\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java JUC/Java JUC\",\"meta\":{\"description\":\"JUC 指的是 `java.util.concurrent` 包及其子包下用于并发场景的类\",\"tag\":[\"Java\",\"后端\"],\"title\":\"JUC\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java lang/Java lang\",\"meta\":{\"title\":\"Java lang\",\"date\":\"2023-11-22 12:55:43\",\"tag\":[],\"description\":\"\\n Runtime\\n每一个 Java 程序都有一个单实例的 Runtime 对象，它允许正在运行的 Java 程序能够获取到运行环境信息。\\n一些常用的方法如下：\\n* `getRuntime()`\\n* \",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java 反射+范型/Java\",\"meta\":{\"description\":\"Java 反射和泛型详解\",\"tag\":[\"Java\",\"后端\"],\"title\":\"Java 反射和泛型\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java 基础/Java 基础\",\"meta\":{\"description\":\"Java 基础内容\",\"tag\":[\"Java\",\"后端\"],\"title\":\"Java 基础内容\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java 多线程/Java 多线程\",\"meta\":{\"description\":\"Java 多线程详解\",\"tag\":[\"Java\",\"后端\"],\"title\":\"Java 多线程\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java 线程池/Java 线程池\",\"meta\":{\"description\":\"线程池是 Java 中用于管理和复用线程的机制。它包含了一个线程队列，可以用来创建并发执行的任务，提高程序的执行效率\",\"tag\":[\"Java\",\"后端\"],\"title\":\"Java 线程池\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java 进阶/Java 进阶\",\"meta\":{\"description\":\"Java 进阶内容，包括: SPI、JNDI\",\"tag\":[\"Java\",\"后端\"],\"title\":\"Java 进阶\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Java/Java 集合/Java 集合\",\"meta\":{\"description\":\"Java 集合部分详解\",\"tag\":[\"Java\",\"后端\"],\"title\":\"Java 集合\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Spring/IOC&DI/IOC&DI\",\"meta\":{\"description\":\"Spring IOC&DI\",\"tag\":[\"Spring\",\"后端\"],\"title\":\"Spring\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/Spring/IOC&事务/IOC&事务\",\"meta\":{\"description\":\"Spring IOC & 事务\",\"tag\":[\"Spring\",\"后端\"],\"title\":\"Spring\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/SpringBoot/SpringBoot/SpringBoot\",\"meta\":{\"description\":\"SpringBoot 详解\",\"tag\":[\"SpringBoot\",\"后端\"],\"title\":\"SpringBoot\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/SpringBoot/ThinkInSpringBoot/index\",\"meta\":{\"description\":\"深入 SpringBoot 源码与一点思考\",\"sticky\":true,\"tag\":[\"SpringBoot\",\"后端\"],\"title\":\"Think-in-Springboot\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/be/SpringWeb/SpringMVC/SpringMVC\",\"meta\":{\"description\":\"Spring Web MVC 是建立在 Servlet API 上的 Web 框架\",\"tag\":[\"SpringMVC\",\"后端\"],\"title\":\"Spring MVC\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/mw/RocketMQ/RocketMQ/RocketMQ\",\"meta\":{\"description\":\"RocketMQ 是一个分布式的中间件服务，采用异步通信模型和发布/订阅消息传输模型。\",\"tag\":[\"RocketMQ\",\"MQ\",\"中间件\"],\"title\":\"RocketMQ\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/mw/RocketMQ/RocketMQ Model/RocketMQ Model\",\"meta\":{\"description\":\"RocketMQ 领域模型\",\"tag\":[\"RocketMQ\",\"MQ\",\"中间件\"],\"title\":\"RocketMQ 领域模型\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}},{\"route\":\"/posts/mw/RocketMQ/RocketMQ Source/RocketMQ Source\",\"meta\":{\"description\":\"RocketMQ 源码解析\",\"tag\":[\"RocketMQ\",\"MQ\",\"中间件\"],\"title\":\"RocketMQ 源码解析\",\"date\":\"2023-11-22 12:55:43\",\"cover\":\"\"}}],\"hotArticle\":{\"title\":\"Pinned\",\"nextText\":\"换一组\",\"pageSize\":5,\"empty\":\"暂无内容\"},\"recommend\":false,\"footer\":{\"copyright\":\"2023-Present | Gnl\",\"version\":false},\"themeColor\":\"el-green\",\"author\":\"Gnl\",\"comment\":{\"repo\":\"gnl00/gnl00.github.io\",\"repoId\":\"R_kgDOGR5o6w\",\"category\":\"Announcements\",\"categoryId\":\"DIC_kwDOGR5o684CatYO\"},\"mermaid\":true},\"lastUpdatedText\":\"上次更新\",\"logo\":\"/logo-transform.png\",\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"前端\",\"items\":[{\"text\":\"前端项目工程化\",\"link\":\"/posts/fe/项目配置\"},{\"text\":\"JavaScript\",\"link\":\"/posts/fe/JavaScript/JavaScript\"},{\"text\":\"TypeScript\",\"link\":\"/posts/fe/TypeScript/TypeScript\"},{\"text\":\"React\",\"link\":\"/posts/fe/React/React\"},{\"text\":\"Vue.js\",\"link\":\"/posts/fe/Vuejs/Vuejs\"}]},{\"text\":\"后端\",\"items\":[{\"text\":\"Java\",\"link\":\"/posts/be/Java/Java\"},{\"text\":\"Spring\",\"link\":\"/posts/be/Spring/Spring\"},{\"text\":\"SpringBoot\",\"link\":\"/posts/be/SpringBoot/SpringBoot\"},{\"text\":\"SpringCloud\",\"link\":\"/posts/be/SpringCloud/SpringCloud\"},{\"text\":\"Dubbo\",\"link\":\"/posts/be/Dubbo/Dubbo\"}]},{\"text\":\"数据库\",\"items\":[{\"text\":\"MySQL\",\"link\":\"/posts/db/MySQL/MySQL\"},{\"text\":\"PostgreSQL\",\"link\":\"/posts/db/PostgreSQL/PostgreSQL\"},{\"text\":\"Redis\",\"link\":\"/posts/db/Redis/Redis\"}]},{\"text\":\"中间件\",\"items\":[{\"text\":\"Netty\",\"link\":\"/posts/mw/Netty/Netty\"},{\"text\":\"RocketMQ\",\"link\":\"/posts/mw/RocketMQ/RocketMQ/RocketMQ\"},{\"text\":\"Kafka\",\"link\":\"/posts/mw/Kafka/Kafka\"},{\"text\":\"Elesticsearch\",\"link\":\"/posts/mw/Elesticsearch/Elesticsearch\"}]},{\"text\":\"DevOps\",\"items\":[{\"text\":\"Docker\",\"link\":\"/posts/mw/Docker/Docker\"},{\"text\":\"Kubernetes\",\"link\":\"/posts/mw/Kubernetes/Kubernetes\"},{\"text\":\"GitLab\",\"link\":\"/posts/mw/GitLab/GitLab\"}]},{\"text\":\"关于\",\"link\":\"/about\"}]},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>