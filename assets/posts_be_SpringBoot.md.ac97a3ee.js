import{_ as s,c as a,b as p,a as t,r as e,o}from"./app.d8a09d34.js";var c="/assets/image-20211102171224328.d728f805.png",l="/assets/image-20211102172109013.cb15ad61.png",u="/assets/image-20210209121037489.9611031d.png";const f='{"title":"SpringBoot","description":"","frontmatter":{"sidebarDepth":1},"headers":[{"level":2,"title":"\u81EA\u52A8\u914D\u7F6E","slug":"\u81EA\u52A8\u914D\u7F6E"},{"level":3,"title":"\u76F8\u5173\u6CE8\u89E3","slug":"\u76F8\u5173\u6CE8\u89E3"},{"level":3,"title":"\u81EA\u52A8\u914D\u7F6E\u539F\u7406","slug":"\u81EA\u52A8\u914D\u7F6E\u539F\u7406"},{"level":3,"title":"\u81EA\u52A8\u914D\u7F6E\u603B\u7ED3","slug":"\u81EA\u52A8\u914D\u7F6E\u603B\u7ED3"},{"level":2,"title":"\u914D\u7F6E\u7ED1\u5B9A","slug":"\u914D\u7F6E\u7ED1\u5B9A"},{"level":2,"title":"Profile \u914D\u7F6E\u6587\u4EF6","slug":"profile-\u914D\u7F6E\u6587\u4EF6"},{"level":2,"title":"Web \u5F00\u53D1","slug":"web-\u5F00\u53D1"},{"level":3,"title":"\u8D44\u6E90\u8BBF\u95EE","slug":"\u8D44\u6E90\u8BBF\u95EE"},{"level":3,"title":"\u57FA\u672C\u6CE8\u89E3","slug":"\u57FA\u672C\u6CE8\u89E3"},{"level":3,"title":"\u81EA\u5B9A\u4E49\u683C\u5F0F\u8F6C\u6362","slug":"\u81EA\u5B9A\u4E49\u683C\u5F0F\u8F6C\u6362"},{"level":3,"title":"\u62E6\u622A\u5668","slug":"\u62E6\u622A\u5668"},{"level":3,"title":"\u6587\u4EF6\u4E0A\u4F20","slug":"\u6587\u4EF6\u4E0A\u4F20"},{"level":3,"title":"\u5F02\u5E38\u5904\u7406","slug":"\u5F02\u5E38\u5904\u7406"},{"level":3,"title":"SpringMVC \u539F\u7406","slug":"springmvc-\u539F\u7406"},{"level":2,"title":"\u6570\u636E\u5E93\u64CD\u4F5C","slug":"\u6570\u636E\u5E93\u64CD\u4F5C"},{"level":3,"title":"MySQL","slug":"mysql"},{"level":3,"title":"MyBatis","slug":"mybatis"},{"level":3,"title":"MyBatis Plus","slug":"mybatis-plus"},{"level":3,"title":"\u5206\u5E93\u5206\u8868","slug":"\u5206\u5E93\u5206\u8868"},{"level":3,"title":"Redis","slug":"redis"},{"level":2,"title":"\u4E8B\u52A1\u7BA1\u7406","slug":"\u4E8B\u52A1\u7BA1\u7406"},{"level":2,"title":"\u8FDC\u7A0B\u63A5\u53E3\u8C03\u7528","slug":"\u8FDC\u7A0B\u63A5\u53E3\u8C03\u7528"},{"level":2,"title":"API \u9650\u6D41","slug":"api-\u9650\u6D41"},{"level":2,"title":"\u6307\u6807\u76D1\u63A7","slug":"\u6307\u6807\u76D1\u63A7"},{"level":2,"title":"\u5355\u5143\u6D4B\u8BD5","slug":"\u5355\u5143\u6D4B\u8BD5"},{"level":2,"title":"\u6574\u5408 Log4j2","slug":"\u6574\u5408-log4j2"},{"level":2,"title":"\u6574\u5408 JWT","slug":"\u6574\u5408-jwt"},{"level":2,"title":"\u6574\u5408 Swagger3","slug":"\u6574\u5408-swagger3"},{"level":2,"title":"\u539F\u7406\u5206\u6790","slug":"\u539F\u7406\u5206\u6790"},{"level":3,"title":"\u521D\u59CB\u5316\u6D41\u7A0B","slug":"\u521D\u59CB\u5316\u6D41\u7A0B"},{"level":3,"title":"\u542F\u52A8\u539F\u7406","slug":"\u542F\u52A8\u539F\u7406"},{"level":3,"title":"\u81EA\u5B9A\u4E49 Starter","slug":"\u81EA\u5B9A\u4E49-starter"}],"relativePath":"posts/be/SpringBoot.md"}',i={},r=t(`<h1 id="springboot" tabindex="-1">SpringBoot <a class="header-anchor" href="#springboot" aria-hidden="true">#</a></h1><br><p><strong>SpringBoot \u548C Spring \u7684\u533A\u522B</strong></p><p>1\u3001\u914D\u7F6E\u65B9\u9762</p><p>2\u3001\u66F4\u5F3A\u5927\u7684\u6CE8\u89E3\u652F\u6301</p><p>3\u3001\u9879\u76EE\u6253\u5305\u90E8\u7F72</p><br><h2 id="\u81EA\u52A8\u914D\u7F6E" tabindex="-1">\u81EA\u52A8\u914D\u7F6E <a class="header-anchor" href="#\u81EA\u52A8\u914D\u7F6E" aria-hidden="true">#</a></h2><br><h3 id="\u76F8\u5173\u6CE8\u89E3" tabindex="-1">\u76F8\u5173\u6CE8\u89E3 <a class="header-anchor" href="#\u76F8\u5173\u6CE8\u89E3" aria-hidden="true">#</a></h3><p><strong><u>1 - @Configuration</u></strong></p><blockquote><p>\u6807\u6CE8\u5728\u7C7B\u4E0A\uFF0C\u4F7F\u7528 @Configuration \u6807\u6CE8\u7684\u7C7B\u4E3A\u914D\u7F6E\u7C7B\uFF0C\u914D\u7F6E\u7C7B\u672C\u8EAB\u4E5F\u662F\u4E00\u4E2A\u7EC4\u4EF6\uFF0C\u4E5F\u4F1A\u6CE8\u518C\u5230\u5BB9\u5668\u4E2D\u3002\u914D\u7F6E\u7C7B\u4E2D\u53EF\u4EE5\u4F7F\u7528 @Bean \u6807\u6CE8\u5728\u65B9\u6CD5\u4E0A\u7ED9\u5BB9\u5668\u6CE8\u518C\u7EC4\u4EF6\uFF0C\u9ED8\u8BA4\u6CE8\u518C\u7684\u7EC4\u4EF6\u4E3A\u5355\u5B9E\u4F8B</p></blockquote><p><strong>\u5C5E\u6027</strong>\uFF1A</p><p>proxyBeanMethods \u4EE3\u7406 Bean \u65B9\u6CD5</p><p>1\u3001\uFF08proxyBeanMethods = true\uFF09Full\u6A21\u5F0F\uFF0C\u4FDD\u8BC1\u6BCF\u4E2A @Bean \u65B9\u6CD5\u65E0\u8BBA\u88AB\u8C03\u7528\u591A\u5C11\u6B21\u8FD4\u56DE\u7684\u90FD\u662F\u5355\u5B9E\u4F8B\u5BF9\u8C61</p><p>2\u3001\uFF08proxyBeanMethods = false\uFF09Lite\u6A21\u5F0F\uFF0C\u4FDD\u8BC1\u6BCF\u4E2A @Bean \u65B9\u6CD5\u65E0\u8BBA\u88AB\u8C03\u7528\u591A\u5C11\u6B21\u8FD4\u56DE\u7684\u90FD\u662F\u591A\u5B9E\u4F8B\u5BF9\u8C61</p><p>3\u3001\u4F7F\u7528\u573A\u666F</p><ul><li>\u914D\u7F6E\u7C7B\u7684\u7EC4\u4EF6\u4E4B\u95F4<strong>\u65E0\u4F9D\u8D56\u5173\u7CFB</strong>\uFF0C\u7528 lite \u6A21\u5F0F\u52A0\u901F\u5BB9\u5668\u542F\u52A8\uFF0C\u51CF\u5C11\u5BB9\u5668\u5BF9\u751F\u6210\u7EC4\u4EF6\u7684\u5224\u65AD</li><li>\u914D\u7F6E\u7C7B\u7684\u7EC4\u4EF6\u4E4B\u95F4<strong>\u6709\u4F9D\u8D56\u5173\u7CFB</strong>\uFF0C\u65B9\u6CD5\u88AB\u8C03\u7528\u9700\u8981\u7528\u5230\u4E4B\u524D\u4FDD\u5B58\u5728\u5BB9\u5668\u4E2D\u7684\u5355\u5B9E\u4F8B\u7EC4\u4EF6\uFF0C\u7528 lite \u6A21\u5F0F</li></ul><br><p><strong><u>2 - @Import</u></strong></p><blockquote><p>\u6807\u6CE8\u5728\u7C7B\u4E0A\uFF0C\u81EA\u52A8\u7ED9\u5BB9\u5668\u4E2D\u6CE8\u5165\u67D0\u4E9B\u7C7B\u578B\u7684\u7EC4\u4EF6\uFF0C\u9ED8\u8BA4\u7684\u7EC4\u4EF6\u540D\u4E3A\u5168\u7C7B\u540D</p></blockquote><br><p><strong><u>3 - @Conditional</u></strong></p><blockquote><p>\u6807\u6CE8\u5728\u7C7B\u6216\u65B9\u6CD5\u4E0A\uFF0C\u6839\u636E\u6761\u4EF6\u7ED9\u5BB9\u5668\u4E2D\u6CE8\u5165 Bean</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Conditional</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnExpression</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnSingleCandidate</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u5BB9\u5668\u4E2D\u6709\u67D0\u4E2Abean\u5E76\u4E14\u4E3A\u5355\u4F8Bbean
<span class="token annotation punctuation">@ConditionalOnMissingBean</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u5BB9\u5668\u4E2D\u6CA1\u6709\u6709\u67D0\u4E2Abean\u7684\u65F6\u5019\u624D\u6CE8\u5165
<span class="token annotation punctuation">@ConditionalOnBean</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u5BB9\u5668\u4E2D\u6709\u67D0\u4E2Abean\u7684\u65F6\u5019\u624D\u6CE8\u5165
<span class="token annotation punctuation">@ConditionalOnJava</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u5F53\u524D<span class="token class-name">Java</span>\u7248\u672C\u662F\u67D0\u4E2A\u7248\u672C\u7684\u65F6\u5019
<span class="token annotation punctuation">@ConditionalOnClass</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u5BB9\u5668\u4E2D\u5305\u542B\u6709\u67D0\u4E2A<span class="token keyword">class</span>\u7684\u65F6\u5019
<span class="token annotation punctuation">@ConditionalOnWebApplication</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u662Fweb\u5E94\u7528\u7684\u65F6\u5019
<span class="token annotation punctuation">@ConditionalOnNotWebApplication</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> 
<span class="token annotation punctuation">@ConditionalOnMissingClass</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u5BB9\u5668\u4E2D\u4E0D\u5305\u542B\u6709\u67D0\u4E2A<span class="token keyword">class</span>\u7684\u65F6\u5019
<span class="token annotation punctuation">@ConditionalOnResource</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> \u5BB9\u5668\u4E2D\u5305\u542B\u6709\u67D0\u4E2A\u8D44\u6E90\u7684\u65F6\u5019
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><br><p><strong><u>4 - @ImportResource</u></strong></p><blockquote><p>\u6807\u6CE8\u5728\u7C7B\u4E0A\uFF0C\u5C06\u914D\u7F6E\u6587\u4EF6\u5185\u7684 Bean \u6CE8\u518C\u5230\u5BB9\u5668\u4E2D</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u5C06 classpath \u4E0B\u7684 spring-context.xml \u52A0\u8F7D\u5230\u5BB9\u5668\u4E2D</span>
<span class="token annotation punctuation">@ImportResource</span><span class="token punctuation">(</span>locations <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;classpath:spring-context.xml&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><br><h3 id="\u81EA\u52A8\u914D\u7F6E\u539F\u7406" tabindex="-1">\u81EA\u52A8\u914D\u7F6E\u539F\u7406 <a class="header-anchor" href="#\u81EA\u52A8\u914D\u7F6E\u539F\u7406" aria-hidden="true">#</a></h3><blockquote><p>\u56F4\u7ED5<code> @SpringBootApplication</code>\u6CE8\u89E3\u5C55\u5F00</p></blockquote><p><code>@SpringBootApplication</code>\u6CE8\u89E3\u662F\u4E00\u4E2A\u7EC4\u5408\u6CE8\u89E3\uFF0C\u5305\u542B\u4E86\u4E09\u4E2A\u6CE8\u89E3\uFF1A<code>@SpringBootConfiguration</code>\u3001<code>@EnableAutoConfiguration</code>\u3001<code>@ComponentScan</code></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// SpringBootApplication.java</span>
<span class="token annotation punctuation">@SpringBootConfiguration</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootApplication</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><br><p><strong><u>1 - @SpringBootConfiguration</u></strong></p><blockquote><p>@SpringBootApplication \u6807\u6CE8\u7684\u7C7B\u4E5F\u662F\u4E00\u4E2A\u914D\u7F6E\u7C7B\uFF0C\u4E3A SpringBoot \u5BB9\u5668\u7684\u6838\u5FC3\u914D\u7F6E\u7C7B</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootConfiguration</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><br><p><strong><u>2 - @EnableAutoConfiguration</u></strong></p><blockquote><p>@EnableAutoConfiguration\uFF0C\u662F\u4E00\u4E2A\u7EC4\u5408\u6CE8\u89E3\uFF0C\u7531<code>@AutoConfigurationPackage</code>\u548C<code>@Import</code>\u7EC4\u6210</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@AutoConfigurationPackage</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAutoConfiguration</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><br><p>1 \u3001<strong>@AutoConfigurationPackage</strong></p><blockquote><p>\u81EA\u52A8\u5BFC\u5165\u5305\uFF0C\u6307\u5B9A\u4E86\u9ED8\u8BA4\u7684\u5BFC\u5165\u5305\u89C4\u5219</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u7ED9\u5BB9\u5668\u4E2D\u5BFC\u5165\u4E00\u4E2A\u7EC4\u4EF6</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationPackages<span class="token punctuation">.</span>Registrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">AutoConfigurationPackage</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// \u5229\u7528Registrar\u7ED9\u5BB9\u5668\u4E2D\u5BFC\u5165\u4E00\u7CFB\u5217\u7EC4\u4EF6</span>
<span class="token comment">// \u8FD9\u4E00\u7CFB\u5217\u7EC4\u4EF6\u5C31\u662F\u6807\u6CE8\u8FD9\u4E2A\u6CE8\u89E3\uFF08@AutoConfigurationPackage\uFF09\u7684\u7C7B\uFF08MainApplication.java\uFF09\u6240\u5728\u5305\u4E0B\u7684\u7EC4\u4EF6</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><br><p>2\u3001<strong>@Import(AutoConfigurationImportSelector.class)</strong></p><p>1\uFF09\u5229\u7528<code>getAutoConfigurationEntry()</code>\u7ED9\u5BB9\u5668\u4E2D\u6279\u91CF\u5BFC\u5165\u4E00\u4E9B\u7EC4\u4EF6</p><p>2\uFF09\u8C03\u7528<code>getCondidateConfigurations()</code>\u83B7\u53D6\u6240\u6709\u9700\u8981\u5BFC\u5165\u5230\u5BB9\u5668\u4E2D\u7684\u7EC4\u4EF6</p><p>3\uFF09\u5229\u7528\u5DE5\u5382\u52A0\u8F7D<code>Map&lt;String, List&lt;String&gt;&gt; loadSpringFactories(@Nullable ClassLoader classLoader)</code>\u5F97\u5230\u6240\u6709\u7EC4\u4EF6</p><p>4\uFF09\u626B\u63CF\u9879\u76EE resources \u76EE\u5F55\u4E2D\u7684<code>META-INF\\spring.factories</code>\u6587\u4EF6\uFF0C\u5C06\u91CC\u9762\u5B9A\u4E49\u597D\u7684\u914D\u7F6E\u7C7B<strong>\u5168\u90E8\u52A0\u8F7D</strong>\u5230\u5BB9\u5668\u4E2D</p><p>5\uFF09\u5229\u7528<code>@Conditional</code>\u5BF9\u52A0\u8F7D\u8FDB\u5BB9\u5668\u4E2D\u7684\u914D\u7F6E\u7C7B<strong>\u6309\u9700\u5F00\u542F</strong>\u914D\u7F6E\u9879\uFF0C\u53EA\u6709 @Conditional \u5185\u7684\u6761\u4EF6\u751F\u6548\uFF0C\u624D\u542F\u7528\u8BE5\u914D\u7F6E</p><br><p><strong><u>3 - @ComponentScan</u></strong></p><blockquote><p>\u7528\u4F5C\u5305\u626B\u63CF\uFF0C\u6307\u5B9A\u9700\u8981\u626B\u63CF\u54EA\u4E9B\u5305</p></blockquote><p><strong>\u5C5E\u6027</strong>\uFF1A</p><ul><li>basePackages \u626B\u63CF\u65F6\u626B\u63CF\u54EA\u4E9B\u5305</li><li>basePackageClasses \u626B\u63CF\u65F6\u626B\u63CF\u54EA\u4E9B\u7C7B</li><li>includeFilters \u626B\u63CF\u65F6\u53EA\u626B\u63CF\u54EA\u4E9B\u7EC4\u4EF6</li><li>excludeFilters \u626B\u63CF\u7684\u65F6\u6392\u9664\u54EA\u4E9B\u7EC4\u4EF6</li><li>lazyInit \u5305\u626B\u63CF\u61D2\u52A0\u8F7D</li></ul><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u5305\u626B\u63CF\u65F6\u5305\u542B\u54EA\u4E9B\u5185\u5BB9</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>ANNOTATION<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><br><h3 id="\u81EA\u52A8\u914D\u7F6E\u603B\u7ED3" tabindex="-1">\u81EA\u52A8\u914D\u7F6E\u603B\u7ED3 <a class="header-anchor" href="#\u81EA\u52A8\u914D\u7F6E\u603B\u7ED3" aria-hidden="true">#</a></h3><p>1\u3001SpringBoot \u5148\u52A0\u8F7D\u6240\u6709\u7684\u81EA\u52A8\u914D\u7F6E\u7C7B\uFF0C<code>xxxAutoConfiguration</code></p><p>2\u3001\u6BCF\u4E2A\u81EA\u52A8\u914D\u7F6E\u7C7B\u6309\u7167\u9ED8\u8BA4\u6761\u4EF6\u7684\u503C\u751F\u6548\uFF0C\u9ED8\u8BA4\u90FD\u4F1A\u7ED1\u5B9A\u914D\u7F6E\u6587\u4EF6<code>xxxProperties</code>\u6307\u5B9A\u7684\u503C</p><p>3\u3001\u751F\u6548\u7684\u914D\u7F6E\u7C7B\u5C31\u4F1A\u7ED9\u5BB9\u5668\u4E2D\u88C5\u914D\u5BF9\u5E94\u7684\u7EC4\u4EF6</p><p>4\u3001\u53EA\u8981\u5BB9\u5668\u4E2D\u6709\u5BF9\u5E94\u7684\u7EC4\u4EF6\uFF0C\u5BF9\u5E94\u7684\u529F\u80FD\u4E5F\u4F1A\u81EA\u52A8\u5F00\u542F</p><p>5\u3001\u81EA\u5B9A\u4E49\u914D\u7F6E</p><p>1\uFF09\u5728\u81EA\u5B9A\u4E49\u7684\u914D\u7F6E\u7C7B\u5229\u7528 @Bean \u6807\u6CE8\u65B9\u6CD5\uFF0C\u66FF\u6362\u5E95\u5C42\u7684\u7EC4\u4EF6\u65B9\u6CD5</p><p>2\uFF09\u770B\u8981\u81EA\u5B9A\u4E49\u7684\u7EC4\u4EF6\u7ED1\u5B9A\u7684\u914D\u7F6E\u6587\u4EF6\u662F\u4EC0\u4E48\u503C\uFF0C\u5230<code>application.propeties</code>\u4E2D\u4FEE\u6539\u3002</p><p>\u914D\u7F6E\u52A0\u8F7D\u6D41\u7A0B\uFF1A<code>xxxAutoConfiguration</code>==&gt; \u7EC4\u4EF6 ==&gt; <code>xxxProperties</code>\u4E2D\u62FF\u5230\u5BF9\u5E94\u7684\u503C ==&gt; <code>application.properties</code></p><br><h2 id="\u914D\u7F6E\u7ED1\u5B9A" tabindex="-1">\u914D\u7F6E\u7ED1\u5B9A <a class="header-anchor" href="#\u914D\u7F6E\u7ED1\u5B9A" aria-hidden="true">#</a></h2><br><p><u><strong>1 - @Component + @ConfigurationProperties</strong></u></p><blockquote><p>\u7528\u4E8E\u7528\u6237\u81EA\u5B9A\u4E49\u7684\u7C7B</p></blockquote><p><strong>\u5B9E\u73B0\u529F\u80FD</strong></p><p>1\u3001\u5C06 Bean \u7EC4\u4EF6\u6CE8\u5165\u5230 SpringBoot \u5BB9\u5668\u4E2D</p><p>2\u3001\u5F00\u542F\u6CE8\u5165\u7684 Bean \u7EC4\u4EF6\u7684\u914D\u7F6E\u7ED1\u5B9A\u529F\u80FD</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u9996\u5148\u9700\u8981\u5148\u5C06 Bean \u653E\u5230 SpringBoot \u5BB9\u5668\u4E2D\uFF0C@ConfigurationProperties \u624D\u80FD\u751F\u6548</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;mycar&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> band<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> price<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getBand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> band<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBand</span><span class="token punctuation">(</span><span class="token class-name">String</span> band<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>band <span class="token operator">=</span> band<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> price<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-properties line-numbers-mode"><pre><code><span class="token comment"># application.properties</span>
<span class="token key attr-name">mycar.band</span><span class="token punctuation">=</span><span class="token value attr-value">BYD</span>
<span class="token key attr-name">mycar.price</span><span class="token punctuation">=</span><span class="token value attr-value">100</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><br><p><strong><u>2 - @EnableConfigurationProperties</u></strong></p><blockquote><p>\u7528\u4E8E\u6CE8\u5165\u4E0E\u7ED1\u5B9A\u7B2C\u4E09\u65B9\u5F15\u5165\u7684\u7C7B</p></blockquote><p><strong>\u5B9E\u73B0\u529F\u80FD</strong></p><p>1\u3001\u5C06 Bean \u7EC4\u4EF6\u6CE8\u5165\u5230 SpringBoot \u5BB9\u5668\u4E2D</p><p>2\u3001\u5F00\u542F\u6CE8\u5165\u7684 Bean \u7EC4\u4EF6\u7684\u914D\u7F6E\u7ED1\u5B9A\u529F\u80FD</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// MainConfig.java</span>
<span class="token comment">// \u914D\u7F6E\u7C7B\u4E2D</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-properties line-numbers-mode"><pre><code><span class="token comment"># application.properties</span>
<span class="token key attr-name">mycar.band</span><span class="token punctuation">=</span><span class="token value attr-value">WULING</span>
<span class="token key attr-name">mycar.price</span><span class="token punctuation">=</span><span class="token value attr-value">1000</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><br><h2 id="profile-\u914D\u7F6E\u6587\u4EF6" tabindex="-1">Profile \u914D\u7F6E\u6587\u4EF6 <a class="header-anchor" href="#profile-\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a></h2><br><p><strong><u>1 - \u914D\u7F6E\u6587\u4EF6\u547D\u540D\u98CE\u683C</u></strong></p><p>1\u3001\u5F00\u53D1\u73AF\u5883 <code>application-dev.yml</code></p><p>2\u3001\u6D4B\u8BD5\u73AF\u5883 <code>application-test.yml</code></p><p>3\u3001\u751F\u4EA7\u73AF\u5883 <code>application-prod.yml</code></p><p>4\u3001\u9ED8\u8BA4 <code>application.properties</code></p><br><p><strong><u>2 - \u6307\u5B9A\u751F\u6548\u7684\u914D\u7F6E\u6587\u4EF6</u></strong></p><p>1\u3001\u914D\u7F6E\u6587\u4EF6\u4E2D\u6307\u5B9A</p><div class="language-properties line-numbers-mode"><pre><code><span class="token comment"># \u9ED8\u8BA4\u914D\u7F6Eapplication.proprties\u4E2D\u6FC0\u6D3B\u6307\u5B9A\u73AF\u5883\u7684\u914D\u7F6E\u6587\u4EF6</span>
<span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
<span class="token comment"># \u5728\u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6\u4E2D\u6FC0\u6D3B\u4E86\u6307\u5B9A\u73AF\u5883\u7684\u914D\u7F6E\u6587\u4EF6\u540E\uFF0C\u6307\u5B9A\u6FC0\u6D3B\u7684\u914D\u7F6E\u6587\u4EF6\u548C\u9ED8\u8BA4\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u914D\u7F6E\u5185\u5BB9\u3010\u540C\u65F6\u751F\u6548\u3011</span>
<span class="token comment"># \u5982\u679C\u6CA1\u6709\u6307\u5B9A\u6FC0\u6D3B\u914D\u7F6E\uFF0C\u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6\u548C\u6307\u5B9A\u6FC0\u6D3B\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\u6709\u3010\u76F8\u540C\u7684\u914D\u7F6E\u5185\u5BB9\u3011\uFF0C\u5219\u9ED8\u8BA4\u914D\u7F6E\u751F\u6548</span>
<span class="token comment"># \u5982\u679C\u6709\u6307\u5B9A\u6FC0\u6D3B\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u5219\u6307\u5B9A\u3010\u6FC0\u6D3B\u7684\u914D\u7F6E\u5185\u5BB9\u751F\u6548\u3011</span>

<span class="token comment"># \u6307\u5B9A\u6FC0\u6D3B\u7684\u5206\u7EC4\u4E3Amygroup\u7EC4</span>
<span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">mygroup</span>

<span class="token key attr-name">spring.profiles.group.mygroup[0]</span><span class="token punctuation">=</span><span class="token value attr-value">prod-1</span>
<span class="token key attr-name">spring.profiles.group.mygroup[1]</span><span class="token punctuation">=</span><span class="token value attr-value">prod-2</span>

<span class="token key attr-name">spring.profiles.group.test[0]</span><span class="token punctuation">=</span><span class="token value attr-value">test</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>2\u3001\u542F\u52A8\u547D\u4EE4\u884C\u6307\u5B9A</p><div class="language-shell line-numbers-mode"><pre><code><span class="token comment"># \u8FD0\u884C\u65F6\u6307\u5B9A\u6FC0\u6D3B\u914D\u7F6E\u6587\u4EF6</span>
java -jar boot-demo.jar --spring.profiles.active<span class="token operator">=</span>test
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u5728\u4EE5\u4E0A\u4E24\u79CD\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\u7684\u64CD\u4F5C\u4E2D\uFF0C\u4EE5<strong>\u547D\u4EE4\u884C\u6307\u5B9A\u7684\u914D\u7F6E\u4F18\u5148</strong></p><br><p><strong><u>3 - \u6307\u5B9A\u5BB9\u5668\u4E2D\u751F\u6548\u7684\u7EC4\u4EF6</u></strong></p><blockquote><p><code>@Profile</code> \u6CE8\u89E3\uFF0C\u6307\u5B9A\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D\u7684\u67D0\u4E2A\u7EC4\u4EF6\u5728\u4EC0\u4E48\u73AF\u5883\u751F\u6548</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u6807\u5728\u7C7B\u4E0A\uFF0C\u8868\u660E\u6B64\u7EC4\u4EF6\u53EA\u6709\u5728test\u73AF\u5883\u624D\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
    <span class="token comment">// \u6807\u5728\u65B9\u6CD5\u4E0A\uFF0C\u8868\u660E\u8FD9\u4E2ABean\u53EA\u6709\u5728prod\u73AF\u5883\u624D\u6CE8\u5165</span>
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;prod&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Production</span> <span class="token function">production</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><br><h2 id="web-\u5F00\u53D1" tabindex="-1">Web \u5F00\u53D1 <a class="header-anchor" href="#web-\u5F00\u53D1" aria-hidden="true">#</a></h2><br><p><strong>\u5F15\u5165\u4F9D\u8D56</strong></p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><br><h3 id="\u8D44\u6E90\u8BBF\u95EE" tabindex="-1">\u8D44\u6E90\u8BBF\u95EE <a class="header-anchor" href="#\u8D44\u6E90\u8BBF\u95EE" aria-hidden="true">#</a></h3><br><p><strong><u>1 - \u9759\u6001\u8D44\u6E90\u8BBF\u95EE</u></strong></p><blockquote><p>\u53EA\u8981\u5C06\u9759\u6001\u8D44\u6E90\uFF08\u56FE\u7247\uFF0CCSS\uFF0CJS\uFF09\u653E\u5728\u6307\u5B9A\u7684\u76EE\u5F55\u4E0B\uFF0C\u5373\u53EF\u901A\u8FC7\u76F8\u5E94\u8DEF\u5F84\u8BBF\u95EE</p></blockquote><p><strong>1\u3001\u9759\u6001\u8D44\u6E90\u76EE\u5F55</strong></p><ul><li><code>/static</code></li><li><code>/public</code></li><li><code>/resources</code></li><li><code>/META-INF/resources</code></li></ul><p><strong>2\u3001\u8BBF\u95EE</strong>\uFF1A<code>\u5F53\u524D\u9879\u76EE\u6839\u8DEF\u5F84/\u9759\u6001\u8D44\u6E90\u540D</code> =&gt; <code>localhost:8080/\u9759\u6001\u8D44\u6E90\u540D</code></p><br><p>3\u3001<strong>\u81EA\u5B9A\u4E49\u9759\u6001\u8D44\u6E90\u76EE\u5F55</strong></p><div class="language-yaml line-numbers-mode"><pre><code><span class="token comment"># \u5728\u539F\u6709\u7684\u9759\u6001\u8D44\u6E90\u6587\u4EF6\u8DEF\u5F84\u57FA\u7840\u4E0A\uFF0C\u81EA\u5B9A\u4E49\u53E6\u5916\u7684\u9759\u6001\u8D44\u6E90\u5B58\u653E\u76EE\u5F55</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">web</span><span class="token punctuation">:</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span>
      <span class="token key atrule">static-locations</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>classpath<span class="token punctuation">:</span>/haha/<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><br><p><strong>4\u3001\u81EA\u5B9A\u4E49\u9759\u6001\u8D44\u6E90\u8BBF\u95EE\u524D\u7F00</strong></p><div class="language-yaml line-numbers-mode"><pre><code><span class="token comment"># \u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u4FEE\u6539\u9759\u6001\u8D44\u6E90\u8BBF\u95EE\u524D\u7F00</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">web</span><span class="token punctuation">:</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span>
      <span class="token key atrule">static-locations</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>classpath<span class="token punctuation">:</span>/haha/<span class="token punctuation">]</span>
  <span class="token key atrule">mvc</span><span class="token punctuation">:</span>
    <span class="token key atrule">static-path-pattern</span><span class="token punctuation">:</span> /resources/<span class="token important">**</span>
    <span class="token comment"># \u6B64\u65F6\u9759\u6001\u8D44\u6E90\u8BBF\u95EE\u8DEF\u5F84\u4E3A: localhost:8080/resouces/\u9759\u6001\u8D44\u6E90\u540D</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><br><p>5\u3001<strong>\u9759\u6001\u8D44\u6E90\u8BF7\u6C42\u6D41\u7A0B</strong></p><p>1\uFF09\u8BF7\u6C42\u8FDB\u6765\u4E4B\u540E\u5148\u53BB\u627E Controller \u4E2D\u7684\u65B9\u6CD5\uFF0C\u770B\u6709\u6CA1\u6709\u65B9\u6CD5\u80FD\u5904\u7406\u5F53\u524D\u8BF7\u6C42</p><p>2\uFF09\u4E0D\u80FD\u5904\u7406\u7684\u8BF7\u6C42\u4EA4\u7ED9\u9759\u6001\u8D44\u6E90\u5904\u7406\u5668\u8FDB\u884C\u5904\u7406</p><p>3\uFF09\u9759\u6001\u8D44\u4E5F\u672A\u627E\u5230\u7684\u8D44\u6E90\u8FD4\u56DE 404</p><blockquote><p>\u26A0\uFE0F \u81EA\u5B9A\u4E49\u9759\u6001\u8D44\u6E90\u8DEF\u5F84\u548C\u8BBF\u95EE\u524D\u7F00\u90FD\u4F1A\u5BFC\u81F4\u6B22\u8FCE\u9875\u548C favicon \u5931\u6548</p></blockquote><p><strong><br>6\u3001\u9759\u6001\u8D44\u6E90\u914D\u7F6E\u539F\u7406</strong></p><blockquote><p>\u7A0D\u540E\u8865\u5145\u2026</p></blockquote><br><p><strong><u>2 - Restful \u98CE\u683C</u></strong></p><p><strong>1\u3001Web \u9875\u9762\u8868\u5355\u5F00\u542F Restful Url\u652F\u6301</strong></p><p>1\uFF09\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">mvc</span><span class="token punctuation">:</span>
    <span class="token key atrule">hiddenmethod</span><span class="token punctuation">:</span>
      <span class="token key atrule">filter</span><span class="token punctuation">:</span>
        <span class="token comment"># \u5F00\u542Fhtml\u8868\u5355\u7684Restful\u98CE\u683C\uFF0C\u9009\u62E9\u5F00\u542F\uFF0C\u82E5\u8868\u5355\u9700\u8981\u4F7F\u7528restful\u98CE\u683C\u5219\u5F00\u542F</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>2\uFF09HTML \u9875\u9762\u4E2D\u8868\u5355\u8BBE\u7F6E\u9690\u85CF\u7684\u5C5E\u6027\u503C</p><div class="language-html line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_method<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>put<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>put-ipt
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_method<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>delete<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>delete-ipt
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><br><p><strong>2\u3001\u5C06<code>_method</code>\u6539\u6210\u81EA\u5B9A\u4E49</strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u8868\u5355 RestFul \u8BF7\u6C42\u539F\u7406</span>
<span class="token comment">// WebMvcAutoConfiguration.java</span>



<span class="token annotation punctuation">@Bean</span>
<span class="token comment">// \u82E5\u662F\u7EC4\u4EF6\u4E2D\u6CA1\u6709 HiddenHttpMethodFilter\uFF0C\u5219\u542F\u7528 Spring \u9ED8\u8BA4\u7684\u914D\u7F6E\uFF0C\u5373</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">HiddenHttpMethodFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.mvc.hiddenmethod.filter&quot;</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">&quot;enabled&quot;</span><span class="token punctuation">,</span> matchIfMissing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">OrderedHiddenHttpMethodFilter</span> <span class="token function">hiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OrderedHiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// HiddenHttpMethodFilter.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HiddenHttpMethodFilter</span> <span class="token keyword">extends</span> <span class="token class-name">OncePerRequestFilter</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ALLOWED_METHODS <span class="token operator">=</span>
			<span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableList</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span>PUT<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
					<span class="token class-name">HttpMethod</span><span class="token punctuation">.</span>DELETE<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">HttpMethod</span><span class="token punctuation">.</span>PATCH<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/** Default method parameter: {@code _method}. */</span>
    <span class="token comment">// Spring \u9ED8\u8BA4\u7684\u914D\u7F6E\u5373\u4E3A\u9700\u8981\u4F20\u8FC7\u6765\u540D\u4E3A&quot;_method&quot;\u7684\u53C2\u6570</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> DEFAULT_METHOD_PARAM <span class="token operator">=</span> <span class="token string">&quot;_method&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 1\u3001\u65B0\u5EFA\u81EA\u5B9A\u4E49\u914D\u7F6E\u7C7B</span>
<span class="token comment">// WebConfig.java</span>

<span class="token comment">// proxyBeanMethods = false \u4E0D\u9700\u8981\u4F9D\u8D56\u5176\u4ED6\u7EC4\u4EF6\uFF0CproxyBeanMethods\u8BBE\u7F6E\u4E3Afalse\uFF0C\u8DF3\u8FC7\u626B\u63CF\uFF0C\u52A0\u5FEB\u542F\u52A8</span>
<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">HiddenHttpMethodFilter</span> <span class="token function">hiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">HiddenHttpMethodFilter</span> hiddenHttpMethodFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2\u3001\u5C06\u53C2\u6570_method\u4FEE\u6539\u6210\u81EA\u5B9A\u4E49&quot;_gnl&quot;</span>
        <span class="token comment">// 3\u3001\u5728html\u9875\u9762\u4E2D\u7684\u8868\u5355\u8BBE\u7F6E&lt;input type=&quot;hidden&quot; name=&quot;_gnl&quot; value=&quot;put&quot; &gt;</span>
        hiddenHttpMethodFilter<span class="token punctuation">.</span><span class="token function">setMethodParam</span><span class="token punctuation">(</span><span class="token string">&quot;_gnl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> hiddenHttpMethodFilter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><br><p><strong>3\u3001Rest \u6620\u5C04\u539F\u7406</strong></p><blockquote><p>\u7A0D\u540E\u8865\u5145\u2026</p></blockquote><br><h3 id="\u57FA\u672C\u6CE8\u89E3" tabindex="-1">\u57FA\u672C\u6CE8\u89E3 <a class="header-anchor" href="#\u57FA\u672C\u6CE8\u89E3" aria-hidden="true">#</a></h3><ul><li><p><code>@PathVariable</code></p></li><li><p><code>@RequestHeader</code></p></li><li><p><code>@ModelAttribute</code></p></li><li><p><code>@RequestParam</code></p></li><li><p><code>@MatrixVariable</code></p></li><li><p><code>@CookieValue</code></p></li><li><p><code>@RequestBody</code></p></li><li><p><code>@ResponseBody</code></p></li></ul><div class="language-java line-numbers-mode"><pre><code><span class="token comment">/**
 * http://localhost:8080/pv/zhangsan/aaa/18?id=10&amp;scores=80&amp;scores=90
 */</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/pv/{name}/aaa/{age}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> age<span class="token punctuation">,</span>
                                            <span class="token comment">// \u53EF\u4EE5\u7528@PathVariable Map&lt;String,String&gt; \u6765\u63A5\u6536</span>
                                            <span class="token comment">// \u8DEF\u5F84\u4E2D\u6240\u6709@PathVariable \u7684\u53C2\u6570\uFF0CMap\u7684key\u548Cvalue\u90FD\u5FC5\u987B\u662FString\u7C7B\u578B</span>
                                            <span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> pvMap<span class="token punctuation">,</span>
                                            <span class="token comment">// @RequestHeader(value = &quot;User-Agent&quot;) \u83B7\u53D6\u8BF7\u6C42\u5934\u4E2D\u7684\u67D0\u4E2A\u53C2\u6570</span>
                                            <span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> userAgent<span class="token punctuation">,</span>
                                            <span class="token comment">// @RequestHeader Map&lt;String, String&gt; \u83B7\u53D6\u8BF7\u6C42\u5934\u4E2D\u6240\u6709\u7684\u53C2\u6570\u4FE1\u606F</span>
                                            <span class="token comment">// \u9700\u7528Map&lt;String, String&gt; \u6765\u63A5\u6536</span>
                                            <span class="token annotation punctuation">@RequestHeader</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> header<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> id<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;scores&quot;</span><span class="token punctuation">)</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> scores<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> paramsMap<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@CookieValue</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;Webstorm-85c34080&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> cookieStr<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@CookieValue</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;Webstorm-85c34080&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Cookie</span> cookie<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;pvMap&quot;</span><span class="token punctuation">,</span> pvMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;userAgent&quot;</span><span class="token punctuation">,</span> userAgent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;header&quot;</span><span class="token punctuation">,</span> header<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;scores&quot;</span><span class="token punctuation">,</span> scores<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;paramsMap&quot;</span><span class="token punctuation">,</span> paramsMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;cookie&quot;</span><span class="token punctuation">,</span> cookieStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;==&gt;&quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getComment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @RequestBody \u6D4B\u8BD5
 */</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">requestBodyMethod</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">String</span> content<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @RequestAttribute \u6D4B\u8BD5
 * http://localhost:8080/toSuccess
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/toSuccess&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toSuccess</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;toSuccess\u4E2D\u653E\u5165\u7684msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    request<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;forward:/success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/success&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">requestAttributeMethod</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> msg<span class="token punctuation">,</span>
                                                  <span class="token annotation punctuation">@RequestAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> code<span class="token punctuation">,</span>
                                                  <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> reqMsg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> request<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;reqMsg&quot;</span><span class="token punctuation">,</span> reqMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
 * @MatrixVariable \u77E9\u9635\u53D8\u91CF
 * SpringBoot\u9ED8\u8BA4\u662F\u7981\u7528\u4E86\u77E9\u9635\u53D8\u91CF\u7684\u529F\u80FD\uFF0C\u9700\u8981\u624B\u52A8\u5F00\u542F
 * \u8BED\u6CD5 ==&gt; \u8BF7\u6C42\u8DEF\u5F84/stuff/1;age=20/2;age=30;brand=xiaomi,huawei,oppo,vivo
 
 * http://localhost:8080/stuff/1;age=20/2;age=30;brand=xiaomi,huawei,oppo,vivo
 */</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/stuff/{boss}/{emp}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">matrixVariable</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;boss&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> boss<span class="token punctuation">,</span>
                                          <span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> emp<span class="token punctuation">,</span>
                                          <span class="token annotation punctuation">@MatrixVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> pathVar <span class="token operator">=</span> <span class="token string">&quot;boss&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> bossAge<span class="token punctuation">,</span>
                                          <span class="token annotation punctuation">@MatrixVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> pathVar <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> empAge<span class="token punctuation">,</span>
                                          <span class="token annotation punctuation">@MatrixVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;brand&quot;</span><span class="token punctuation">)</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> brands<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;boss&quot;</span><span class="token punctuation">,</span> boss<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;bossAge&quot;</span><span class="token punctuation">,</span> bossAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;empAge&quot;</span><span class="token punctuation">,</span> empAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;brands&quot;</span><span class="token punctuation">,</span> brands<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u624B\u52A8\u542F\u7528\u77E9\u9635\u53D8\u91CF\u529F\u80FD</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token function">webMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configurePathMatch</span><span class="token punctuation">(</span><span class="token class-name">PathMatchConfigurer</span> configurer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">UrlPathHelper</span> urlPathHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlPathHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// removeSemicolonContent\u5728SpringBoot\u5E95\u5C42\u9ED8\u8BA4\u4E3Atrue\uFF0C\u5373\u9ED8\u8BA4\u79FB\u9664\u8BF7\u6C42\u8DEF\u5F84\u4E2D\u5206\u53F7\u540E\u9762\u7684\u5185\u5BB9\uFF0C</span>
            <span class="token comment">// \u5219@MatrixVariable \u65E0\u6CD5\u83B7\u53D6\u5230\u8DEF\u5F84\u5206\u53F7\u540E\u7684\u5185\u5BB9\uFF0C\u8BBE\u7F6E\u4E3Afalse\u8868\u793A\u4E0D\u79FB\u9664\u5206\u53F7\u540E\u9762\u7684\u5185\u5BB9</span>
            <span class="token comment">// @MatrixVariable\u6CE8\u89E3\u7684\u529F\u80FD\u5373\u53EF\u751F\u6548</span>
            urlPathHelper<span class="token punctuation">.</span><span class="token function">setRemoveSemicolonContent</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            configurer<span class="token punctuation">.</span><span class="token function">setUrlPathHelper</span><span class="token punctuation">(</span>urlPathHelper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br></div></div><br><h3 id="\u81EA\u5B9A\u4E49\u683C\u5F0F\u8F6C\u6362" tabindex="-1">\u81EA\u5B9A\u4E49\u683C\u5F0F\u8F6C\u6362 <a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u683C\u5F0F\u8F6C\u6362" aria-hidden="true">#</a></h3><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token function">webMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token comment">// \u6CE8\u5165\u81EA\u5B9A\u4E49\u8F6C\u6362\u5668</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addFormatters</span><span class="token punctuation">(</span><span class="token class-name">FormatterRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// \u5C06\u83B7\u53D6\u5230\u7684 String \u7C7B\u578B\u8F6C\u6362\u4E3A\u81EA\u5B9A\u4E49\u7C7B\u578B</span>
                registry<span class="token punctuation">.</span><span class="token function">addConverter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token class-name">Pet</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token class-name">Pet</span> pet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            pet<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            pet<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">return</span> pet<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><br><p><strong><u>2 - \u539F\u7406</u></strong></p><blockquote><p>\u7A0D\u540E\u8865\u5145\u2026</p></blockquote><br><h3 id="\u62E6\u622A\u5668" tabindex="-1">\u62E6\u622A\u5668 <a class="header-anchor" href="#\u62E6\u622A\u5668" aria-hidden="true">#</a></h3><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">/**
 * \u767B\u5F55\u62E6\u622A\u5668
 *  1. \u914D\u7F6E\u597D\u8981\u62E6\u622A\u548C\u653E\u884C\u7684\u8BF7\u6C42
 *  2. \u5C06\u62E6\u622A\u5668\u6CE8\u5165\u5230\u5BB9\u5668\u4E2D
 * 
 * Filter\u548CInterceptor\u533A\u522B
 *  1. Filter\u662FServlet\u539F\u751F\u7EC4\u4EF6\uFF0C\u53EF\u4EE5\u8131\u79BBSpring\u6846\u67B6\u8FD0\u4F5C
 *  2. Interceptor\u662FSpring\u5B9A\u4E49\u7684\u63A5\u53E3\uFF0C\u53EA\u80FD\u5728Spring\u6846\u67B6\u5185\u8FD0\u884C\uFF0C\u53EF\u4EE5\u4F7F\u7528Spring\u6846\u67B6\u7684\u529F\u80FD
 */</span>

<span class="token comment">// 1\u3001\u5B9E\u73B0\u63A5\u53E3</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * \u6267\u884C\u76EE\u6807\u65B9\u6CD5\u524D
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

        <span class="token class-name">String</span> requestURI <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;preHandle\u62E6\u622A\u7684\u8BF7\u6C42\u8DEF\u5F84\u662F{}&quot;</span><span class="token punctuation">,</span>requestURI<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u767B\u5F55\u68C0\u67E5\u903B\u8F91</span>
        
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u767B\u9646\u68C0\u67E5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u8FD4\u56DEtrue\u653E\u884C</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * \u6267\u884C\u76EE\u6807\u65B9\u6CD5\u540E
     *
     * @param request
     * @param response
     * @param handler
     * @param modelAndView
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;postHandle\u6267\u884C{}&quot;</span><span class="token punctuation">,</span>modelAndView<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * \u9875\u9762\u6E32\u67D3\u4EE5\u540E
     *
     * @param request
     * @param response
     * @param handler
     * @param ex
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;afterCompletion\u6267\u884C\u5F02\u5E38{}&quot;</span><span class="token punctuation">,</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2\u3001\u6CE8\u5165\u5230IOC\u5BB9\u5668\u4E2D</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token function">webMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoginInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">// \u62E6\u622A\u6240\u6709\u8BF7\u6C42\uFF0C\u5305\u62EC\u9759\u6001\u8D44\u6E90</span>
                <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// \u653E\u884C\u8BF7\u6C42</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/css/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/js/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/img/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><br><p><strong><u>2 - \u539F\u7406</u></strong></p><blockquote><p>\u7A0D\u540E\u8865\u5145\u2026</p></blockquote><br><h3 id="\u6587\u4EF6\u4E0A\u4F20" tabindex="-1">\u6587\u4EF6\u4E0A\u4F20 <a class="header-anchor" href="#\u6587\u4EF6\u4E0A\u4F20" aria-hidden="true">#</a></h3><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">servlet</span><span class="token punctuation">:</span>
    <span class="token key atrule">multipart</span><span class="token punctuation">:</span>
      <span class="token key atrule">max-file-size</span><span class="token punctuation">:</span> 10MB <span class="token comment"># \u5355\u4E2A\u4E0A\u4F20\u6587\u4EF6\u5927\u5C0F</span>
      <span class="token key atrule">max-request-size</span><span class="token punctuation">:</span> 100MB <span class="token comment"># \u5355\u6B21\u8BF7\u6C42\u603B\u4E0A\u4F20\u6587\u4EF6\u5927\u5C0F</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-html line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/upload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipart/form-data<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>headImg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--\u591A\u6587\u4EF6\u4E0A\u4F20--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>photos<span class="token punctuation">&quot;</span></span> <span class="token attr-name">multiple</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>upload<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">fileUpload</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
                         <span class="token annotation punctuation">@RequestPart</span><span class="token punctuation">(</span><span class="token string">&quot;headImg&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> headImg<span class="token punctuation">,</span>
                         <span class="token annotation punctuation">@RequestPart</span><span class="token punctuation">(</span><span class="token string">&quot;photos&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> photos<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;headImgName&quot;</span><span class="token punctuation">,</span> headImg<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;headImgSize&quot;</span><span class="token punctuation">,</span> headImg<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;photosLength&quot;</span><span class="token punctuation">,</span>photos<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>headImg<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> filename <span class="token operator">=</span> headImg<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headImg<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\DevData\\\\Data\\\\upload\\\\&quot;</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> photo <span class="token operator">:</span> photos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>photo<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">String</span> filename <span class="token operator">=</span> photo<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            photo<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\DevData\\\\Data\\\\upload\\\\&quot;</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong><u>2 - \u539F\u7406</u></strong></p><blockquote><p>\u7A0D\u540E\u8865\u5145\u2026</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// MultipartAutoConfiguration.java</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><br><h3 id="\u5F02\u5E38\u5904\u7406" tabindex="-1">\u5F02\u5E38\u5904\u7406 <a class="header-anchor" href="#\u5F02\u5E38\u5904\u7406" aria-hidden="true">#</a></h3><p><strong><u>1 - \u5168\u5C40\u5F02\u5E38\u5904\u7406</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// GlobalExceptionHandler.java</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * @ExceptionHandler \u8868\u660E\u7528\u5F53\u524D\u65B9\u6CD5\u6765\u5904\u7406\u5168\u5C40\u5F02\u5E38
     *  @ExceptionHandler(value = { ArithmeticException.class, ClassNotFoundException.class })
     *      \u8868\u660E\u5F53\u524D\u65B9\u6CD5\u4E13\u95E8\u5904\u7406ArithmeticException\u548CClassNotFoundException
     *
     * \u82E5\u6709\u591A\u4E2A\u65B9\u6CD5\u80FD\u540C\u65F6\u5904\u7406\u67D0\u7C7B\u5F02\u5E38\uFF0C\u4EE5\u7CBE\u786E\u4F18\u5148
     * \u5B58\u5728\u672C\u7C7B\u548C\u5168\u5C40\u5F02\u5E38\u5904\u7406\u65F6\uFF0C\u672C\u7C7B\u5185\u7684\u5F02\u5E38\u5904\u7406\u65B9\u6CD5\u4F18\u5148\u5904\u7406\uFF08\u5C31\u8FD1\u539F\u5219\uFF09
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token class-name">ArithmeticException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">exceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;\u51FA\u9519\u5566\uFF01&quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong><u>2 - \u539F\u7406</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// ErrorMvcAutoConfiguration.java</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="springmvc-\u539F\u7406" tabindex="-1">SpringMVC \u539F\u7406 <a class="header-anchor" href="#springmvc-\u539F\u7406" aria-hidden="true">#</a></h3><blockquote><p>\u7A0D\u540E\u8865\u5145\u2026</p></blockquote><br><h2 id="\u6570\u636E\u5E93\u64CD\u4F5C" tabindex="-1">\u6570\u636E\u5E93\u64CD\u4F5C <a class="header-anchor" href="#\u6570\u636E\u5E93\u64CD\u4F5C" aria-hidden="true">#</a></h2><br><h3 id="mysql" tabindex="-1">MySQL <a class="header-anchor" href="#mysql" aria-hidden="true">#</a></h3><p><strong><u>1 - \u57FA\u672C\u914D\u7F6E</u></strong></p><p>1\u3001\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mysql.version</span><span class="token punctuation">&gt;</span></span>5.1.49<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mysql.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>2\u3001\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>///springboot<span class="token punctuation">?</span>useSSL=false
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><br><p><strong><u>2 - \u5355\u72EC\u5F15\u5165\u6570\u636E\u6E90</u></strong></p><p>1\u3001\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml line-numbers-mode"><pre><code><span class="token comment">&lt;!-- \u5F15\u5165Druid\u6570\u636E\u6E90\u4F9D\u8D56 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>2\u3001\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>///springboot<span class="token punctuation">?</span>useSSL=false
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token comment"># \u4E0E\u5728\u914D\u7F6E\u7C7B\u4E2D\u914D\u7F6E\u6548\u679C\u7B49\u540C</span>
    <span class="token comment">#filters: stat,wall</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>3\u3001\u4FEE\u6539\u914D\u7F6E\u7C7B</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * \u5C06\u6570\u636E\u6E90\u6CE8\u5165\u5230IOC\u5BB9\u5668
     * \u9ED8\u8BA4\u914D\u7F6E\u662F\u770B\u5BB9\u5668\u4E2D\u6CA1\u6709\u914D\u7F6EDataSource\u624D\u4F1A\u6CE8\u5165\u9ED8\u8BA4\u7684\u6570\u636E\u6E90 @ConditionalOnMissingBean({ DataSource.class })
     */</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.datasource&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">DruidDataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//dataSource.setFilters(&quot;stat&quot;);\u5F00\u542Fsql\u76D1\u63A7\u529F\u80FD\uFF0C\u5F00\u542F\u9632\u706B\u5899</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setFilters</span><span class="token punctuation">(</span><span class="token string">&quot;stat,wall&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * \u914D\u7F6Edruid\u76D1\u63A7\u9875
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletRegistrationBean</span> <span class="token function">statViewServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StatViewServlet</span> statViewServlet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StatViewServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ServletRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StatViewServlet</span><span class="token punctuation">&gt;</span></span> registrationBean <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>statViewServlet<span class="token punctuation">,</span> <span class="token string">&quot;/druid/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * druid\u914D\u7F6Eweb\u5E94\u7528\u76D1\u63A7
     * \u914D\u7F6EWebStatFilter\u7528\u4E8E\u91C7\u96C6web-jdbc\u5173\u8054\u76D1\u63A7\u7684\u6570\u636E
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span> <span class="token function">webStatFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">WebStatFilter</span> webStatFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebStatFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebStatFilter</span><span class="token punctuation">&gt;</span></span> registrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>webStatFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">setUrlPatterns</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">addInitParameter</span><span class="token punctuation">(</span><span class="token string">&quot;exclusions&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><br><p><strong><u>3 - starter \u65B9\u5F0F\u5F15\u5165\u6570\u636E\u6E90</u></strong></p><p>1\u3001\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2\u3001\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token comment"># \u6269\u5C55\u914D\u7F6E\u9879</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>///springboot<span class="token punctuation">?</span>useSSL=false
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token comment"># \u4E0E\u5728\u914D\u7F6E\u7C7B\u4E2D\u914D\u7F6E\u6548\u679C\u7B49\u540C</span>
    <span class="token comment"># filters: stat,wall</span>
    <span class="token key atrule">druid</span><span class="token punctuation">:</span>
      <span class="token comment"># \u76D1\u63A7Spring\u5BB9\u5668\u4E2D\u7684bean</span>
      <span class="token key atrule">aop-patterns</span><span class="token punctuation">:</span> com.demo.*
      <span class="token key atrule">filters</span><span class="token punctuation">:</span> stat<span class="token punctuation">,</span>wall<span class="token punctuation">,</span>slf4j <span class="token comment"># \u5F00\u542F\u76D1\u63A7\u529F\u80FD\u548C\u9632\u706B\u5899\u529F\u80FD\uFF0C\u5E76\u7528slf4j\u8BB0\u5F55\u4E0B\u6765</span>
      <span class="token key atrule">filter</span><span class="token punctuation">:</span>
        <span class="token key atrule">stat</span><span class="token punctuation">:</span> <span class="token comment"># \u5BF9filter\u542F\u7528\u529F\u80FD\u7684\u8BE6\u7EC6\u914D\u7F6E</span>
          <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token comment"># \u6162\u67E5\u8BE2sql\u65F6\u95F4</span>
          <span class="token key atrule">slow-sql-millis</span><span class="token punctuation">:</span> <span class="token number">1000</span>
          <span class="token comment"># \u6253\u5370\u6162\u67E5\u8BE2sql</span>
          <span class="token key atrule">log-slow-sql</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">wall</span><span class="token punctuation">:</span>
          <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">config</span><span class="token punctuation">:</span>
            <span class="token comment"># drop-table-allow: false</span>
            <span class="token comment"># \u5141\u8BB8\u53D1\u9001\u67E5\u8BE2\u7684sql</span>
            <span class="token comment"># selelct-allow: true</span>
            <span class="token comment"># \u4E0D\u5141\u8BB8\u53D1\u9001\u66F4\u65B0\u7684sql</span>
            <span class="token comment"># update-allow: false</span>
      <span class="token key atrule">stat-view-servlet</span><span class="token punctuation">:</span> <span class="token comment"># \u542F\u7528\u76D1\u63A7\u9875\u529F\u80FD</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token comment"># \u8BBE\u7F6Edruid\u767B\u5F55\u9875\u7684\u8D26\u53F7\u5BC6\u7801</span>
        <span class="token key atrule">login-username</span><span class="token punctuation">:</span> admin
        <span class="token key atrule">login-password</span><span class="token punctuation">:</span> admin
        <span class="token comment"># \u662F\u5426\u542F\u7528\u91CD\u7F6E\u6309\u94AE</span>
        <span class="token key atrule">reset-enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">web-stat-filter</span><span class="token punctuation">:</span> <span class="token comment"># \u76D1\u63A7web\u5E94\u7528</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">url-pattern</span><span class="token punctuation">:</span> /*
        <span class="token key atrule">exclusions</span><span class="token punctuation">:</span> <span class="token string">&quot;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>3\u3001\u914D\u7F6E\u7C7B</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// DruidDataSourceAutoConfigure.java</span>
<span class="token comment">// \u7A0D\u540E\u8865\u5145</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><br><h3 id="mybatis" tabindex="-1">MyBatis <a class="header-anchor" href="#mybatis" aria-hidden="true">#</a></h3><p><strong><u>1 -\u5B9E\u73B0</u></strong></p><p>1\u3001\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2\u3001\u4FEE\u6539\u914D\u7F6E</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token comment"># config-location\u548Cconfiguration\u4E0D\u80FD\u540C\u65F6\u5B58\u5728</span>
  <span class="token comment"># \u5373\u4E0D\u80FD\u540C\u65F6\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\uFF08mybatis-config.xml\uFF09\u548C\u5728application\u914D\u7F6E\u6587\u4EF6\u4E2D\u8BBE\u7F6E\u914D\u7F6E\u9879</span>
  <span class="token comment"># config-location: classpath:mybatis/mybatis-config.xml</span>
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>/mapper/<span class="token important">*.xml</span>
  <span class="token key atrule">type-aliases-package</span><span class="token punctuation">:</span> com.demo.boot.bean
  <span class="token comment"># \u6307\u5B9Amybatis\u5168\u5C40\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u76F8\u5173\u914D\u7F6E\u9879</span>
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span> 
    <span class="token key atrule">map-underscore-to-camel-case</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong><u>2 - \u81EA\u52A8\u914D\u7F6E\u539F\u7406</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">SqlSessionFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnSingleCandidate</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">MybatisProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// \u7ED1\u5B9AMyBatis\u914D\u7F6E\u9879\u7C7B</span>
<span class="token annotation punctuation">@AutoConfigureAfter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MybatisLanguageDriverAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MybatisAutoConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>
  
  <span class="token comment">// \u81EA\u52A8\u914D\u7F6ESqlSessionFactory</span>
  <span class="token annotation punctuation">@Bean</span>
  <span class="token annotation punctuation">@ConditionalOnMissingBean</span>
  <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">sqlSessionFactory</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource <span class="token comment">/*\u4F7F\u7528\u5BB9\u5668\u4E2D\u7684\u6570\u636E\u6E90*/</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
      <span class="token comment">//...</span>
  <span class="token punctuation">}</span>
	
  <span class="token comment">// \u81EA\u52A8\u914D\u7F6ESqlSessionTemplate\uFF0C\u5176\u4E2D\u7EC4\u5408\u4E86SqlSession</span>
  <span class="token annotation punctuation">@Bean</span>
  <span class="token annotation punctuation">@ConditionalOnMissingBean</span>
  <span class="token keyword">public</span> <span class="token class-name">SqlSessionTemplate</span> <span class="token function">sqlSessionTemplate</span><span class="token punctuation">(</span><span class="token class-name">SqlSessionFactory</span> sqlSessionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//...</span>
  <span class="token punctuation">}</span>
    
    <span class="token comment">// \u53EA\u8981\u5728\u64CD\u4F5CMyBatis\u7684\u63A5\u53E3\u6807\u6CE8\u4E86@Mapper\u6CE8\u89E3\uFF0C\u5C31\u4F1A\u88AB\u81EA\u52A8\u626B\u63CF</span>
    
<span class="token punctuation">}</span>

<span class="token comment">// \u81EA\u52A8\u626B\u63CF\u6307\u5B9A\u7684\u5305\uFF0C\u8868\u660E\u8BE5\u5305\u4E0B\u7684\u7C7B\u5168\u4E3A Mapper</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.demo.boot.mapper&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><br><p><strong><u>3 - \u5F00\u542F\u7F13\u5B58\uFF08\u9009\u62E9\u6027\u5F00\u542F\uFF09</u></strong></p><p>1\u3001<strong>\u4E00\u7EA7\u7F13\u5B58</strong></p><blockquote><p>Mabits \u9ED8\u8BA4\u5F00\u542F\u4E00\u7EA7\u7F13\u5B58</p></blockquote><p>Mybatis \u7684\u4E00\u7EA7\u7F13\u5B58\u662F\u6307 SQLSession\uFF0C\u4E00\u7EA7\u7F13\u5B58\u7684\u4F5C\u7528\u57DF\u662F SQlSession\u3002\u5728\u540C\u4E00\u4E2A SqlSession \u4E2D\uFF0C\u6267\u884C\u76F8\u540C\u7684 SQL \u67E5\u8BE2\u65F6\uFF0C\u7B2C\u4E00\u6B21\u4F1A\u53BB\u67E5\u8BE2\u6570\u636E\u5E93\uFF0C\u5E76\u5199\u5728\u7F13\u5B58\u4E2D\uFF0C\u7B2C\u4E8C\u6B21\u4F1A\u76F4\u63A5\u4ECE\u7F13\u5B58\u4E2D\u53D6\u3002\u6BCF\u6B21\u67E5\u8BE2\u4F1A\u5148\u53BB\u7F13\u5B58\u4E2D\u627E\uFF0C\u5982\u679C\u627E\u4E0D\u5230\uFF0C\u518D\u53BB\u6570\u636E\u5E93\u67E5\u8BE2\uFF0C\u7136\u540E\u628A\u7ED3\u679C\u5199\u5230\u7F13\u5B58\u4E2D\u3002\u5F53\u6267\u884C SQL \u65F6\u4E24\u6B21\u67E5\u8BE2\u4E2D\u95F4\u53D1\u751F\u4E86\u589E\u5220\u6539\u7684\u64CD\u4F5C\uFF0C\u5219 SQLSession \u7684\u7F13\u5B58\u4F1A\u88AB\u6E05\u7A7A\u3002Mybatis \u7684\u5185\u90E8\u7F13\u5B58\u4F7F\u7528\u4E00\u4E2A HashMap\uFF0Ckey \u4E3A<code>hashcode+statementId+sql</code>\u8BED\u53E5\u3002value \u4E3A\u67E5\u8BE2\u51FA\u6765\u7684\u7ED3\u679C\u96C6\u6620\u5C04\u6210\u7684 Java \u5BF9\u8C61\u3002SqlSession \u6267\u884C insert\u3001update\u3001delete \u7B49\u64CD\u4F5C commit \u540E\u4F1A\u6E05\u7A7A\u8BE5 SQLSession \u7F13\u5B58\u3002</p><p>2\u3001<strong>\u4E8C\u7EA7\u7F13\u5B58</strong></p><p>\u4E8C\u7EA7\u7F13\u5B58\u662F Mapper \u7EA7\u522B\u7684\uFF0CMybatis \u9ED8\u8BA4\u662F\u6CA1\u6709\u5F00\u542F\u4E8C\u7EA7\u7F13\u5B58\u7684\u3002\u7B2C\u4E00\u6B21\u8C03\u7528 Mapper \u4E0B\u7684 SQL \u53BB\u67E5\u8BE2\u7528\u6237\u7684\u4FE1\u606F\uFF0C\u67E5\u8BE2\u5230\u7684\u4FE1\u606F\u4F1A\u5B58\u653E\u5728\u8BE5 Mapper \u5BF9\u5E94\u7684\u4E8C\u7EA7\u7F13\u5B58\u533A\u57DF\u3002\u7B2C\u4E8C\u6B21\u8C03\u7528 namespace \u4E0B\u7684 Mapper \u6620\u5C04\u6587\u4EF6\u4E2D\uFF0C\u76F8\u540C\u7684 SQL\u53BB\u67E5\u8BE2\u7528\u6237\u4FE1\u606F\uFF0C\u4F1A\u53BB\u5BF9\u5E94\u7684\u4E8C\u7EA7\u7F13\u5B58\u5185\u53D6\u7ED3\u679C\u3002</p><br><h3 id="mybatis-plus" tabindex="-1">MyBatis Plus <a class="header-anchor" href="#mybatis-plus" aria-hidden="true">#</a></h3><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><p>1\u3001\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>Latest Version<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2\u3001\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">mybatis-plus</span><span class="token punctuation">:</span>
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
    <span class="token key atrule">map-underscore-to-camel-case</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> <span class="token comment">#mapper-locations \u9ED8\u8BA4\u4F4D\u7F6E\u4E3A classpath:mapper/*.xml</span>
  <span class="token key atrule">type-aliases-package</span><span class="token punctuation">:</span> com.demo.boot.bean
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>3\u3001\u914D\u7F6E\u7C7B</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MybatisPlusConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">//\u5206\u9875\u914D\u7F6E</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MybatisPlusInterceptor</span> <span class="token function">mybatisPlusInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">MybatisPlusInterceptor</span> mybatisPlusInterceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MybatisPlusInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PaginationInnerInterceptor</span> paginationInnerInterceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PaginationInnerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u8BBE\u7F6E\u8BF7\u6C42\u7684\u9875\u9762\u5927\u4E8E\u6700\u5927\u9875\u540E\u64CD\u4F5C\uFF0C true\u8C03\u56DE\u5230\u9996\u9875\uFF0Cfalse \u7EE7\u7EED\u8BF7\u6C42  \u9ED8\u8BA4false</span>
        <span class="token comment">// paginationInterceptor.setOverflow(false);</span>
        <span class="token comment">// \u8BBE\u7F6E\u6700\u5927\u5355\u9875\u9650\u5236\u6570\u91CF\uFF0C\u9ED8\u8BA4 500 \u6761\uFF0C-1 \u4E0D\u53D7\u9650\u5236</span>
        <span class="token comment">// paginationInterceptor.setLimit(500);</span>
        <span class="token comment">// \u5F00\u542F count \u7684 join \u4F18\u5316,\u53EA\u9488\u5BF9\u90E8\u5206 left join</span>

        paginationInnerInterceptor<span class="token punctuation">.</span><span class="token function">isOptimizeJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paginationInnerInterceptor<span class="token punctuation">.</span><span class="token function">setOverflow</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mybatisPlusInterceptor<span class="token punctuation">.</span><span class="token function">addInnerInterceptor</span><span class="token punctuation">(</span>paginationInnerInterceptor<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> mybatisPlusInterceptor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>4\u3001Mapper \u7C7B</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u6807\u6CE8@Mapper\u6216\u5728\u914D\u7F6E\u7C7B@MapperScan(basePackages = &quot;com.demo.boot.mapper&quot;) \u81EA\u52A8\u626B\u63CF\u6307\u5B9A\u5305\u4E0B\u7684\u7C7B</span>
<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Service\u63A5\u53E3</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountService</span> <span class="token keyword">extends</span> <span class="token class-name">IService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Service\u5B9E\u73B0\u7C7B</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccountMapper</span><span class="token punctuation">,</span> <span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>5\u3001\u6D4B\u8BD5\u7C7B</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u8BBE\u7F6E\u5206\u9875\u4FE1\u606F</span>
    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    page<span class="token punctuation">.</span><span class="token function">setPages</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    page<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token number">5l</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u8BBE\u7F6E\u8FC7\u6EE4\u6761\u4EF6</span>
    <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// queryWrapper.ge(&quot;age&quot;, 30); \u7B5B\u9009\u5C81\u6570\u5927\u4E8E30\u7684\u6570\u636E</span>
    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> accountPage <span class="token operator">=</span> accountService<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    accountPage<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong><u>2 - \u81EA\u52A8\u914D\u7F6E\u539F\u7406</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">SqlSessionFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnSingleCandidate</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * \u914D\u7F6E\u9879\u7ED1\u5B9A
 * mapperLocations\u9ED8\u8BA4\u503C classpath*:/mapper/**/</span><span class="token operator">*</span><span class="token punctuation">.</span>xml
 <span class="token operator">*</span> \u4EFB\u610F\u5305\u7684\u7C7B\u8DEF\u5F84\u4E0B\u7684\u6240\u6709mapper\u6587\u4EF6\u5939\u4E0B\u4EFB\u610F\u8DEF\u5F84\u4E0B\u7684\u6240\u6709xml\u90FD\u662Fsql\u6620\u5C04\u6587\u4EF6\u3002\u5EFA\u8BAE\u4EE5\u540Esql\u6620\u5C04\u6587\u4EF6\uFF0C\u653E\u5728 mapper\u4E0B
 <span class="token operator">*</span><span class="token operator">/</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">MybatisPlusProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@AutoConfigureAfter</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MybatisPlusLanguageDriverAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MybatisPlusAutoConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>
    
    <span class="token comment">//SqlSessionFactory \u81EA\u52A8\u914D\u7F6E\u597D\u3002\u5E95\u5C42\u662F\u5BB9\u5668\u4E2D\u9ED8\u8BA4\u7684\u6570\u636E\u6E90</span>
    
    <span class="token comment">//SqlSessionTemplate \u81EA\u52A8\u914D\u7F6E\u597D</span>
<span class="token punctuation">}</span>

<span class="token comment">//@Mapper \u6807\u6CE8\u7684\u63A5\u53E3\u4E5F\u4F1A\u88AB\u81EA\u52A8\u626B\u63CF</span>
<span class="token comment">//\u5EFA\u8BAE\u76F4\u63A5 @MapperScan(&quot;com.demo.boot.mapper&quot;) \u6279\u91CF\u626B\u63CF</span>
<span class="token comment">//\u53EA\u9700\u8981\u81EA\u5DF1\u7F16\u5199\u7684Mapper\u7EE7\u627F BaseMapper \u5C31\u53EF\u4EE5\u62E5\u6709Mybatis-Plus\u7684\u529F\u80FD</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><br><h3 id="\u5206\u5E93\u5206\u8868" tabindex="-1">\u5206\u5E93\u5206\u8868 <a class="header-anchor" href="#\u5206\u5E93\u5206\u8868" aria-hidden="true">#</a></h3><p><strong><u>1 - \u4E3A\u4EC0\u4E48\u8981\u5206\u5E93\u5206\u8868\uFF1F\u5982\u4F55\u8FDB\u884C</u></strong></p><p>1\u3001<strong>\u89E3\u51B3\u95EE\u9898</strong></p><p>\u6570\u636E\u5E93\u5206\u8868\u53EF\u4EE5\u89E3\u51B3\u5355\u8868\u6D77\u91CF\u6570\u636E\u7684\u67E5\u8BE2\u6027\u80FD\u95EE\u9898\uFF0C\u5206\u5E93\u53EF\u4EE5\u89E3\u51B3\u5355\u53F0\u6570\u636E\u5E93\u7684\u5E76\u53D1\u8BBF\u95EE\u538B\u529B\u95EE\u9898</p><p>2\u3001<strong>\u5E94\u7528\u573A\u666F</strong></p><p>\u5728\u6CA1\u5206\u5E93\u5206\u8868\u60C5\u51B5\u4E0B\u5F53\u8BA2\u5355\u8868\u6570\u91CF\u8D85\u8FC71000\u4E07\u6761\u4EE5\u4E0A\uFF0C\u6211\u4EEC\u9700\u8981\u5BF9\u8BA2\u5355\u8868\u6309\u7167\u4E1A\u52A1\u8FDB\u884C\u5206\u5E93\u5206\u8868\uFF08\u5F53\u8D85\u8FC7500\u4E07\u6761\u6570\u636E\u6570\u636E\u5E93\u67E5\u8BE2\u7528\u7D22\u5F15\u6548\u7387\u5927\u5927\u4E0B\u964D\uFF09</p><p>3\u3001<strong>\u5206\u5E93\u6280\u672F\u65B9\u6848</strong></p><p>\u4E00\u822C\u90FD\u91C7\u7528\u7B2C\u4E09\u65B9\u5DE5\u5177\uFF0C\u5F53\u5F53\u7F51\u7684 sharding-jdbc\uFF0C\u963F\u91CC TDDL\u3001MyCat \u548C Cobar \u7B49\u63D2\u4EF6</p><p>4\u3001<strong>\u5206\u8868\u7B56\u7565</strong></p><p>1\uFF09\u53D6\u6A21\u5206\u8868\uFF0C\u6BD4\u5982\u8BA2\u5355\u8868\uFF0C\u5982\u679C\u662F\u7528\u6237\u8BA2\u5355\u90A3\u4E48\u6309\u7167\u7528\u6237id\u540E\u4E24\u4F4D\uFF08\u5F53\u6570\u636E\u91CF\u4E0D\u662F\u5F88\u5927\u60C5\u51B5\u4E0B\uFF09\u53D6\u6A21\u5B58\u5230\u4E0D\u540C\u7684\u6570\u636E\u5E93\u8868\u4E2D\uFF0C\u5982\u679C\u662F\u5546\u5BB6\u8BA2\u5355\u90A3\u4E48\u6309\u7167\u5546\u5BB6id\u540E\u4E24\u4F4D\uFF08\u5F53\u6570\u636E\u91CF\u4E0D\u662F\u5F88\u5927\u60C5\u51B5\u4E0B\uFF09\u53D6\u6A21\u5B58\u5230\u4E0D\u540C\u7684\u6570\u636E\u5E93\u8868\u4E2D</p><p>2\uFF09\u6839\u636E\u65F6\u95F4\u7EF4\u5EA6\u5206\u8868</p><p>3\uFF09\u81EA\u5B9A\u4E49 Hash</p><p>5\u3001<strong>\u5206\u5E93\u7B56\u7565</strong></p><p>1\uFF09\u6C34\u5E73\u62C6\u5206\uFF0C\u76F4\u63A5\u589E\u52A0 MySQL \u670D\u52A1\u5668\u6570</p><p>2\uFF09\u6309\u4E1A\u52A1\u62C6\u5206\uFF0C\u8BA2\u5355\u5E93\u3001\u7528\u6237\u5E93\u3001\u5546\u54C1\u5E93\u7B49</p><p>3\uFF09\u53D6\u6A21\u5206\u5E93\uFF08\u540C\u53D6\u6A21\u5206\u8868\u7C7B\u4F3C\uFF09</p><p>6\u3001<strong>\u5206\u5E93\u5206\u8868\u65F6\u67E5\u8BE2\u7B56\u7565</strong></p><p>\u5F53\u8BA2\u5355\u9875\u9762\u9700\u8981\u6839\u636E\u4F1A\u5458\u59D3\u540D\u3001\u624B\u673A\u53F7\u7801\u3001\u8BA2\u5355\u53F7\u3001\u4E0B\u5355\u5F00\u59CB\u65F6\u95F4\u3001\u4E0B\u5355\u7ED3\u675F\u65F6\u95F4\u7B49\u7B49\uFF0C\u8BBE\u8BA1\u5230\u591A\u4E2A\u6A21\u5757\u4E00\u8D77\u5173\u8054\u67E5\u8BE2\u65F6\uFF1A</p><p>1\uFF09\u5BF9\u4E0D\u53EF\u53D8\u5B57\u6BB5\u505A\u6C89\u4F59\uFF0C\u65B9\u4FBF\u67E5\u8BE2\uFF0C\u6BD4\u5982\u7528\u6237\u59D3\u540D\uFF0C\u5728\u91D1\u878D\u5E73\u53F0\u7528\u6237\u5B9E\u540D\u540E\u59D3\u540D\u4E0D\u80FD\u66F4\u6539</p><p>2\uFF09\u6839\u636E\u963F\u91CC\u89C4\u5219\uFF1A\u5404\u4E2A\u6A21\u5757\u4E0D\u8981\u505A\u5173\u8054\u67E5\u8BE2\uFF0C\u907F\u514D join\u3002\u6BD4\u5982\uFF1A\u4E0A\u8FF0\u8BA2\u5355\u8868\u67E5\u8BE2\uFF0C\u9996\u5148\u5230\u4F1A\u5458\u6570\u636E\u5E93\u4E2D\u67E5\u8BE2\uFF0C\u7136\u540E\u5728\u5230\u8BA2\u5355\u8868\u4E2D\u67E5\u8BE2\u3002</p><br><p><strong><u>2 - MySQL \u6269\u5C55\u7B56\u7565</u></strong></p><blockquote><p>\u5173\u4E8E\u6570\u636E\u5E93\u7684\u6269\u5C55\u4E3B\u8981\u5305\u62EC\uFF1A\u4E1A\u52A1\u62C6\u5206\u3001\u4E3B\u4ECE\u590D\u5236\uFF0C\u6570\u636E\u5E93\u5206\u5E93\u4E0E\u5206\u8868</p></blockquote><p>1\u3001<strong>\u6309\u4E1A\u52A1\u62C6\u5206</strong></p><p>\u4E1A\u52A1\u8D77\u6B65\u521D\u59CB\uFF0C\u4E3A\u4E86\u52A0\u5FEB\u5E94\u7528\u4E0A\u7EBF\u548C\u5FEB\u901F\u8FED\u4EE3\uFF0C\u5F88\u591A\u5E94\u7528\u90FD\u91C7\u7528\u96C6\u4E2D\u5F0F\u7684\u67B6\u6784\u3002\u968F\u7740\u4E1A\u52A1\u7CFB\u7EDF\u7684\u6269\u5927\uFF0C\u7CFB\u7EDF\u53D8\u5F97\u8D8A\u6765\u8D8A\u590D\u6742\uFF0C\u8D8A\u6765\u8D8A\u96BE\u4EE5\u7EF4\u62A4\uFF0C\u5F00\u53D1\u6548\u7387\u53D8\u5F97\u8D8A\u6765\u8D8A\u4F4E\uFF0C\u5E76\u4E14\u5BF9\u8D44\u6E90\u7684\u6D88\u8017\u4E5F\u53D8\u5F97\u8D8A\u6765\u8D8A\u5927\uFF0C\u901A\u8FC7\u786C\u4EF6\u63D0\u9AD8\u7CFB\u7EDF\u6027\u80FD\u7684\u65B9\u5F0F\u5E26\u6765\u7684\u6210\u672C\u4E5F\u8D8A\u6765\u8D8A\u9AD8\u3002</p><p>\u56E0\u6B64\uFF0C\u5728\u9009\u578B\u521D\u671F\uFF0C\u4E00\u4E2A\u4F18\u826F\u7684\u67B6\u6784\u8BBE\u8BA1\u662F\u540E\u671F\u7CFB\u7EDF\u8FDB\u884C\u6269\u5C55\u7684\u91CD\u8981\u4FDD\u969C\u3002\u4F8B\u5982\uFF1A\u7535\u5546\u5E73\u53F0\uFF0C\u5305\u542B\u4E86\u7528\u6237\u3001\u5546\u54C1\u3001\u8BC4\u4EF7\u3001\u8BA2\u5355\u7B49\u51E0\u5927\u6A21\u5757\uFF0C\u6700\u7B80\u5355\u7684\u505A\u6CD5\u5C31\u662F\u5728\u4E00\u4E2A\u6570\u636E\u5E93\u4E2D\u5206\u522B\u521B\u5EFA users\u3001shops\u3001comment\u3001order \u56DB\u5F20\u8868\u3002</p><p>\u4F46\u662F\uFF0C\u968F\u7740\u4E1A\u52A1\u89C4\u6A21\u7684\u589E\u5927\uFF0C\u8BBF\u95EE\u91CF\u7684\u589E\u5927\uFF0C\u6211\u4EEC\u4E0D\u5F97\u4E0D\u5BF9\u4E1A\u52A1\u8FDB\u884C\u62C6\u5206\u3002\u6BCF\u4E00\u4E2A\u6A21\u5757\u90FD\u4F7F\u7528\u5355\u72EC\u7684\u6570\u636E\u5E93\u6765\u8FDB\u884C\u5B58\u50A8\uFF0C\u4E0D\u540C\u7684\u4E1A\u52A1\u8BBF\u95EE\u4E0D\u540C\u7684\u6570\u636E\u5E93\uFF0C\u5C06\u539F\u672C\u5BF9\u4E00\u4E2A\u6570\u636E\u5E93\u7684\u4F9D\u8D56\u62C6\u5206\u4E3A\u5BF94\u4E2A\u6570\u636E\u5E93\u7684\u4F9D\u8D56\uFF0C\u8FD9\u6837\u7684\u8BDD\u5C31\u53D8\u6210\u4E864\u4E2A\u6570\u636E\u5E93\u540C\u65F6\u627F\u62C5\u538B\u529B\uFF0C\u7CFB\u7EDF\u7684\u541E\u5410\u91CF\u81EA\u7136\u5C31\u63D0\u9AD8\u4E86\u3002</p><p>2\u3001<strong>\u4E3B\u4ECE\u590D\u5236</strong></p><p>\u4E00\u822C\u91C7\u7528\u4E3B\u4ECE\u590D\u5236\uFF0C\u65B0\u589E\u548C\u4FEE\u6539\u90FD\u5728\u4E3B\u5E93\uFF0C\u67E5\u8BE2\u90FD\u662F\u5728\u4ECE\u5E93\u4E2D\uFF0C\u4E00\u822C\u4E00\u4E3B\u591A\u4ECE\u3002</p><p>MySQL\u4E3B\u4ECE\u590D\u5236\u7684\u539F\u7406\uFF1A\u6570\u636E\u590D\u5236\u7684\u5B9E\u9645\u5C31\u662F Slave \u4ECE Master \u83B7\u53D6 binlog \u6587\u4EF6\uFF0C\u7136\u540E\u5728 Slave \u672C\u5730\u6267\u884C\u65E5\u5FD7\u4E2D\u8BB0\u5F55\u7684\u64CD\u4F5C\u3002\u7531\u4E8E\u4E3B\u4ECE\u590D\u5236\u7684\u8FC7\u7A0B\u662F\u5F02\u6B65\u7684\uFF0C\u56E0\u6B64 Slave \u548C Master \u4E4B\u95F4\u7684\u6570\u636E\u6709\u53EF\u80FD\u5B58\u5728\u5EF6\u8FDF\u7684\u73B0\u8C61\uFF0C\u6B64\u65F6\u53EA\u80FD\u4FDD\u8BC1\u6570\u636E\u6700\u7EC8\u7684\u4E00\u81F4\u6027\u3002</p><p>3\u3001<strong>\u6570\u636E\u5206\u5E93\u4E0E\u5206\u8868</strong></p><p>\u6BCF\u53F0\u673A\u5668\u65E0\u8BBA\u914D\u7F6E\u591A\u4E48\u597D\u5B83\u90FD\u6709\u81EA\u8EAB\u7684\u7269\u7406\u4E0A\u9650\uFF0C\u6240\u4EE5\u5F53\u6211\u4EEC\u5E94\u7528\u5DF2\u7ECF\u80FD\u89E6\u53CA\u6216\u8FDC\u8FDC\u8D85\u51FA\u5355\u53F0\u673A\u5668\u7684\u67D0\u4E2A\u4E0A\u9650\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u552F\u6709\u5BFB\u627E\u522B\u7684\u673A\u5668\u7684\u5E2E\u52A9\u6216\u8005\u7EE7\u7EED\u5347\u7EA7\u7684\u6211\u4EEC\u7684\u786C\u4EF6\uFF0C\u4F46\u5E38\u89C1\u7684\u65B9\u6848\u8FD8\u662F\u901A\u8FC7\u6DFB\u52A0\u66F4\u591A\u7684\u673A\u5668\u6765\u5171\u540C\u627F\u62C5\u538B\u529B\u3002</p><p>1\uFF09\u53D6\u6A21\u5206\u8868</p><p>\u5BF9\u4E8E\u5927\u90E8\u5206\u6570\u636E\u5E93\u7684\u8BBE\u8BA1\u548C\u4E1A\u52A1\u7684\u64CD\u4F5C\u57FA\u672C\u90FD\u4E0E\u7528\u6237\u7684 ID \u76F8\u5173\uFF0C\u56E0\u6B64\u4F7F\u7528\u7528\u6237 ID \u662F\u6700\u5E38\u7528\u7684\u5206\u5E93\u7684\u8DEF\u7531\u7B56\u7565\u3002\u7528\u6237\u7684 ID \u53EF\u4EE5\u4F5C\u4E3A\u8D2F\u7A7F\u6574\u4E2A\u7CFB\u7EDF\u7528\u7684\u91CD\u8981\u5B57\u6BB5\u3002\u56E0\u6B64\uFF0C\u4F7F\u7528\u7528\u6237\u7684 ID \u6211\u4EEC\u4E0D\u4EC5\u53EF\u4EE5\u65B9\u4FBF\u6211\u4EEC\u7684\u67E5\u8BE2\uFF0C\u8FD8\u53EF\u4EE5\u5C06\u6570\u636E\u5E73\u5747\u7684\u5206\u914D\u5230\u4E0D\u540C\u7684\u6570\u636E\u5E93\u4E2D\u3002\uFF08\u5F53\u7136\uFF0C\u8FD8\u53EF\u4EE5\u6839\u636E\u7C7B\u522B\u7B49\u8FDB\u884C\u5206\u8868\u64CD\u4F5C\uFF0C\u5206\u8868\u7684\u8DEF\u7531\u7B56\u7565\u8FD8\u6709\u5F88\u591A\u65B9\u5F0F\uFF09</p><p>\u5F53\u6570\u636E\u6BD4\u8F83\u5927\u7684\u65F6\u5019\uFF0C\u5BF9\u6570\u636E\u8FDB\u884C\u5206\u8868\u64CD\u4F5C\uFF0C\u9996\u5148\u8981\u786E\u5B9A\u9700\u8981\u5C06\u6570\u636E\u5E73\u5747\u5206\u914D\u5230\u591A\u5C11\u5F20\u8868\u4E2D\uFF0C\u4E5F\u5C31\u662F\uFF1A<strong>\u8868\u5BB9\u91CF</strong>\u3002</p><p>\u8FD9\u91CC\u5047\u8BBE\u6709100 \u5F20\u8868\u8FDB\u884C\u5B58\u50A8\uFF0C\u5219\u6211\u4EEC\u5728\u8FDB\u884C\u5B58\u50A8\u6570\u636E\u7684\u65F6\u5019\uFF0C\u9996\u5148\u5BF9\u7528\u6237 ID \u8FDB\u884C\u53D6\u6A21\u64CD\u4F5C\uFF0C\u6839\u636E <code>user_id%100</code> \u83B7\u53D6\u5BF9\u5E94\u7684\u8868\u8FDB\u884C\u5B58\u50A8\u67E5\u8BE2\u64CD\u4F5C</p><p><img src="`+c+`" alt=""></p><p>\u4F8B\u5982\uFF0C<code>user_id = 101</code> \u90A3\u4E48\uFF0C\u6211\u4EEC\u5728\u83B7\u53D6\u503C\u7684\u65F6\u5019\u7684\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u901A\u8FC7\u4E0B\u8FB9\u7684sql\u8BED\u53E5\uFF1A</p><div class="language-sql line-numbers-mode"><pre><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> order_1 <span class="token keyword">where</span> user_id<span class="token operator">=</span> <span class="token number">101</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>\u26A0 \u5982\u679C\u7528\u6237 ID \u4E3A UUID \u53EF\u4EE5\u5148 hash \u7136\u540E\u5728\u8FDB\u884C\u53D6\u6A21</p></blockquote><br><p>2\uFF09\u53D6\u6A21\u5206\u5E93</p><p>\u6570\u636E\u5E93\u5206\u8868\u80FD\u591F\u89E3\u51B3\u5355\u8868\u6570\u636E\u91CF\u5F88\u5927\u7684\u65F6\u5019\u6570\u636E\u67E5\u8BE2\u7684\u6548\u7387\u95EE\u9898\uFF0C\u4F46\u662F\u65E0\u6CD5\u7ED9\u6570\u636E\u5E93\u7684\u5E76\u53D1\u64CD\u4F5C\u5E26\u6765\u6548\u7387\u4E0A\u7684\u63D0\u9AD8\uFF0C\u56E0\u4E3A\u5206\u8868\u7684\u5B9E\u8D28\u8FD8\u662F\u5728\u4E00\u4E2A\u6570\u636E\u5E93\u4E0A\u8FDB\u884C\u7684\u64CD\u4F5C\uFF0C\u5F88\u5BB9\u6613\u53D7\u6570\u636E\u5E93 IO\u6027\u80FD\u7684\u9650\u5236\u3002</p><p>\u56E0\u6B64\uFF0C\u5982\u4F55\u5C06\u6570\u636E\u5E93IO\u6027\u80FD\u7684\u95EE\u9898\u5E73\u5747\u5206\u914D\u51FA\u6765\uFF0C\u5F88\u663E\u7136\u5C06\u6570\u636E\u8FDB\u884C\u5206\u5E93\u64CD\u4F5C\u53EF\u4EE5\u5F88\u597D\u5730\u89E3\u51B3\u5355\u53F0\u6570\u636E\u5E93\u7684\u6027\u80FD\u95EE\u9898\u3002\u5206\u5E93\u7B56\u7565\u4E0E\u5206\u8868\u7B56\u7565\u7684\u5B9E\u73B0\u5F88\u76F8\u4F3C\uFF0C\u6700\u7B80\u5355\u7684\u90FD\u662F\u53EF\u4EE5\u901A\u8FC7\u53D6\u6A21\u7684\u65B9\u5F0F\u8FDB\u884C\u8DEF\u7531\u3002</p><p>\u5C06\u7528\u6237ID\u8FDB\u884C\u53D6\u6A21\u64CD\u4F5C\uFF0C\u8FD9\u6837\u7684\u8BDD\u83B7\u53D6\u5230\u5177\u4F53\u7684\u67D0\u4E00\u4E2A\u6570\u636E\u5E93\uFF0C\u540C\u6837\u5173\u952E\u5B57\u6709\uFF1A<strong>\u7528\u6237ID\u3001\u5E93\u5BB9\u91CF</strong>\u3002\u4E0B\u5217\u4E2D\u6709100\u4E2A\u5E93\uFF1A\u5982\u679C\u7528\u6237 ID \u4E3A UUID \u53EF\u4EE5\u5148 hash \u7136\u540E\u5728\u8FDB\u884C\u53D6\u6A21</p><p><img src="`+l+`" alt=""></p><br><p><strong><u>3 - \u5206\u5E93\u5206\u8868\u603B\u7ED3</u></strong></p><p>1\u3001\u5173\u4E8E\u5206\u5E93\u5206\u8868\u7B56\u7565\u7684\u9009\u62E9\u6709\u5F88\u591A\u79CD\uFF0C\u4E0A\u6587\u4E2D\u6839\u636E\u7528\u6237ID\u5E94\u8BE5\u662F\u6BD4\u8F83\u7B80\u5355\u7684\u4E00\u79CD\u3002\u5176\u4ED6\u65B9\u5F0F\u6BD4\u5982\u4F7F\u7528\u53F7\u6BB5\u8FDB\u884C\u5206\u533A\u6216\u8005\u76F4\u63A5\u4F7F\u7528 hash \u8FDB\u884C\u8DEF\u7531\u7B49\u3002</p><p>2\u3001\u5173\u4E8E\u4E0A\u6587\u4E2D\u63D0\u5230\u7684\uFF0C\u5982\u679C\u7528\u6237\u7684ID\u662F\u901A\u8FC7UUID\u7684\u65B9\u5F0F\u751F\u6210\u7684\u8BDD\uFF0C\u6211\u4EEC\u9700\u8981\u5355\u72EC\u7684\u8FDB\u884C\u4E00\u6B21hash\u64CD\u4F5C\uFF0C\u7136\u540E\u5728\u8FDB\u884C\u53D6\u6A21\u64CD\u4F5C\u7B49\u3002\u5176\u5B9Ehash\u672C\u8EAB\u5C31\u662F\u4E00\u79CD\u5206\u5E93\u5206\u8868\u7684\u7B56\u7565\uFF0C\u4F7F\u7528hash\u8FDB\u884C\u8DEF\u7531\u7B56\u7565\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u9700\u8981\u77E5\u9053\u7684\u662Fhash\u8DEF\u7531\u7B56\u7565\u7684\u4F18\u7F3A\u70B9\u3002\u4F18\u70B9\u662F\uFF1A\u6570\u636E\u5206\u5E03\u5747\u5300\uFF1B\u7F3A\u70B9\u662F\uFF1A\u6570\u636E\u8FC1\u79FB\u7684\u65F6\u5019\u9EBB\u70E6\uFF0C\u4E0D\u80FD\u6309\u7167\u673A\u5668\u6027\u80FD\u5206\u644A\u6570\u636E\u3002</p><p>3\u3001\u4E0A\u8FF0\u7684\u5206\u5E93\u548C\u5206\u8868\u64CD\u4F5C\uFF0C\u67E5\u8BE2\u6027\u80FD\u548C\u5E76\u53D1\u80FD\u529B\u90FD\u5F97\u5230\u4E86\u63D0\u9AD8\uFF0C\u4F46\u662F\u8FD8\u6709\u4E00\u4E9B\u9700\u8981\u6CE8\u610F\u7684\u5C31\u662F\uFF0C\u4F8B\u5982\uFF1A\u539F\u672C\u8DE8\u8868\u7684\u4E8B\u7269\u53D8\u6210\u4E86\u5206\u5E03\u5F0F\u4E8B\u7269\uFF1B\u7531\u4E8E\u8BB0\u5F55\u88AB\u5207\u5206\u5230\u4E0D\u540C\u7684\u6570\u636E\u5E93\u548C\u4E0D\u540C\u7684\u6570\u636E\u8868\u4E2D\uFF0C\u96BE\u4EE5\u8FDB\u884C\u591A\u8868\u5173\u8054\u67E5\u8BE2\uFF0C\u5E76\u4E14\u4E0D\u80FD\u4E0D\u6307\u5B9A\u8DEF\u7531\u5B57\u6BB5\u5BF9\u6570\u636E\u8FDB\u884C\u67E5\u8BE2\u3002\u5206\u5E93\u5206\u8868\u4E4B\u540E\uFF0C\u5982\u679C\u6211\u4EEC\u9700\u8981\u5BF9\u7CFB\u7EDF\u8FDB\u884C\u8FDB\u4E00\u6B65\u7684\u6269\u9635\u5BB9\uFF08\u8DEF\u7531\u7B56\u7565\u53D8\u66F4\uFF09\uFF0C\u5C06\u53D8\u5F97\u975E\u5E38\u4E0D\u65B9\u4FBF\uFF0C\u9700\u8981\u6211\u4EEC\u91CD\u65B0\u8FDB\u884C\u6570\u636E\u8FC1\u79FB\u3002</p><br><h3 id="redis" tabindex="-1">Redis <a class="header-anchor" href="#redis" aria-hidden="true">#</a></h3><br><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
  	<span class="token comment"># \u53EA\u914D\u7F6Eurl\u6216\u8005\u5355\u72EC\u914Dhost\u548Cport</span>
  	<span class="token comment"># url: redis://user:password@example.com:6379</span>
  	<span class="token key atrule">host</span><span class="token punctuation">:</span> 
  	<span class="token key atrule">port</span><span class="token punctuation">:</span>
  	<span class="token comment"># \u6307\u5B9A\u5BA2\u6237\u7AEFjedis or lettuce\uFF08\u9ED8\u8BA4\uFF09</span>
  	<span class="token key atrule">client-type</span><span class="token punctuation">:</span> jedis
    <span class="token key atrule">jedis</span><span class="token punctuation">:</span>
      <span class="token key atrule">pool</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">10</span>
        <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">5</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong><u>2 - \u81EA\u52A8\u914D\u7F6E\u7C7B</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// RedisAutoConfiguration.java</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token class-name">RedisOperations</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">RedisProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// \u914D\u7F6E\u7ED1\u5B9ARedisProperties</span>
<span class="token comment">/**
 * Lettuce\uFF0CJedis\u7528\u6765\u64CD\u4F5Credis
 * LettuceConnectionConfiguration\uFF0CJedisConnectionConfiguration \u81EA\u52A8\u51C6\u5907\u4E24\u4E2A\u8FDE\u63A5\u5DE5\u5382\uFF0C\u9700\u8981\u54EA\u4E2A\u542F\u7528\u54EA\u4E2A
 */</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">LettuceConnectionConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">JedisConnectionConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisAutoConfiguration</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><br><h2 id="\u4E8B\u52A1\u7BA1\u7406" tabindex="-1">\u4E8B\u52A1\u7BA1\u7406 <a class="header-anchor" href="#\u4E8B\u52A1\u7BA1\u7406" aria-hidden="true">#</a></h2><br><h2 id="\u8FDC\u7A0B\u63A5\u53E3\u8C03\u7528" tabindex="-1">\u8FDC\u7A0B\u63A5\u53E3\u8C03\u7528 <a class="header-anchor" href="#\u8FDC\u7A0B\u63A5\u53E3\u8C03\u7528" aria-hidden="true">#</a></h2><br><p><strong><u>1 - \u539F\u751F Http \u8BF7\u6C42</u></strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/doPostGetJson&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">doPostGetJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">{</span>
   <span class="token comment">// \u6B64\u5904\u5C06\u8981\u53D1\u9001\u7684\u6570\u636E\u8F6C\u6362\u4E3Ajson\u683C\u5F0F\u5B57\u7B26\u4E32</span>
   <span class="token class-name">String</span> jsonText <span class="token operator">=</span> <span class="token string">&quot;{id: 1}&quot;</span><span class="token punctuation">;</span>
   <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> <span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>jsonText<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">JSONObject</span> sr <span class="token operator">=</span> <span class="token function">doPost</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u8FD4\u56DE\u53C2\u6570: &quot;</span> <span class="token operator">+</span> sr<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> sr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">JSONObject</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">HttpClient</span> client <span class="token operator">=</span> <span class="token class-name">HttpClients</span><span class="token punctuation">.</span><span class="token function">createDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// \u8981\u8C03\u7528\u7684\u63A5\u53E3\u65B9\u6CD5</span>
   <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token string">&quot;http://192.168.1.101:8080/getJson&quot;</span><span class="token punctuation">;</span>
   <span class="token class-name">HttpPost</span> post <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpPost</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">StringEntity</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringEntity</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      s<span class="token punctuation">.</span><span class="token function">setContentEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      s<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      post<span class="token punctuation">.</span><span class="token function">setEntity</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
      post<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">HttpResponse</span> res <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>post<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">String</span> response1 <span class="token operator">=</span> <span class="token class-name">EntityUtils</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getStatusLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStatusCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>SC_OK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token class-name">String</span> result <span class="token operator">=</span> <span class="token class-name">EntityUtils</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// \u8FD4\u56DEjson\u683C\u5F0F: </span>
         jsonObject <span class="token operator">=</span> <span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> jsonObject<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><br><p><strong><u>2 - RestTemplate</u></strong></p><p><strong>1\u3001Get \u8BF7\u6C42</strong></p><p>1\uFF09<code>getForEntity(Stringurl,Class responseType,Object\u2026urlVariables)</code></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// http://USER-SERVICE/user?name={name)</span>
<span class="token class-name">RestTemplate</span> restTemplate<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> params<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
params<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;dada&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// \u53C2\u6570 name-value</span>
<span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> responseEntity<span class="token operator">=</span>restTemplate<span class="token punctuation">.</span><span class="token function">getForEntity</span><span class="token punctuation">(</span><span class="token string">&quot;http://USERSERVICE/user?name={name}&quot;</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><br><p>2\uFF09<code>getForEntity(URI url,Class responseType)</code></p><blockquote><p>\u8BE5\u65B9\u6CD5\u4F7F\u7528 URI \u5BF9\u8C61\u6765\u66FF\u4EE3\u4E4B\u524D\u7684 url \u548C urlVariables \u53C2\u6570\u6765\u6307\u5B9A\u8BBF\u95EE\u5730\u5740\u548C\u53C2\u6570\u7ED1\u5B9A\u3002URI \u662FJDK <code>java.net</code>\u5305\u4E0B\u7684\u4E00\u4E2A\u7C7B\uFF0C\u8868\u793A\u4E00\u4E2A\u7EDF\u4E00\u8D44\u6E90\u6807\u8BC6\u7B26\uFF08Uniform Resource Identifier\uFF09\u5F15\u7528</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token class-name">RestTemplate</span> restTemplate<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">UriComponents</span> uriComponents<span class="token operator">=</span><span class="token class-name">UriComponentsBuilder</span><span class="token punctuation">.</span><span class="token function">fromUriString</span><span class="token punctuation">(</span><span class="token string">&quot;http://USER-SERVICE/user?name={name}&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expand</span><span class="token punctuation">(</span><span class="token string">&quot;dodo&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">URI</span> uri<span class="token operator">=</span>uriComponents<span class="token punctuation">.</span><span class="token function">toUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> responseEntity<span class="token operator">=</span>restTemplate<span class="token punctuation">.</span><span class="token function">getForEntity</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><br><p>3\uFF09<code>getForObject()</code></p><blockquote><p><code>getForObject()</code>\u65B9\u6CD5\u53EF\u4EE5\u7406\u89E3\u4E3A\u5BF9<code>getForEntity()</code>\u7684\u8FDB\u4E00\u6B65\u5C01\u88C5\uFF0C\u5B83\u901A\u8FC7 HttpMessageConverterExtractor \u5BF9 HTTP \u7684\u8BF7\u6C42\u54CD\u5E94\u4F53 body \u5185\u5BB9\u8FDB\u884C\u5BF9\u8C61\u8F6C\u6362\uFF0C\u5B9E\u73B0\u8BF7\u6C42\u76F4\u63A5\u8FD4\u56DE\u5305\u88C5\u597D\u7684\u5BF9\u8C61\u5185\u5BB9\u3002</p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span><span class="token class-name">Class</span> responseType<span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>urlVariables<span class="token punctuation">)</span>
<span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span><span class="token class-name">Class</span> responseType<span class="token punctuation">,</span><span class="token class-name">Map</span> urlVariables<span class="token punctuation">)</span>
<span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token class-name">URI</span> url<span class="token punctuation">,</span><span class="token class-name">Class</span> responseType<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><br><p><strong>2\u3001Post \u8BF7\u6C42</strong></p><blockquote><p>Post \u8BF7\u6C42\u63D0\u4F9B\u6709\u4E09\u79CD\u65B9\u6CD5\uFF0C<code>postForEntity()</code>\u3001<code>postForObject()</code>\u548C<code>postForLocation()</code></p></blockquote><div class="language-java line-numbers-mode"><pre><code><span class="token class-name">RestTemplate</span> restTemplate<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">User</span> user<span class="token operator">=</span><span class="token function">newUser</span><span class="token punctuation">(</span><span class="token string">&quot;didi&quot;</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> responseEntity<span class="token operator">=</span>restTemplate<span class="token punctuation">.</span><span class="token function">postForEntity</span><span class="token punctuation">(</span><span class="token string">&quot;http://USER-SERVICE/user&quot;</span><span class="token punctuation">,</span>user<span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u63D0\u4EA4\u7684body\u5185\u5BB9\u4E3Auser\u5BF9\u8C61\uFF0C\u8BF7\u6C42\u7684\u8FD4\u56DE\u7684body\u7C7B\u578B\u4E3AString</span>
<span class="token class-name">String</span> body<span class="token operator">=</span>responseEntity<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// postForEntity() \u5B58\u5728\u5982\u4E0B\u4E09\u79CD\u65B9\u6CD5\u7684\u91CD\u8F7D</span>

<span class="token function">postForEntity</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span><span class="token class-name">Object</span> request<span class="token punctuation">,</span><span class="token class-name">Class</span> responseType<span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> uriVariables<span class="token punctuation">)</span>
<span class="token function">postForEntity</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span><span class="token class-name">Object</span> request<span class="token punctuation">,</span><span class="token class-name">Class</span> responseType<span class="token punctuation">,</span><span class="token class-name">Map</span> uriVariables<span class="token punctuation">)</span>
<span class="token function">postForEntity</span><span class="token punctuation">(</span><span class="token class-name">URI</span> url<span class="token punctuation">,</span><span class="token class-name">Object</span> request\uFF0C<span class="token class-name">Class</span> responseType<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><br><p><strong><u>3 - Feign \u8BF7\u6C42</u></strong></p><p>1\u3001\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-feign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>LastestVersion<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2\u3001\u914D\u7F6E</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token key atrule">feignRemote</span><span class="token punctuation">:</span>
  <span class="token key atrule">url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//10.2.1.148<span class="token punctuation">:</span>3333/
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3\u3001\u542F\u52A8\u7C7B\u6DFB\u52A0 <code>@EnableFeignClients </code>\uFF0C\u88AB\u8C03\u7528\u65B9\u4E3B\u542F\u52A8\u7C7B\u6DFB\u52A0<code>@EnableDiscoveryClient</code></p><p>4\u3001\u7F16\u5199 Feign \u63A5\u53E3</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u6700\u7EC8\u8BF7\u6C42\u8DEF\u5F84\u4E3A http://10.2.1.148:3333/decision/person</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">&quot;\${feignRemote.url}&quot;</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">&quot;engine&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DecisionEngineService</span> <span class="token punctuation">{</span>
\u3000\u3000<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/decision/person&quot;</span><span class="token punctuation">,</span>method<span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
\u3000\u3000<span class="token keyword">public</span> <span class="token class-name">JSONObject</span> <span class="token function">getEngineMesasge</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;uid&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> uid<span class="token punctuation">,</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;productCode&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> productCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>5\u3001\u5728\u4EE3\u7801\u4E2D\u8C03\u7528</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">DecisionEngineService</span> decisionEngineService <span class="token punctuation">;</span>
<span class="token comment">// ...</span>
decisionEngineService<span class="token punctuation">.</span><span class="token function">getEngineMesasge</span><span class="token punctuation">(</span><span class="token string">&quot;uid&quot;</span> <span class="token punctuation">,</span>  <span class="token string">&quot;productCode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><br><h2 id="api-\u9650\u6D41" tabindex="-1">API \u9650\u6D41 <a class="header-anchor" href="#api-\u9650\u6D41" aria-hidden="true">#</a></h2><blockquote><p>\u9AD8\u5E76\u53D1\u7684\u4E09\u677F\u65A7\uFF1A\u7F13\u5B58\uFF0C\u964D\u7EA7\u548C\u9650\u6D41\u3002\u672C\u7AE0\u8282\u4F7F\u7528\u91C7\u7528guava\u7684LimitRater\u5B9E\u73B0\uFF0C\u662F\u672C\u5730\u9650\u6D41\uFF0C\u82E5\u8981\u5B9E\u73B0\u5206\u5E03\u5F0F\u9650\u6D41\u53EF\u4EE5\u4F7F\u7528\u901A\u8FC7 Redis+Lua+AOP \u65B9\u6848</p></blockquote><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><p>1\u3001\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.github.forezp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>distributed-limit-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2\u3001\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token comment"># \u672C\u5730\u9650\u6D41\uFF0C\u53EA\u9700\u8981\u914D\u7F6Elimit.type=local</span>
<span class="token comment"># limit.type: local</span>
<span class="token comment"># \u91C7\u7528Redis\u9650\u6D41\uFF0C\u914D\u7F6Elimit.type=redis\uFF0C\u4EE5\u53CAredis\u7684\u914D\u7F6E</span>
<span class="token key atrule">limit.type</span><span class="token punctuation">:</span> redis

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
<span class="token comment">#    password: ee</span>
    <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token key atrule">pool</span><span class="token punctuation">:</span>
      <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">8</span>
      <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">-1</span>
      <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">500</span>
      <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">0</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>3\u3001\u5728 Controller \u5BF9\u5E94\u7684\u65B9\u6CD5\u4E0A\u52A0<code>@Limit</code>\u6CE8\u89E3</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// identifier \u7528\u4F5C\u8EAB\u4EFD\u8BC6\u522B</span>
    <span class="token comment">// key \u4E3A\u9650\u6D41\u7684key</span>
    <span class="token comment">// limtNum \u4E3A\u9650\u5236\u7684\u6B21\u6570</span>
    <span class="token comment">// seconds \u4E3A\u591A\u5C11\u79D2</span>
    <span class="token comment">// limtNum + seconds \u5373\u8868\u793A\u5728seconds\u79D2\u65F6\u95F4\u5185\u6700\u5927\u7684\u8BF7\u6C42\u6B21\u6570</span>
    <span class="token comment">// identifier \u548C key \u652F\u6301 Spel \u8868\u8FBE\u5F0F</span>
    <span class="token comment">// \u5982\u679C\u4EC5API\u7EF4\u5EA6\uFF0Cidentifier \u4E3A\u7A7A\u5373\u53EF\uFF1B\u5982\u679C\u4EC5\u7528\u6237\u7EF4\u5EA6\uFF0Ckey\u4E3A\u7A7A\u5373\u53EF\u3002</span>
    <span class="token annotation punctuation">@Limit</span><span class="token punctuation">(</span>identifier <span class="token operator">=</span> <span class="token string">&quot;forezp&quot;</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> limtNum <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> seconds <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>4\u3001\u5982\u679C\u4EE5\u8BF7\u6C42\u7528\u6237\u7EF4\u5EA6\u53BB\u9650\u6D41\uFF0C\u53EF\u4EE5\u52A8\u6001\u7684\u8BBE\u7F6E\u7684 identifier \u7684\u503C</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IndentifierInterceptor</span> <span class="token keyword">extends</span> <span class="token class-name">HandlerInterceptorAdapter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u83B7\u53D6\u7528\u6237\u7684\u4FE1\u606F\uFF0C\u6BD4\u5982\u89E3\u6790Token\u83B7\u53D6\u7528\u6237\u540D\uFF0C</span>
        <span class="token comment">// \u8FD9\u4E48\u505A\u4E3B\u8981\u662F\u5728\u57FA\u4E8E@Limit\u6CE8\u89E3\u5728Controller\u7684\u65F6\u5019\uFF0C\u80FD\u90FD\u52A8\u6001\u8BBE\u7F6Eidentifier\u4FE1\u606F</span>
        <span class="token comment">// \u4ECE\u800C\u4EE5\u7528\u6237\u7EF4\u5EA6\u8FDB\u884C\u9650\u6D41</span>
        <span class="token class-name">String</span> identifier <span class="token operator">=</span> <span class="token string">&quot;forezp&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">IdentifierThreadLocal</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> identifier <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong><u>2 - \u62E6\u622A\u5668\u5C42\u5B9E\u73B0</u></strong></p><p>1\u3001\u62E6\u622A\u5668\u5B9E\u73B0</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebInterceptor</span> <span class="token keyword">extends</span> <span class="token class-name">HandlerInterceptorAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">LimitEntity</span><span class="token punctuation">&gt;</span></span> limitEntityMap <span class="token operator">=</span> <span class="token class-name">Maps</span><span class="token punctuation">.</span><span class="token function">newConcurrentMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">LimitExcutor</span> limitExcutor<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u9650\u6D412\u4E2A\u7EF4\u5EA6:  \u7528\u6237\u548Capi\u7EF4\u5EA6</span>
        <span class="token comment">//\u6BD4\u5982\u7528\u6237\u540D</span>
        <span class="token class-name">String</span> identifier <span class="token operator">=</span> <span class="token string">&quot;forezp&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//api\u7EF4\u5EA6</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> composeKey <span class="token operator">=</span> <span class="token class-name">KeyUtil</span><span class="token punctuation">.</span><span class="token function">compositeKey</span><span class="token punctuation">(</span> identifier<span class="token punctuation">,</span> key <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">LimitEntity</span> limitEntity <span class="token operator">=</span> limitEntityMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span> composeKey <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>limitEntity <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            limitEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LimitEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            limitEntity<span class="token punctuation">.</span><span class="token function">setIdentifier</span><span class="token punctuation">(</span> identifier <span class="token punctuation">)</span><span class="token punctuation">;</span>
            limitEntity<span class="token punctuation">.</span><span class="token function">setKey</span><span class="token punctuation">(</span> key <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u8FD9\u53EF\u4EE5\u5728\u6570\u636E\u5E93\u4E2D\u914D\u7F6E\u6216\u8005\u7F13\u5B58\u4E2D\u8BFB\u53D6\uFF0C\u5728\u8FD9\u91CC\u6211\u5199\u6B7B</span>
            limitEntity<span class="token punctuation">.</span><span class="token function">setSeconds</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
            limitEntity<span class="token punctuation">.</span><span class="token function">setLimtNum</span><span class="token punctuation">(</span> <span class="token number">10</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
            limitEntityMap<span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span> composeKey<span class="token punctuation">,</span> limitEntity <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>limitExcutor<span class="token punctuation">.</span><span class="token function">tryAccess</span><span class="token punctuation">(</span> limitEntity <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">LimitException</span><span class="token punctuation">(</span> <span class="token string">&quot;you fail access, cause api limit rate ,try it later&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>2\u3001\u6CE8\u518C\u62E6\u622A\u5668</p><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebMvcConfigurerAdapter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">IndentifierInterceptor</span> indentifierInterceptor<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">WebInterceptor</span> webInterceptor<span class="token punctuation">;</span>

    <span class="token comment">/**
     * \u6CE8\u518C \u62E6\u622A\u5668
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span> indentifierInterceptor <span class="token punctuation">)</span><span class="token punctuation">;</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span> webInterceptor <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><br><h2 id="\u6307\u6807\u76D1\u63A7" tabindex="-1">\u6307\u6807\u76D1\u63A7 <a class="header-anchor" href="#\u6307\u6807\u76D1\u63A7" aria-hidden="true">#</a></h2><br><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><p>1\u3001\u914D\u7F6E\u7C7B</p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-yaml line-numbers-mode"><pre><code><span class="token comment"># \u6269\u5C55\u914D\u7F6E</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token comment"># \u9ED8\u8BA4\u4E3Atrue\uFF0C\u5F00\u542F\u6240\u6709\u7684\u76D1\u63A7endpoint</span>
    <span class="token key atrule">enabled-by-default</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token comment"># \u4EE5web\u65B9\u5F0F\u76D1\u63A7\u6240\u6709endpoint</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
  <span class="token key atrule">endpoint</span><span class="token punctuation">:</span> <span class="token comment"># \u5BF9\u67D0\u4E2A\u7AEF\u70B9\u8FDB\u884C\u914D\u7F6E</span>
    <span class="token key atrule">health</span><span class="token punctuation">:</span>
      <span class="token comment"># \u6309\u9700\u5F00\u542F\u7AEF\u70B9</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">show-details</span><span class="token punctuation">:</span> always <span class="token comment"># \u663E\u793A\u6240\u6709\u5065\u5EB7\u4FE1\u606F</span>
    <span class="token key atrule">info</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">metrics</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>2\u3001\u8BBF\u95EE<code>http://localhost:8080/actuator</code> \u67E5\u770B\u6240\u6709\u66B4\u9732\u7684 endpoint</p><br><p><strong><u>2 - endpoint \u4FE1\u606F</u></strong></p><p>1\u3001\u5065\u5EB7\u68C0\u67E5\u7AEF\u70B9 <code>health </code> \uFF0C\u7528\u4E8E\u68C0\u67E5\u5E94\u7528\u5065\u5EB7\u72B6\u51B5\u3002<code>http://localhost:8080/actuator/health</code></p><p>2\u3001\u67E5\u770B\u5E94\u7528\u8FD0\u884C\u6307\u6807 <code>metrics </code> \uFF0C\u5C55\u793A\u8BE6\u7EC6\u7684\uFF0C\u5C42\u7EA7\u7684\u7A7A\u95F4\u6307\u6807\u4FE1\u606F\u3002<code>http://localhost:8080/actuator/metrics</code></p><p>3\u3001\u67E5\u770B\u5E94\u7528\u67D0\u9879\u6307\u6807\u8BE6\u60C5\u4FE1\u606F<code>http://localhost:8080/actuator/metrics/http.server.requests</code></p><br><p><strong><u>3 - \u81EA\u5B9A\u4E49\u76D1\u63A7\u7AEF\u70B9\u4FE1\u606F</u></strong></p><p>1\u3001\u7F16\u5199\u914D\u7F6E\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><pre><code><span class="token comment">#\u6269\u5C55\u914D\u7F6E</span>
<span class="token key atrule">info</span><span class="token punctuation">:</span>
  <span class="token key atrule">appName</span><span class="token punctuation">:</span> boot<span class="token punctuation">-</span>demo<span class="token punctuation">-</span>web
  <span class="token key atrule">appVersion</span><span class="token punctuation">:</span> 1.0.0
  <span class="token key atrule">projectName</span><span class="token punctuation">:</span> @project.artifactId@
  <span class="token key atrule">projectVersion</span><span class="token punctuation">:</span> @project.version@
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>2\u3001\u81EA\u5B9A\u4E49 Info \u7C7B</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">/**
 * \u81EA\u5B9A\u4E49Info\u7C7B
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppInfoContributor</span> <span class="token keyword">implements</span> <span class="token class-name">InfoContributor</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contribute</span><span class="token punctuation">(</span><span class="token class-name">Info<span class="token punctuation">.</span>Builder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">withDetail</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withDetail</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u81EA\u5B9A\u4E49Info\u4FE1\u606F&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withDetails</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonMap</span><span class="token punctuation">(</span><span class="token string">&quot;hhh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;some msg...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>3\u3001\u81EA\u5B9A\u4E49<code>health</code>\u4FE1\u606F</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">/**
 * \u81EA\u5B9A\u4E49\u5065\u5EB7\u4FE1\u606F\u68C0\u67E5
 */</span>
<span class="token annotation punctuation">@Component</span> <span class="token comment">//\u5C06\u7EC4\u4EF6\u6CE8\u5165\u5BB9\u5668</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCusHealthIndicator</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractHealthIndicator</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * \u68C0\u67E5\u5065\u5EB7\u4FE1\u606F
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doHealthCheck</span><span class="token punctuation">(</span><span class="token class-name">Health<span class="token punctuation">.</span>Builder</span> builder<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// \u5199\u6CD51</span>
            builder<span class="token punctuation">.</span><span class="token function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;healthMsg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u4F60\u7684\u78C1\u76D8\u6587\u4EF6\u8D3C\u5065\u5EB7~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;ms&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u5199\u6CD52</span>
            builder<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">Status</span><span class="token punctuation">.</span>OUT_OF_SERVICE<span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;unHealthMsg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u4F60\u7684\u78C1\u76D8\u6587\u4EF6\u6709\u70B9\u4E0D\u5065\u5EB7\u54E6~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;ms&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

        <span class="token comment">// \u68C0\u67E5\u5B8C\u6210\u8FD4\u56DE\u89C1\u7ED3\u679C\u4FE1\u606F</span>
        builder<span class="token punctuation">.</span><span class="token function">withDetail</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withDetails</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>4\u3001\u81EA\u5B9A\u4E49 <code>metrics</code> \u76D1\u63A7\u6307\u6807</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">// \u5C06getByPage\u65B9\u6CD5\u7684\u8C03\u7528\u6B21\u6570\u4F5C\u4E3A\u81EA\u5B9A\u4E49\u6307\u6807\u6CE8\u518C\u5230metrics</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccountMapper</span><span class="token punctuation">,</span> <span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">AccountMapper</span> accountMapper<span class="token punctuation">;</span>

    <span class="token class-name">Counter</span> counter<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">AccountServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">MeterRegistry</span> meterRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u5C06\u6307\u6807\u6CE8\u518C\u5230 actuator/metrics</span>
        counter <span class="token operator">=</span> meterRegistry<span class="token punctuation">.</span><span class="token function">counter</span><span class="token punctuation">(</span><span class="token string">&quot;accountServiceImpl.getByPage.count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token function">getByPage</span><span class="token punctuation">(</span><span class="token class-name">Long</span> pageNum<span class="token punctuation">,</span> <span class="token class-name">Long</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        page<span class="token punctuation">.</span><span class="token function">setPages</span><span class="token punctuation">(</span>pageNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        page<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> accountPage <span class="token operator">=</span> accountMapper<span class="token punctuation">.</span><span class="token function">selectPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// counter\u8BA1\u6570+1</span>
        counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> accountPage<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>5\u3001\u81EA\u5B9A\u4E49 Endpoint</p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">/**
 * MyCustomEndpoint.java
 * \u81EA\u5B9A\u4E49\u7AEF\u70B9
 * \u81EA\u5B9A\u4E49\u7AEF\u70B9\u9ED8\u8BA4\u66B4\u9732\uFF0C\u4E0D\u7528\u914D\u7F6E\u66B4\u9732\u5C5E\u6027
 */</span>

<span class="token annotation punctuation">@Component</span>
<span class="token comment">//\u81EA\u5B9A\u4E49\u7AEF\u70B9\u540D</span>
<span class="token annotation punctuation">@Endpoint</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">&quot;my-custom&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCustomEndpoint</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * @ReadOperation \u8868\u660E\u662F\u5F53\u524D\u65B9\u6CD5\u7AEF\u70B9\u7684\u8BFB\u64CD\u4F5C
     * getSomeInfo() \u8868\u660E\u5F53\u524D\u65B9\u6CD5\u662F\u4E00\u4E2A\u5C5E\u6027\uFF0C\u4E0D\u80FD\u51FA\u73B0\u53C2\u6570\uFF0C\u4E0D\u80FD\u4F20\u53C2
     * http://localhost:8080/actuator/my-custom
     */</span>
    <span class="token annotation punctuation">@ReadOperation</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span> <span class="token function">getSomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonMap</span><span class="token punctuation">(</span><span class="token string">&quot;customInfo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;this is the msg from my custom info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @WriteOperation \u8868\u660E\u5F53\u524D\u65B9\u6CD5\u662F\u7AEF\u70B9\u7684\u5199\u64CD\u4F5C
     * \u65B9\u6CD5\u540C\u6837\u4E0D\u80FD\u4F20\u53C2
     */</span>
    <span class="token annotation punctuation">@WriteOperation</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;setting some infos now...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><br><h2 id="\u5355\u5143\u6D4B\u8BD5" tabindex="-1">\u5355\u5143\u6D4B\u8BD5 <a class="header-anchor" href="#\u5355\u5143\u6D4B\u8BD5" aria-hidden="true">#</a></h2><p><strong>\u6574\u5408 JUnit5</strong></p><div class="language-java line-numbers-mode"><pre><code><span class="token comment">//JUnit5Test.java</span>

<span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;JUnit5-\u529F\u80FD\u6D4B\u8BD5&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JUnit5Test</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@BeforeAll</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testBeforeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeforeAll \u5728\u3010\u6240\u6709\u3011\u65B9\u6CD5\u5F00\u59CB\u4E4B\u524D\u8FD0\u884C\uFF0C\u65B9\u6CD5\u9700\u8981\u4F7F\u7528static\u5173\u952E\u5B57\u4FEE\u9970&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testBeforeEach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeforeEach \u3010\u6BCF\u4E2A\u3011\u6D4B\u8BD5\u65B9\u6CD5\u5F00\u59CB\u4E4B\u524D\u8FD0\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;DisplayName\u6D4B\u8BD5&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Timeout</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">,</span> unit <span class="token operator">=</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DisplayName \u6D4B\u8BD5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Disabled</span> <span class="token comment">//\u8FDB\u884C\u5355\u5143\u6D4B\u8BD5\u65F6\u7981\u7528\u6B64\u65B9\u6CD5</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;test junit5...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RepeatedTest</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testRepeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;repeat 5 times&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD5\u7B80\u5355\u65AD\u8A00&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSimpleAssertions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * \u65AD\u8A00\u6D4B\u8BD5 \u524D\u9762\u7684\u65AD\u8A00\u5931\u8D25\uFF0C\u540E\u9762\u7684\u65AD\u8A00\u4E0D\u4F1A\u7EE7\u7EED\u6267\u884C
         * assertEquals \u5224\u65AD\u4E24\u4E2A\u503C\u662F\u5426\u76F8\u7B49
         * \u53C2\u6570[1]\u4E3A\u671F\u671B\u503C
         * \u53C2\u6570[2]\u4E3A\u5B9E\u9645\u8FD4\u56DE\u503C
         * \u53C2\u6570[3]\u4E3A\u81EA\u5B9A\u4E49\u9519\u8BEF\u63D0\u793A\u4FE1\u606F
         * \u82E5\u4E3Atrue\u5219\u8FD0\u884C\u6210\u529F\uFF0C\u82E5\u4E3Afalse\u5219\u4F1A\u62A5\u9519
         * @author gnl
         * @date 2021/2/2 11:30
         */</span>
        <span class="token comment">//Assertions.assertEquals(6, res);</span>
        <span class="token comment">//Assertions.assertEquals(6, res, &quot;\u6C42\u548C\u8FD0\u7B97\u903B\u8F91\u6D4B\u8BD5\u5931\u8D25&quot;);</span>

        <span class="token comment">// \u5224\u65AD\u4E24\u4E2A\u5BF9\u8C61\u5F15\u7528\u662F\u5426\u76F8\u7B49</span>
        <span class="token class-name">String</span> originStr <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
        <span class="token function">assertSame</span><span class="token punctuation">(</span>originStr<span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token string">&quot;\u4E24\u4E2A\u5BF9\u8C61\u5F15\u7528\u4E0D\u76F8\u7B49&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertSame</span><span class="token punctuation">(</span>originStr<span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token string">&quot;\u4E24\u4E2A\u5BF9\u8C61\u5F15\u7528\u4E0D\u76F8\u7B49&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testArrayAssertions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">assertArrayEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD5\u7EC4\u5408\u65AD\u8A00&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCombinedAssertions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u6240\u6709\u65AD\u8A00\u5168\u90E8\u9700\u8981\u6210\u529F</span>
        <span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertAll</span><span class="token punctuation">(</span><span class="token string">&quot;testAll&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7ED3\u679C\u4E0D\u4E3Atrue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;\u4E24\u4E2A\u503C\u4E0D\u76F8\u7B49&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD5\u5F02\u5E38\u65AD\u8A00&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testExceptedAssertions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">assertThrows</span><span class="token punctuation">(</span><span class="token class-name">ArithmeticException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">/</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">,</span><span class="token string">&quot;ex\u63D0\u793A\u4FE1\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD5\u524D\u7F6E\u6761\u4EF6&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAssumption</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5047\u8BBE\u5931\u8D25\u6267\u884C\u6574\u4F53\u5355\u5143\u6D4B\u8BD5\u65F6\u4F1A\u548CDisable\u6807\u6CE8\u7684\u65B9\u6CD5\u4E00\u6837\u8DF3\u8FC7</span>
        <span class="token class-name">Assumptions</span><span class="token punctuation">.</span><span class="token function">assumeTrue</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7ED3\u679C\u4E0D\u662Ftrue\u629B\u51FA\u7684\u4FE1\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u5316\u6D4B\u8BD5&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ParameterizedTest</span>
    <span class="token annotation punctuation">@ValueSource</span><span class="token punctuation">(</span>ints <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testParameterized</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u5316\u6D4B\u8BD5\uFF0C\u53C2\u6570\u503C\u4ECE\u65B9\u6CD5\u4E2D\u83B7\u5F97&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ParameterizedTest</span>
    <span class="token annotation punctuation">@MethodSource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;stringProvider&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testParameterize2</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//\u4F5C\u4E3A\u53C2\u6570\u5316\u6D4B\u8BD5\u7684MethodSource\uFF0C\u9700\u8981\u662Fstatic\u4FEE\u9970\u7684\u65B9\u6CD5</span>
    <span class="token keyword">static</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">stringProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;banana&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lemon&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAfterEach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;AfterEach \u3010\u6BCF\u4E2A\u3011\u6D4B\u8BD5\u65B9\u6CD5\u4E4B\u540E\u8FD0\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterAll</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testAfterAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;AfterAll \u5728\u3010\u6240\u6709\u3011\u65B9\u6CD5\u5B8C\u6210\u4E4B\u540E\u8FD0\u884C\uFF0C\u65B9\u6CD5\u9700\u8981\u4F7F\u7528static\u5173\u952E\u5B57\u4FEE\u9970&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br></div></div><br><h2 id="\u6574\u5408-log4j2" tabindex="-1">\u6574\u5408 Log4j2 <a class="header-anchor" href="#\u6574\u5408-log4j2" aria-hidden="true">#</a></h2><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- \u6392\u9664\u6389logging\uFF0C\u4E0D\u4F7F\u7528logback\uFF0C\u6539\u7528log4j2 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- log4j2 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-log4j2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-yaml line-numbers-mode"><pre><code><span class="token comment"># application.yaml\uFF0C\u914D\u7F6E\u6587\u4EF6\u4E2D\u914D\u7F6E\u626B\u63CFlog4j2.xml\u914D\u7F6E\u6587\u4EF6</span>
<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>log4j2.xml
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong><u>2 - \u914D\u7F6E\u6587\u4EF6<code>log4j2.xml</code></u></strong></p><p><strong>1\u3001\u57FA\u7840\u914D\u7F6E</strong></p><div class="language-xml line-numbers-mode"><pre><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token comment">&lt;!--\u65E5\u5FD7\u7EA7\u522B\u4EE5\u53CA\u4F18\u5148\u7EA7\u6392\u5E8F: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- \u5B9A\u4E49\u65E5\u5FD7\u5B58\u50A8\u7684\u8DEF\u5F84 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>LOG_PATH<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logs<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!--\u65E5\u5FD7\u8F93\u5165\u683C\u5F0F--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>LOG_PATTERN<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Properties</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Appenders</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- \u63A7\u5236\u53F0\u65E5\u5FD7\u6253\u5370 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Console</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Console<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SYSTEM_OUT<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- \u6253\u5370 info \u7EA7\u522B\u53CA\u4EE5\u4E0A --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ACCEPT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DENY<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\${LOG_PATTERN}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Console</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Appenders</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Loggers</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- com.demo \u5305\u4E0B\u4EC5\u8F93\u51FA debug \u7EA7\u522B\u53CA\u4EE5\u4E0A\u7684\u65E5\u5FD7 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.demo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>debug<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token comment">&lt;!-- root \u5168\u5C40\u914D\u7F6E\uFF0C\u9ED8\u8BA4\u6240\u6709\u7684Logger\u90FD\u7EE7\u627F\u6B64\u914D\u7F6E --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AppenderRef</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Console<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Root</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Loggers</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><br><h2 id="\u6574\u5408-jwt" tabindex="-1">\u6574\u5408 JWT <a class="header-anchor" href="#\u6574\u5408-jwt" aria-hidden="true">#</a></h2><blockquote><p>JWT\uFF08JSON Web Token\uFF09\uFF0C\u901A\u8FC7 JSON \u5F62\u5F0F\u4F5C\u4E3A Web \u5E94\u7528\u4E2D\u7684\u4EE4\u724C\uFF0C\u7528\u4E8E\u5728\u5404\u65B9\u4E4B\u95F4\u5B89\u5168\u5730\u5C06\u4FE1\u606F\u4F5C\u4E3A JSON \u5BF9\u8C61\u4F20\u8F93\u3002\u5728\u4F20\u8F93\u7684\u8FC7\u7A0B\u4E2D\u8FD8\u53EF\u4EE5\u5B8C\u6210\u6570\u636E\u52A0\u5BC6\u3001\u7B7E\u540D\u7B49\u64CD\u4F5C</p></blockquote><br><p><strong><u>1 - \u4F20\u7EDF Session-Cookie \u8BA4\u8BC1</u></strong></p><p><strong>1\u3001\u8BA4\u8BC1\u6D41\u7A0B</strong></p><p>1\uFF09\u7531\u4E8E http \u534F\u8BAE\u672C\u8EAB\u662F\u4E00\u79CD\u65E0\u72B6\u6001\u7684\u534F\u8BAE\uFF0C\u8FD9\u610F\u5473\u7740\u5982\u679C\u7528\u6237\u5411\u670D\u52A1\u7AEF\u63D0\u4F9B\u4E86\u7528\u6237\u540D\u548C\u5BC6\u7801\u6765\u8FDB\u884C\u7528\u6237\u8BA4\u8BC1\u4E4B\u540E\uFF0C\u4E0B\u4E00\u6B21\u8BF7\u6C42\u65F6\uFF0C\u7528\u6237\u8FD8\u9700\u8981\u518D\u4E00\u6B21\u8FDB\u884C\u7528\u6237\u8BA4\u8BC1\u624D\u884C\uFF1B</p><p>2\uFF09\u56E0 http \u534F\u8BAE\u65E0\u72B6\u6001\uFF0C\u670D\u52A1\u7AEF\u5E76\u4E0D\u80FD\u77E5\u9053\u662F\u54EA\u4E2A\u7528\u6237\u53D1\u51FA\u7684\u8BF7\u6C42\uFF0C\u6240\u4EE5\u4E3A\u4E86\u8BA9\u670D\u52A1\u7AEF\u80FD\u8BC6\u522B\u662F\u54EA\u4E2A\u7528\u6237\u53D1\u51FA\u7684\u8BF7\u6C42\uFF0C\u6211\u4EEC\u53EA\u80FD\u5728\u670D\u52A1\u5668\u5B58\u50A8\u4E00\u4EFD\u7528\u6237\u7684\u767B\u5F55\u4FE1\u606F\uFF1B</p><p>3\uFF09\u8FD9\u4EFD\u767B\u5F55\u4FE1\u606F\u4F1A\u5728<mark>\u7B2C\u4E00\u6B21\u54CD\u5E94</mark>\u65F6\u4F20\u9012\u7ED9\u6D4F\u89C8\u5668\uFF0C\u5E76\u5728\u6D4F\u89C8\u5668\u7AEF\u4FDD\u5B58\u4E3A cookie\uFF0C\u4EE5\u4FBF\u4E0B\u6B21\u53D1\u9001\u8BF7\u6C42\u65F6\u643A\u5E26\u7740\u53D1\u9001\u5230\u670D\u52A1\u5668\u3002\u8FD9\u6837\u670D\u52A1\u5668\u5C31\u80FD\u8BC6\u522B\u8BF7\u6C42\u6765\u81EA\u54EA\u4E2A\u7528\u6237\u4E86</p><br><p><strong>2\u3001\u5B58\u5728\u95EE\u9898</strong></p><p>1\uFF09\u6BCF\u4E2A\u7279\u5B9A\u57DF\u540D\u4E0B\u751F\u6210\u7684 cookie \u6709\u6570\u91CF\u9650\u5236\uFF08\u5BF9\u4E0D\u540C\u7684\u6D4F\u89C8\u5668\u6765\u8BF4\u4E0D\u540C\uFF09\uFF0Ccookie\u5B58\u50A8\u7684\u957F\u5EA6\u4E0D\u8D85\u8FC7 4kb</p><p>2\uFF09\u57FA\u4E8E cookie \u6765\u8FDB\u884C\u7528\u6237\u8BC6\u522B\uFF0C\u5982\u679C cookie \u88AB\u622A\u83B7\uFF0C\u7528\u6237\u5C31\u5BB9\u6613\u53D7\u5230\u8DE8\u7AD9\u8BF7\u6C42\u4F2A\u9020\u7684\u653B\u51FB</p><p>3\uFF09Cookie \u8DE8\u7AD9\u662F\u4E0D\u80FD\u5171\u4EAB\u7684\uFF0C\u8FD9\u6837\u7684\u8BDD\u5982\u679C\u4F60\u8981\u5B9E\u73B0\u591A\u5E94\u7528\uFF08\u591A\u7CFB\u7EDF\uFF09\u7684\u5355\u70B9\u767B\u5F55\uFF08SSO\uFF09\uFF0C\u4F7F\u7528 Cookie \u6765\u505A\u9700\u8981\u7684\u8BDD\u5C31\u5F88\u56F0\u96BE\u4E86</p><p>4\uFF09Cookie \u662F\u5B58\u50A8\u5728\u5BA2\u6237\u7AEF\u7684\uFF0C\u800C Session \u662F\u5B58\u50A8\u5728\u670D\u52A1\u5668\u7684\u3002\u6BCF\u4E2A\u7528\u6237\u8BA4\u8BC1\u4E4B\u540E\u90FD\u8981\u5728\u670D\u52A1\u5668\u505A\u4E00\u4E2A\u8BB0\u5F55\uFF0C\u5C06\u7528\u6237\u4FE1\u606F\u4FDD\u5B58\u4E3A session\uFF0C\u901A\u5E38\u6765\u8BF4 session \u90FD\u662F\u4FDD\u5B58\u5728\u5185\u5B58\u4E2D\uFF0C\u968F\u7740\u8BA4\u8BC1\u7528\u6237\u7684\u589E\u591A\uFF0C\u670D\u52A1\u7AEF\u7684\u5F00\u9500\u4F1A\u660E\u663E\u589E\u5927</p><p>5\uFF09\u7528\u6237\u8BA4\u8BC1\u4E4B\u540E\uFF0C\u670D\u52A1\u7AEF\u505A\u8BA4\u8BC1\u8BB0\u5F55\uFF0C\u5982\u679C\u8BA4\u8BC1\u8BB0\u5F55\u88AB\u4FDD\u5B58\u5728\u5185\u5B58\u4E2D\u7684\u8BDD\uFF0C\u610F\u5473\u7740<mark>\u7528\u6237\u4E0B\u6B21\u8BF7\u6C42\u8FD8\u5FC5\u987B\u8981\u5728\u8FD9\u53F0\u670D\u52A1\u5668</mark>\u4E0A\uFF0C\u8FD9\u6837\u624D\u80FD\u62FF\u5230\u6388\u6743\u7684\u8D44\u6E90\u3002\u8FD9\u6837\u5728\u5206\u5E03\u5F0F\u5E94\u7528\u4E0A\uFF0C\u54CD\u5E94\u7684\u9650\u5236\u4E86\u8D1F\u8F7D\u5747\u8861\u7684\u80FD\u529B\uFF0C\u4E5F\u9650\u5236\u4E86\u5E94\u7528\u7684\u6269\u5C55\u80FD\u529B</p><p>6\uFF09\u591A\u4E2A\u670D\u52A1\u4E4B\u95F4\u9700\u8981\u89E3\u51B3 session \u5171\u4EAB\u95EE\u9898\uFF0C\u4E0D\u9002\u7528\u4E8E\u5FAE\u670D\u52A1</p><br><p><strong><u>2 - JWT \u8BA4\u8BC1</u></strong></p><p><img src="`+u+`" alt=""></p><p><strong>1\u3001\u8BA4\u8BC1\u6D41\u7A0B</strong></p><p>1\uFF09\u524D\u7AEF\u901A\u8FC7 Web \u8868\u5355\u5C06\u81EA\u5DF1\u7684\u7528\u6237\u540D\u548C\u5BC6\u7801\u53D1\u9001\u5230\u540E\u7AEF\u7684\u63A5\u53E3\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u4E00\u822C\u662F\u4E00\u4E2A http \u7684 POST \u8BF7\u6C42\uFF0C\u5EFA\u8BAE\u7684\u65B9\u5F0F\u662F\u901A\u8FC7 SSL \u52A0\u5BC6\u7684\u4F20\u8F93\uFF08 https \u534F\u8BAE\uFF09\uFF0C\u4ECE\u800C\u907F\u514D\u654F\u611F\u4FE1\u606F\u88AB\u55C5\u63A2</p><p>2\uFF09\u540E\u7AEF\u6838\u5BF9\u7528\u6237\u5BC6\u7801\u6210\u529F\u540E\uFF0C\u5C06\u7528\u6237\u7684 id \u548C\u5176\u4ED6\u4FE1\u606F\u4F5C\u4E3A JWT \u7684 Payload\uFF08\u8D1F\u8F7D\uFF09\uFF0C\u5C06\u5176\u4E0E\u5934\u90E8\u5206\u522B\u8FDB\u884C Base64 \u7F16\u7801\u62FC\u63A5\u540E\u8FDB\u884C\u7B7E\u540D\u64CD\u4F5C\uFF0C\u5F62\u6210\u4E00\u4E2A JWT\uFF08Token\uFF09\u3002\u5F62\u6210\u7684 JWT \u5C31\u662F\u4E00\u4E2A\u7531 <code>header.payload.signature</code> \u4E09\u90E8\u5206\u5F62\u6210\u7684\u5B57\u7B26\u4E32</p><p>3\uFF09\u540E\u7AEF\u5C06 JWT \u5B57\u7B26\u4E32\u4F5C\u4E3A\u767B\u5F55\u6210\u529F\u7684\u8FD4\u56DE\u7ED3\u679C\u8FD4\u56DE\u7ED9\u524D\u7AEF\u3002\u524D\u7AEF\u53EF\u4EE5\u5C06\u8FD4\u56DE\u7684\u7ED3\u679C\u4FDD\u5B58\u5230 <code>localStorage</code> \u6216 <code>sessionStorage</code> \u4E0A\uFF0C\u9000\u51FA\u767B\u5F55\u65F6\u524D\u7AEF\u5220\u9664\u4FDD\u5B58\u7684 JWT\uFF08\u540E\u7AEF\u540C\u65F6\u5C06 JWT \u8BBE\u7F6E\u8FDB\u9ED1\u540D\u5355\uFF09\u5373\u53EF</p><p>4\uFF09\u524D\u7AEF\u5728\u6BCF\u6B21\u8BF7\u6C42\u65F6\u5C06 JWT \u653E\u5165 Http \u8BF7\u6C42\u7684 header \u4E2D\u7684 Authoriztion \u4F4D\uFF08\u89E3\u51B3 XSS \u548C XSRF\uFF09</p><p>5\uFF09\u540E\u7AEF\u68C0\u67E5 <code>Authoriztion</code> \u662F\u5426\u5B58\u5728 JWT\uFF0C\u82E5\u5B58\u5728\u9A8C\u8BC1 JWT \u7684\u6709\u6548\u6027\u3002\u4F8B\u5982\uFF0C\u68C0\u67E5\u7B7E\u540D\u662F\u5426\u6B63\u786E\uFF1B\u68C0\u67E5 Token \u662F\u5426\u8FC7\u671F\uFF1B\u68C0\u67E5 Token \u7684\u63A5\u6536\u65B9\u662F\u5426\u662F\u81EA\u5DF1\uFF08\u53EF\u9009\uFF09</p><p>6\uFF09\u9A8C\u8BC1\u901A\u8FC7\u540E\u540E\u7AEF\u4F7F\u7528 JWT \u4E2D\u5305\u542B\u7684\u7528\u6237\u4FE1\u606F\u8FDB\u884C\u5176\u4ED6\u903B\u8F91\u64CD\u4F5C\uFF0C\u8FDB\u884C\u4E0E\u6570\u636E\u5E93\u7684\u64CD\u4F5C\uFF0C\u8FD4\u56DE\u76F8\u5E94\u7684\u7ED3\u679C\u3002\u5E76\u5C06 JWT \u7684\u8FC7\u671F\u65F6\u95F4\u5237\u65B0</p><br><p><strong>2\u3001\u4F18\u52BF</strong></p><p>1\u3001\u7B80\u6D01\uFF08Compact\uFF09\uFF0C\u53EF\u4EE5\u901A\u8FC7 URL\uFF0CPOST \u53C2\u6570\u6216\u8005\u5728 http \u7684 header \u53D1\u9001\uFF0C\u56E0\u4E3A\u6570\u636E\u91CF\u5C0F\uFF0C\u4F20\u8F93\u901F\u5EA6\u4E5F\u5F88\u5FEB</p><p>2\u3001\u81EA\u5305\u542B\uFF08Self-contained\uFF09\uFF0C\u8D1F\u8F7D\u4E2D\u5305\u542B\u4E86\u7528\u6237\u6240\u9700\u8981\u7684\u6240\u6709\u4FE1\u606F\uFF08\u7528\u6237ID\uFF09\uFF0C\u907F\u514D\u4E86\u591A\u6B21\u67E5\u8BE2\u6570\u636E\u5E93</p><p>3\u3001Token \u662F\u4EE5 JSON \u52A0\u5BC6\u7684\u5F62\u5F0F\u4FDD\u5B58\u5728\u5BA2\u6237\u7AEF\u7684\uFF0C\u6240\u4EE5 JWT \u662F\u8DE8\u8BED\u8A00\u7684\uFF0C\u539F\u5219\u4E0A\u4EFB\u4F55 Web \u5F62\u5F0F\u90FD\u652F\u6301</p><p>4\u3001\u4E0D\u9700\u8981\u5728\u670D\u52A1\u7AEF\u4FDD\u5B58\u4F1A\u8BDD\u4FE1\u606F\uFF0C\u7279\u522B\u9002\u7528\u4E8E\u5206\u5E03\u5F0F\u5FAE\u670D\u52A1</p><p>5\u3001\u5728\u79FB\u52A8\u7AEF\u539F\u751F\u8BF7\u6C42\u662F\u6CA1\u6709 cookie \u4E4B\u8BF4\u7684\uFF0C\u800C sessionid \u4F9D\u8D56\u4E8E cookie\uFF0Csessionid \u5C31\u4E0D\u80FD\u7528 cookie \u6765\u4F20\u4E86\uFF0C\u5982\u679C\u7528 token \u7684\u8BDD\uFF0C\u7531\u4E8E\u5B83\u662F\u968F\u7740 header \u7684 authoriize \u4F20\u8FC7\u6765\u7684\uFF0C\u4E5F\u5C31\u4E0D\u5B58\u5728\u6B64\u95EE\u9898\uFF0C\u6362\u53E5\u8BDD\u8BF4token \u5929\u751F\u652F\u6301\u79FB\u52A8\u5E73\u53F0\uFF0C\u53EF\u6269\u5C55\u6027\u597D</p><br><p><strong>3\u3001\u5B58\u5728\u95EE\u9898</strong></p><p>1\uFF09token\u592A\u957F\u3002token \u662F header\uFF0Cpayload \u7F16\u7801\u540E\u52A0\u4E0A\u7B7E\u540D\u5F97\u6765\uFF0C\u6240\u4EE5\u4E00\u822C\u8981\u6BD4 sessionId \u957F\u5F88\u591A\uFF0C\u5F88\u6709\u53EF\u80FD\u8D85\u51FA cookie \u7684\u5927\u5C0F\u9650\u5236\uFF08cookie \u4E00\u822C\u6709\u5927\u5C0F\u9650\u5236\u7684\uFF0C\u5982 4kb\uFF09\uFF0C\u5982\u679C\u4F60\u5728 token \u4E2D\u5B58\u50A8\u7684\u4FE1\u606F\u8D8A\u957F\uFF0C\u90A3\u4E48 token \u672C\u8EAB\u4E5F\u4F1A\u8D8A\u957F\uFF0C\u8FD9\u6837\u7684\u8BDD\u7531\u4E8E\u4F60\u6BCF\u6B21\u8BF7\u6C42\u90FD\u4F1A\u5E26\u4E0A token\uFF0C\u5BF9\u8BF7\u6C42\u6765\u662F\u4E2A\u4E0D\u5C0F\u7684\u8D1F\u62C5</p><p>2\uFF09token \u4E0D\u592A\u5B89\u5168\u3002token \u5B58\u50A8\u5728 localStorage \u4E2D\uFF0C\u8FD9\u7C7B\u7684\u672C\u5730\u5B58\u50A8\u662F\u53EF\u4EE5\u88AB JavaScript \u76F4\u63A5\u8BFB\u53D6\u7684\uFF0C<strong>\u4ECE\u5B58\u50A8\u89D2\u5EA6\u6765\u770B</strong>\u4E5F\u4E0D\u5B89\u5168\u3002\u53E6\u5916\uFF0Ctoken \u4E00\u65E6\u751F\u6210\u65E0\u6CD5\u8BA9\u5176\u5931\u6548\uFF0C\u5FC5\u987B\u7B49\u5230\u5B83\u8FC7\u671F\u624D\u884C\uFF0C\u5982\u679C\u670D\u52A1\u7AEF\u68C0\u6D4B\u5230\u4E86\u4E00\u4E2A\u5B89\u5168\u5A01\u80C1\uFF0C\u4E5F\u65E0\u6CD5\u4F7F\u76F8\u5173\u7684 token \u5931\u6548\uFF0C<strong>\u6240\u4EE5 token \u66F4\u9002\u5408\u4E00\u6B21\u6027\u7684\u547D\u4EE4\u8BA4\u8BC1\uFF0C\u8BBE\u7F6E\u4E00\u4E2A\u6BD4\u8F83\u77ED\u7684\u6709\u6548\u671F</strong></p><br><p><strong><u>3 - JWT \u4F5C\u7528</u></strong></p><p>1\u3001\u6388\u6743\uFF0C\u6700\u5E38\u7528\uFF0C\u4E00\u65E6\u7528\u6237\u767B\u5F55\uFF0C\u540E\u7EED\u6BCF\u4E2A\u8BF7\u6C42\u90FD\u8981\u643A\u5E26 JWT \u4EE4\u724C\u624D\u5F97\u4EE5\u5141\u8BB8\u8BBF\u95EE\u5176\u4ED6\u8DEF\u5F84\u3001\u670D\u52A1\u548C\u8D44\u6E90\u3002\u5355\u70B9\u767B\u5F55\u662F\u5F53\u4ECA\u5E7F\u6CDB\u4F7F\u7528 JWT \u7684\u4E00\u9879\u529F\u80FD\uFF0C\u56E0\u4E3A\u5B83\u5F00\u9500\u5F88\u5C0F\uFF0C\u5E76\u4E14\u53EF\u4EE5\u5728\u4E0D\u540C\u7684\u57DF\u540D\u4E2D\u8F7B\u677E\u4F7F\u7528</p><p>2\u3001\u4FE1\u606F\u4EA4\u6362\uFF0CJWT \u662F\u5728\u5404\u65B9\u4E4B\u95F4\u5B89\u5168\u5730\u4F20\u8F93\u4FE1\u606F\u7684\u597D\u65B9\u6CD5\uFF0C\u56E0\u4E3A\u53EF\u4EE5\u5BF9 JWT \u8FDB\u884C\u7B7E\u540D\uFF08\u4F7F\u7528\u516C\u94A5/\u5BC6\u94A5\uFF09\uFF0C\u6240\u4EE5\u53EF\u4EE5\u786E\u4FDD\u4FE1\u606F\u4EA4\u6362\u7684\u51C6\u786E\u6027\uFF0C\u5E76\u4E14\u8FD8\u53EF\u4EE5\u9A8C\u8BC1\u4F20\u8F93\u7684\u5185\u5BB9\u662F\u5426\u906D\u5230\u7BE1\u6539</p><br><p><strong><u>4 - JWT \u7ED3\u6784</u></strong></p><blockquote><p><code>Header.Payload.Signature</code></p></blockquote><p>1\u3001<code>Header</code> \u6807\u5934</p><div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">{</span>
    <span class="token property">&quot;typ&quot;</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SHA256&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u6807\u5934\u901A\u5E38\u7531\u4E24\u90E8\u5206\u7EC4\u6210\uFF1A</p><p>1\uFF09\u4EE4\u724C\u7684\u7C7B\u578B\uFF08\u5373 JWT \uFF09</p><p>2\uFF09\u4F7F\u7528\u7684\u7B7E\u540D\u7B97\u6CD5\uFF0C\u5982 SHA256\uFF0CRSA</p><p>\u6700\u540E\u518D\u5C06 <code>Header</code> \u4F7F\u7528 <code>Base64</code> \u7F16\u7801\uFF0C\u7EC4\u6210 JWT \u7684\u7B2C\u4E00\u90E8\u5206</p><p>2\u3001<code>Payload</code> \u8D1F\u8F7D</p><div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">{</span>
    <span class="token property">&quot;sub&quot;</span><span class="token operator">:</span> <span class="token number">123456789</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;somebody&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;admin&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>payload</code> \u5305\u542B\u58F0\u660E\uFF0C\u5373\u6709\u5173\u5B9E\u4F53\uFF08\u901A\u5E38\u662F\u7528\u6237\uFF09\uFF0C\u548C\u5176\u4ED6\u6570\u636E\u58F0\u660E \uFF0C\u5B58\u653E\u7528\u6237\u4FE1\u606F\u4E2D\u7684<strong>\u4E0D\u654F\u611F\u4FE1\u606F</strong>\uFF0C\u5982\u7528\u6237Id\uFF0C\u7528\u6237\u540D\uFF0C\u89D2\u8272\u4FE1\u606F</p><p>\u6700\u540E\u518D\u5C06 <code>payload</code> \u4F7F\u7528 <code>Base64</code> \u7F16\u7801\uFF0C\u7EC4\u6210 JWT \u7684\u7B2C\u4E8C\u90E8\u5206</p><p>3\u3001<code>Signature</code> \u7B7E\u540D\\</p><div class="language-"><pre><code>HMACSHA256(base64UrlEncode(header).base64UrlEncode(payload),secret);
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>signature</code> \u9700\u8981\u4F7F\u7528\u7F16\u7801\u540E\u7684 <code>header</code> \u548C <code>payload</code> \u4EE5\u53CA<strong>\u81EA\u5B9A\u4E49\u63D0\u4F9B\u7684\u5BC6\u94A5</strong>\u7EC4\u6210\u4E00\u4E32\u5B57\u7B26\u4E32\uFF0C\u7136\u540E \u4F7F\u7528 <code>header</code> \u4E2D\u6307\u5B9A\u7684\u7B7E\u540D\u7B97\u6CD5\u8FDB\u884C\u7B7E\u540D\u3002\u7B7E\u540D\u7684\u4F5C\u7528\u662F\u4FDD\u8BC1 JWT \u6CA1\u6709\u88AB\u7BE1\u6539\u8FC7\u3002</p><p>\u6700\u540E\u4E00\u6B65\u7B7E\u540D\u7684\u8FC7\u7A0B\uFF0C\u5B9E\u9645\u4E0A\u662F\u5BF9\u5934\u90E8\u4EE5\u53CA\u8D1F\u8F7D\u5185\u5BB9\u8FDB\u884C\u7B7E\u540D\uFF0C\u9632\u6B62\u5185\u5BB9\u88AB\u7BE1\u6539\u3002\u5982\u679C\u6709\u4EBA\u5BF9\u5934\u90E8\u4EE5\u53CA\u8D1F\u8F7D\u5185\u5BB9\u89E3\u7801\u4E4B\u540E\u8FDB\u884C\u4FEE\u6539\uFF0C\u518D\u8FDB\u884C\u7F16\u7801\uFF0C\u6700\u540E\u52A0\u4E0A\u4E4B\u524D\u7684\u7B7E\u540D\u7EC4\u5408\u5F62\u6210\u65B0\u7684 JWT \u7684\u8BDD\uFF0C\u6B64\u65F6\u670D\u52A1\u5668\u5C31\u4F1A\u5224\u65AD\u51FA\u7B7E\u540D\u4E0D\u4E00\u81F4\u3002\u5982\u679C\u8981\u5BF9\u65B0\u7684\u5934\u90E8\u548C\u8D1F\u8F7D\u8FDB\u884C\u7B7E\u540D\u5728\u4E0D\u77E5\u9053\u5BC6\u94A5\u7684\u60C5\u51B5\u4E0B\u5F97\u51FA\u6765\u7684\u7B7E\u540D\u4E5F\u662F\u4E0D\u4E00\u81F4\u7684</p><br><p><strong><u>5 - JWT \u6CE8\u610F\u7EC6\u8282</u></strong></p><p>1\uFF09token \u4E00\u65E6\u7531 server \u751F\u6210\uFF0C\u5B83\u5C31\u662F\u6709\u6548\u7684\uFF0C\u76F4\u5230\u8FC7\u671F\uFF0C\u65E0\u6CD5\u8BA9 token \u5931\u6548\u3002\u9664\u975E \u4E3A token \u8BBE\u7ACB\u4E00\u4E2A\u9ED1\u540D\u5355\uFF0C\u5728\u6821\u9A8C token \u524D\u5148\u8FC7\u4E00\u904D\u6B64\u9ED1\u540D\u5355\u3002\u5982\u679C\u5728\u9ED1\u540D\u5355\u91CC\u5219\u6B64 token \u5931\u6548\uFF0C\u4F46\u662F\u4F1A\u589E\u52A0\u7EF4\u62A4\u9ED1\u540D\u5355\u7684\u6210\u672C\uFF0C\u4E00\u822C\u7684\u505A\u6CD5\u662F\u5F53\u5BA2\u6237\u7AEF\u767B\u51FA\u8981\u8BA9 token \u5931\u6548\u65F6\uFF0C\u76F4\u63A5\u5728\u672C\u5730\u79FB\u9664 token \uFF0C\u4E0B\u6B21\u767B\u5F55\u91CD\u65B0\u751F\u6210 token</p><p>2\uFF09 token \u4E00\u822C\u662F\u653E\u5728 header \u7684 Authorization \u81EA\u5B9A\u4E49\u5934\u91CC\uFF0C\u4E0D\u662F\u653E\u5728 Cookie \u91CC\u7684\uFF0C\u8FD9\u4E3B\u8981\u662F\u4E3A\u4E86\u89E3\u51B3\u8DE8\u57DF\u4E0D\u80FD\u5171\u4EAB Cookie \u7684\u95EE\u9898</p><p>3\uFF09\u53EF\u81EA\u5B9A\u4E49\u6CE8\u89E3\u6807\u6CE8\u5728\u9700\u8981 token \u8BA4\u8BC1\u7684\u65B9\u6CD5\u4E0A\uFF0Ctoken \u62E6\u622A\u5668\u53EA\u9700\u8981\u62E6\u622A\u6709\u8BE5\u6CE8\u89E3\u7684\u65B9\u6CD5\u5373\u53EF</p><br><p><strong><u>6 - SpringBoot \u6574\u5408 JWT \u5B9E\u73B0</u></strong></p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.auth0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>java-jwt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.13.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-java line-numbers-mode"><pre><code><span class="token comment">/**
 * JWTUtils jwt\u5DE5\u5177\u7C7B
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JWTUtils</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> TOKEN_SIGNATURE <span class="token operator">=</span> <span class="token string">&quot;QWs!!@#%&amp;%TR123~*&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> TOKEN_EXPIRES <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * \u751F\u6210token
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateToken</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">Calendar</span> calendar <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        calendar<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>MINUTE<span class="token punctuation">,</span> TOKEN_EXPIRES<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u521B\u5EFAjwt builder</span>
        <span class="token class-name">JWTCreator<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6Epayload</span>
        payload<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            builder<span class="token punctuation">.</span><span class="token function">withClaim</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4</span>
        builder<span class="token punctuation">.</span><span class="token function">withExpiresAt</span><span class="token punctuation">(</span>calendar<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u8BBE\u7F6E\u52A0\u5BC6\u7B97\u6CD5\u548C\u5BC6\u94A5\u5E76\u7B7E\u540D</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>TOKEN_SIGNATURE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> token<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/** 
     * \u9A8C\u8BC1token\u5408\u6CD5\u6027
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">verifyToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u82E5\u629B\u51FA\u5F02\u5E38\u5219\u8BF4\u660Etoken\u9A8C\u8BC1\u5931\u8D25</span>
        JWT<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>TOKEN_SIGNATURE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * \u89E3\u6790token
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DecodedJWT</span> <span class="token function">parseToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DecodedJWT</span> decodedJWT <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>TOKEN_SIGNATURE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> decodedJWT<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * \u5237\u65B0token
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">refreshExpires</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u83B7\u53D6\u539F\u6765token\u91CC\u7684\u5185\u5BB9\uFF0C\u518D\u91CD\u65B0\u751F\u6210token</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="\u6574\u5408-swagger3" tabindex="-1">\u6574\u5408 Swagger3 <a class="header-anchor" href="#\u6574\u5408-swagger3" aria-hidden="true">#</a></h2><br><p><strong><u>1 - \u5B9E\u73B0</u></strong></p><div class="language-xml line-numbers-mode"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.springfox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springfox-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-properties line-numbers-mode"><pre><code><span class="token key attr-name">springfox.documentation.swagger-ui.enabled</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-java line-numbers-mode"><pre><code><span class="token annotation punctuation">@EnableOpenApi</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SwaggerConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">// dev\u7EC4</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Docket</span> <span class="token function">createRestApiGroupDev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">ApiInfo</span> apiInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApiInfoBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// api\u6807\u9898</span>
                <span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&quot;SpringBoot\u6574\u5408Swagger3&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// api\u63CF\u8FF0</span>
                <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD5\u4E00\u4E0Bswagger api\u7684\u63CF\u8FF0&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">contact</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token string">&quot;gnl&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://gnlee.gitee.io&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1193898858@qq.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u6587\u6863\u7C7B\u578B SWAGGER_2</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Docket</span><span class="token punctuation">(</span><span class="token class-name">DocumentationType</span><span class="token punctuation">.</span>OAS_30<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span>apiInfo<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// \u6307\u5B9A\u626B\u63CF\u5305\u542B@ApiOperation \u6CE8\u89E3\u7684\u65B9\u6CD5</span>
                <span class="token punctuation">.</span><span class="token function">apis</span><span class="token punctuation">(</span><span class="token class-name">RequestHandlerSelectors</span><span class="token punctuation">.</span><span class="token function">withMethodAnnotation</span><span class="token punctuation">(</span><span class="token class-name">ApiOperation</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">// \u8DEF\u5F84\u8FC7\u6EE4\u5668</span>
                <span class="token punctuation">.</span><span class="token function">paths</span><span class="token punctuation">(</span><span class="token class-name">PathSelectors</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">groupName</span><span class="token punctuation">(</span><span class="token string">&quot;swagger3 \u5F00\u53D1\u7EC4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// test\u7EC4</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Docket</span> <span class="token function">createRestApiGroupTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">ApiInfo</span> apiInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApiInfoBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// api\u6807\u9898</span>
                <span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&quot;SpringBoot\u6574\u5408Swagger3&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// api\u63CF\u8FF0</span>
                <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD5\u4E00\u4E0Bswagger api\u7684\u63CF\u8FF0&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">contact</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token string">&quot;gnl&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://gnlee.gitee.io&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1193898858@qq.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u6587\u6863\u7C7B\u578B SWAGGER_2</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Docket</span><span class="token punctuation">(</span><span class="token class-name">DocumentationType</span><span class="token punctuation">.</span>OAS_30<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span>apiInfo<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// \u6307\u5B9A\u626B\u63CF\u5305\u542B@ApiOperation \u6CE8\u89E3\u7684\u65B9\u6CD5</span>
                <span class="token punctuation">.</span><span class="token function">apis</span><span class="token punctuation">(</span><span class="token class-name">RequestHandlerSelectors</span><span class="token punctuation">.</span><span class="token function">withMethodAnnotation</span><span class="token punctuation">(</span><span class="token class-name">ApiOperation</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">// \u8DEF\u5F84\u8FC7\u6EE4\u5668</span>
                <span class="token punctuation">.</span><span class="token function">paths</span><span class="token punctuation">(</span><span class="token class-name">PathSelectors</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">groupName</span><span class="token punctuation">(</span><span class="token string">&quot;swagger3 \u6D4B\u8BD5\u7EC4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><div class="language-java line-numbers-mode"><pre><code><span class="token comment">//User.java</span>

<span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237Bean&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@ToString</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u59D3\u540D&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u5E74\u9F84&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-java line-numbers-mode"><pre><code><span class="token comment">//UserController.java</span>

<span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;\u7528\u6237\u7BA1\u7406Api&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u7684hello\u8BF7\u6C42&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello, swagger&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u9700\u8981\u53C2\u6570\u7684\u8BF7\u6C42&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/rp&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">requireParams</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ApiParam</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u540D&quot;</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
                              <span class="token annotation punctuation">@ApiParam</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u5E74\u9F84&quot;</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> user<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user/{name}/{password}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;\u4FDD\u5B58\u7528\u6237api&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;\u4FDD\u5B58\u7528\u6237\u8BE6\u60C5&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiImplicitParams</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token annotation punctuation">@ApiImplicitParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;\u7528\u6237\u540D&quot;</span><span class="token punctuation">,</span> dataType <span class="token operator">=</span> <span class="token string">&quot;String&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;gnl&quot;</span><span class="token punctuation">,</span> paramType <span class="token operator">=</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token annotation punctuation">@ApiImplicitParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;\u7528\u6237\u5BC6\u7801&quot;</span><span class="token punctuation">,</span> dataType <span class="token operator">=</span> <span class="token string">&quot;String&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span> paramType <span class="token operator">=</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiResponses</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token annotation punctuation">@ApiResponse</span><span class="token punctuation">(</span>code <span class="token operator">=</span> <span class="token number">401</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;401 msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token annotation punctuation">@ApiResponse</span><span class="token punctuation">(</span>code <span class="token operator">=</span> <span class="token number">403</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;403 msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token annotation punctuation">@ApiResponse</span><span class="token punctuation">(</span>code <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;404 msg&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">saveUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><br><p><strong><u>2 - \u6CE8\u89E3</u></strong></p><p>1\u3001<code>@Api</code> \u7528\u5728\u8BF7\u6C42\u7684\u7C7B\u4E0A\uFF0C\u8868\u793A\u5BF9\u7C7B\u7684\u8BF4\u660E</p><ul><li>tags\uFF0C\u8BF4\u660E\u8BE5\u7C7B\u7684\u4F5C\u7528\uFF0C\u53EF\u4EE5\u5728UI\u754C\u9762\u4E0A\u770B\u5230\u7684\u6CE8\u89E3</li><li>value\uFF0C\u8BE5\u53C2\u6570\u6CA1\u4EC0\u4E48\u610F\u4E49\uFF0C\u5728UI\u754C\u9762\u4E0A\u4E5F\u770B\u5230\uFF0C\u6240\u4EE5\u4E0D\u9700\u8981\u914D\u7F6E</li></ul><p>2\u3001<code>@ApiOperation</code> \u7528\u5728\u8BF7\u6C42\u7684\u65B9\u6CD5\u4E0A\uFF0C\u8BF4\u660E\u65B9\u6CD5\u7684\u7528\u9014\u3001\u4F5C\u7528</p><ul><li>value\uFF0C\u8BF4\u660E\u65B9\u6CD5\u7684\u7528\u9014\u3001\u4F5C\u7528</li><li>notes\uFF0C\u65B9\u6CD5\u7684\u5907\u6CE8\u8BF4\u660E</li></ul><p>3\u3001<code>@ApiImplicitParams</code> \u7528\u5728\u8BF7\u6C42\u7684\u65B9\u6CD5\u4E0A\uFF0C\u8868\u793A\u4E00\u7EC4\u53C2\u6570\u8BF4\u660E</p><p><code>@ApiImplicitParam</code> \u7528\u5728 <code>@ApiImplicitParams</code> \u6CE8\u89E3\u4E2D\uFF0C\u6307\u5B9A\u4E00\u4E2A\u8BF7\u6C42\u53C2\u6570\u7684\u5404\u4E2A\u65B9\u9762</p><ul><li>name\uFF0C\u53C2\u6570\u540D</li><li>value\uFF0C\u53C2\u6570\u7684\u6C49\u5B57\u8BF4\u660E\u3001\u89E3\u91CA</li><li>required\uFF0C\u53C2\u6570\u662F\u5426\u5FC5\u987B\u4F20</li><li>paramType\uFF0C\u53C2\u6570\u653E\u5728\u54EA\u4E2A\u5730\u65B9 <ul><li>header \u8BF7\u6C42\u53C2\u6570\u7684\u83B7\u53D6\uFF1A<code>@RequestHeader</code></li><li>query \u8BF7\u6C42\u53C2\u6570\u7684\u83B7\u53D6\uFF1A<code>@RequestParam</code></li><li>path\uFF08\u7528\u4E8Erestful\u63A5\u53E3\uFF09 \u8BF7\u6C42\u53C2\u6570\u7684\u83B7\u53D6\uFF1A<code>@PathVariable</code></li><li>body\uFF08\u4E0D\u5E38\u7528\uFF09</li><li>form\uFF08\u4E0D\u5E38\u7528\uFF09</li></ul></li><li>dataType\uFF0C\u53C2\u6570\u7C7B\u578B\uFF0C\u9ED8\u8BA4 String\uFF0C\u5176\u5B83\u6709<code>dataType=&quot;Integer&quot;</code>\u7B49</li><li>defaultValue\uFF0C\u53C2\u6570\u7684\u9ED8\u8BA4\u503C</li></ul><p>4\u3001<code>@ApiResponses</code> \u7528\u5728\u8BF7\u6C42\u7684\u65B9\u6CD5\u4E0A\uFF0C\u8868\u793A\u4E00\u7EC4\u54CD\u5E94</p><p><code>@ApiResponse</code> \u7528\u5728 <code>@ApiResponses</code> \u4E2D\uFF0C\u4E00\u822C\u7528\u4E8E\u8868\u8FBE\u4E00\u4E2A\u9519\u8BEF\u7684\u54CD\u5E94\u4FE1\u606F</p><ul><li>code\uFF0C\u72B6\u6001\u7801\uFF0C\u4F8B\u5982200</li><li>message\uFF0C\u4FE1\u606F\uFF0C\u4F8B\u5982&quot;\u8BF7\u6C42\u53C2\u6570\u6709\u8BEF&quot;</li><li>response\uFF0C\u629B\u51FA\u5F02\u5E38\u7684\u7C7B</li></ul><p>5\u3001<code>@ApiModel</code> \u7528\u4E8E\u54CD\u5E94\u7C7B\u4E0A\uFF0C\u8868\u793A\u4E00\u4E2A\u8FD4\u56DE\u54CD\u5E94\u6570\u636E\u7684\u4FE1\u606F\uFF08\u8FD9\u79CD\u4E00\u822C\u7528\u5728 POST \u521B\u5EFA\u7684\u65F6\u5019\uFF0C\u4F7F\u7528 <code>@RequestBody</code> \u8FD9\u6837\u7684\u573A\u666F\uFF0C\u8BF7\u6C42\u53C2\u6570\u65E0\u6CD5\u4F7F\u7528 <code>@ApiImplicitParam</code> \u6CE8\u89E3\u8FDB\u884C\u63CF\u8FF0\u7684\u65F6\u5019\uFF09</p><p><code>@ApiModelProperty</code> \u7528\u5728\u5C5E\u6027\u4E0A\uFF0C\u63CF\u8FF0\u54CD\u5E94\u7C7B\u7684\u5C5E\u6027</p><blockquote><p>\u26A0 \u6B63\u5F0F\u7248\u672C\u53D1\u5E03\u7684\u65F6\u5019\u8981\u5173\u95ED Swagger</p></blockquote><br><h2 id="\u539F\u7406\u5206\u6790" tabindex="-1">\u539F\u7406\u5206\u6790 <a class="header-anchor" href="#\u539F\u7406\u5206\u6790" aria-hidden="true">#</a></h2><br><h3 id="\u521D\u59CB\u5316\u6D41\u7A0B" tabindex="-1">\u521D\u59CB\u5316\u6D41\u7A0B <a class="header-anchor" href="#\u521D\u59CB\u5316\u6D41\u7A0B" aria-hidden="true">#</a></h3><br><h3 id="\u542F\u52A8\u539F\u7406" tabindex="-1">\u542F\u52A8\u539F\u7406 <a class="header-anchor" href="#\u542F\u52A8\u539F\u7406" aria-hidden="true">#</a></h3><br><h3 id="\u81EA\u5B9A\u4E49-starter" tabindex="-1">\u81EA\u5B9A\u4E49 Starter <a class="header-anchor" href="#\u81EA\u5B9A\u4E49-starter" aria-hidden="true">#</a></h3><br><p><strong>\u53C2\u8003</strong></p><p><a href="https://blog.csdn.net/qq_34964197/article/details/87283408" target="_blank" rel="noopener noreferrer">\u6570\u636E\u5E93\u5206\u5E93\u5206\u8868\u7B56\u7565\u7684\u5177\u4F53\u5B9E\u73B0\u65B9\u6848_\u6700\u8FD1\u6BD4\u8F83\u70E6\u3002\u7684\u535A\u5BA2-CSDN\u535A\u5BA2</a></p><p><a href="https://blog.csdn.net/qq_39291929/article/details/80795221" target="_blank" rel="noopener noreferrer">java\u5206\u5E93\u5206\u8868\u6280\u672F_\u611F\u5192\u77F3\u5934\u7684\u535A\u5BA2-CSDN\u535A\u5BA2_java \u5206\u5E93\u5206\u8868</a></p><p><a href="https://www.jianshu.com/p/e88d3f8151db" target="_blank" rel="noopener noreferrer">SpringBoot\u96C6\u6210JWT\u5B9E\u73B0token\u9A8C\u8BC1 - \u7B80\u4E66 (jianshu.com)</a></p><p><a href="https://www.cnblogs.com/youngdeng/p/12868473.html" target="_blank" rel="noopener noreferrer">Spring Boot\u8BA4\u8BC1\uFF1A\u6574\u5408Jwt - YoungDeng - \u535A\u5BA2\u56ED (cnblogs.com)</a></p><p><a href="https://mp.weixin.qq.com/s/StIo-eC-7UeBr-fb6lIZkQ" target="_blank" rel="noopener noreferrer">\u4F60\u7BA1\u8FD9\u7834\u73A9\u610F\u513F\u53EB Token?</a></p><p><a href="https://blog.csdn.net/u010663021/article/details/108388817" target="_blank" rel="noopener noreferrer">SpringBoot \u4F7F\u7528 log4j2_\u3010\u70ED\u8840\u8717\u725B\u3011\u7684\u535A\u5BA2-CSDN\u535A\u5BA2</a></p><p><a href="https://www.cnblogs.com/keeya/p/10101547.html" target="_blank" rel="noopener noreferrer">Springboot\u6574\u5408log4j2\u65E5\u5FD7\u5168\u89E3 - \u4E0A\u5E1D\u7231\u5403\u82F9\u679C-Soochow - \u535A\u5BA2\u56ED (cnblogs.com)</a></p>`,494);function k(b,m,d,g,y,q){const n=e("Catalog");return o(),a("div",null,[p(n),r])}var w=s(i,[["render",k]]);export{f as __pageData,w as default};
